import{_ as J,a as Me,b as gr,j as e,u as at,c as Fe,d as r,B as Qe,C as st,L as M,N as fe,F as de,e as ue,f as W,g as At,h as Ue,i as vr,k as br,P as yr,l as gt,m as vt,n as bt,o as yt,p as Nt,q as qt,R as z,r as k,A as Z,s as H,t as _,S as se,v as g,I as Ee,w as Nr,D as ge,x as Lt,T as le,y as Be,z as Cr,E as Sr,G as Qt,H as wr,J as _r,K as xr,M as Te,O as Rr,Q as Ar,U as Y}from"./vendor-5e13991b.js";import{c as Lr,b as kr,a as te,r as p}from"./react-307dba9e.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function s(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(n){if(n.ep)return;n.ep=!0;const c=s(n);fetch(n.href,c)}})();var dt={},kt=Lr;dt.createRoot=kt.createRoot,dt.hydrateRoot=kt.hydrateRoot;var $e=function(){function t(){this.listeners=[]}var a=t.prototype;return a.subscribe=function(i){var n=this,c=i||function(){};return this.listeners.push(c),this.onSubscribe(),function(){n.listeners=n.listeners.filter(function(l){return l!==c}),n.onUnsubscribe()}},a.hasListeners=function(){return this.listeners.length>0},a.onSubscribe=function(){},a.onUnsubscribe=function(){},t}(),Ye=typeof window>"u";function he(){}function Pr(t,a){return typeof t=="function"?t(a):t}function ut(t){return typeof t=="number"&&t>=0&&t!==1/0}function Je(t){return Array.isArray(t)?t:[t]}function Bt(t,a){return Math.max(t+(a||0)-Date.now(),0)}function He(t,a,s){return nt(t)?typeof a=="function"?J({},s,{queryKey:t,queryFn:a}):J({},a,{queryKey:t}):t}function Re(t,a,s){return nt(t)?[J({},a,{queryKey:t}),s]:[t||{},a]}function Fr(t,a){if(t===!0&&a===!0||t==null&&a==null)return"all";if(t===!1&&a===!1)return"none";var s=t??!a;return s?"active":"inactive"}function Pt(t,a){var s=t.active,i=t.exact,n=t.fetching,c=t.inactive,l=t.predicate,o=t.queryKey,d=t.stale;if(nt(o)){if(i){if(a.queryHash!==Ct(o,a.options))return!1}else if(!Ze(a.queryKey,o))return!1}var u=Fr(s,c);if(u==="none")return!1;if(u!=="all"){var h=a.isActive();if(u==="active"&&!h||u==="inactive"&&h)return!1}return!(typeof d=="boolean"&&a.isStale()!==d||typeof n=="boolean"&&a.isFetching()!==n||l&&!l(a))}function Ft(t,a){var s=t.exact,i=t.fetching,n=t.predicate,c=t.mutationKey;if(nt(c)){if(!a.options.mutationKey)return!1;if(s){if(Pe(a.options.mutationKey)!==Pe(c))return!1}else if(!Ze(a.options.mutationKey,c))return!1}return!(typeof i=="boolean"&&a.state.status==="loading"!==i||n&&!n(a))}function Ct(t,a){var s=(a==null?void 0:a.queryKeyHashFn)||Pe;return s(t)}function Pe(t){var a=Je(t);return Er(a)}function Er(t){return JSON.stringify(t,function(a,s){return ht(s)?Object.keys(s).sort().reduce(function(i,n){return i[n]=s[n],i},{}):s})}function Ze(t,a){return Gt(Je(t),Je(a))}function Gt(t,a){return t===a?!0:typeof t!=typeof a?!1:t&&a&&typeof t=="object"&&typeof a=="object"?!Object.keys(a).some(function(s){return!Gt(t[s],a[s])}):!1}function Xe(t,a){if(t===a)return t;var s=Array.isArray(t)&&Array.isArray(a);if(s||ht(t)&&ht(a)){for(var i=s?t.length:Object.keys(t).length,n=s?a:Object.keys(a),c=n.length,l=s?[]:{},o=0,d=0;d<c;d++){var u=s?d:n[d];l[u]=Xe(t[u],a[u]),l[u]===t[u]&&o++}return i===c&&o===i?t:l}return a}function Ir(t,a){if(t&&!a||a&&!t)return!1;for(var s in t)if(t[s]!==a[s])return!1;return!0}function ht(t){if(!Et(t))return!1;var a=t.constructor;if(typeof a>"u")return!0;var s=a.prototype;return!(!Et(s)||!s.hasOwnProperty("isPrototypeOf"))}function Et(t){return Object.prototype.toString.call(t)==="[object Object]"}function nt(t){return typeof t=="string"||Array.isArray(t)}function Or(t){return new Promise(function(a){setTimeout(a,t)})}function It(t){Promise.resolve().then(t).catch(function(a){return setTimeout(function(){throw a})})}function zt(){if(typeof AbortController=="function")return new AbortController}var Tr=function(t){Me(a,t);function a(){var i;return i=t.call(this)||this,i.setup=function(n){var c;if(!Ye&&((c=window)!=null&&c.addEventListener)){var l=function(){return n()};return window.addEventListener("visibilitychange",l,!1),window.addEventListener("focus",l,!1),function(){window.removeEventListener("visibilitychange",l),window.removeEventListener("focus",l)}}},i}var s=a.prototype;return s.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},s.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},s.setEventListener=function(n){var c,l=this;this.setup=n,(c=this.cleanup)==null||c.call(this),this.cleanup=n(function(o){typeof o=="boolean"?l.setFocused(o):l.onFocus()})},s.setFocused=function(n){this.focused=n,n&&this.onFocus()},s.onFocus=function(){this.listeners.forEach(function(n){n()})},s.isFocused=function(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)},a}($e),De=new Tr,Dr=function(t){Me(a,t);function a(){var i;return i=t.call(this)||this,i.setup=function(n){var c;if(!Ye&&((c=window)!=null&&c.addEventListener)){var l=function(){return n()};return window.addEventListener("online",l,!1),window.addEventListener("offline",l,!1),function(){window.removeEventListener("online",l),window.removeEventListener("offline",l)}}},i}var s=a.prototype;return s.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},s.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},s.setEventListener=function(n){var c,l=this;this.setup=n,(c=this.cleanup)==null||c.call(this),this.cleanup=n(function(o){typeof o=="boolean"?l.setOnline(o):l.onOnline()})},s.setOnline=function(n){this.online=n,n&&this.onOnline()},s.onOnline=function(){this.listeners.forEach(function(n){n()})},s.isOnline=function(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine},a}($e),Ke=new Dr;function Mr(t){return Math.min(1e3*Math.pow(2,t),3e4)}function et(t){return typeof(t==null?void 0:t.cancel)=="function"}var Ht=function(a){this.revert=a==null?void 0:a.revert,this.silent=a==null?void 0:a.silent};function We(t){return t instanceof Ht}var Kt=function(a){var s=this,i=!1,n,c,l,o;this.abort=a.abort,this.cancel=function(w){return n==null?void 0:n(w)},this.cancelRetry=function(){i=!0},this.continueRetry=function(){i=!1},this.continue=function(){return c==null?void 0:c()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise(function(w,m){l=w,o=m});var d=function(m){s.isResolved||(s.isResolved=!0,a.onSuccess==null||a.onSuccess(m),c==null||c(),l(m))},u=function(m){s.isResolved||(s.isResolved=!0,a.onError==null||a.onError(m),c==null||c(),o(m))},h=function(){return new Promise(function(m){c=m,s.isPaused=!0,a.onPause==null||a.onPause()}).then(function(){c=void 0,s.isPaused=!1,a.onContinue==null||a.onContinue()})},C=function w(){if(!s.isResolved){var m;try{m=a.fn()}catch(f){m=Promise.reject(f)}n=function(S){if(!s.isResolved&&(u(new Ht(S)),s.abort==null||s.abort(),et(m)))try{m.cancel()}catch{}},s.isTransportCancelable=et(m),Promise.resolve(m).then(d).catch(function(f){var S,v;if(!s.isResolved){var b=(S=a.retry)!=null?S:3,N=(v=a.retryDelay)!=null?v:Mr,y=typeof N=="function"?N(s.failureCount,f):N,L=b===!0||typeof b=="number"&&s.failureCount<b||typeof b=="function"&&b(s.failureCount,f);if(i||!L){u(f);return}s.failureCount++,a.onFail==null||a.onFail(s.failureCount,f),Or(y).then(function(){if(!De.isFocused()||!Ke.isOnline())return h()}).then(function(){i?u(f):w()})}})}};C()},Ur=function(){function t(){this.queue=[],this.transactions=0,this.notifyFn=function(s){s()},this.batchNotifyFn=function(s){s()}}var a=t.prototype;return a.batch=function(i){var n;this.transactions++;try{n=i()}finally{this.transactions--,this.transactions||this.flush()}return n},a.schedule=function(i){var n=this;this.transactions?this.queue.push(i):It(function(){n.notifyFn(i)})},a.batchCalls=function(i){var n=this;return function(){for(var c=arguments.length,l=new Array(c),o=0;o<c;o++)l[o]=arguments[o];n.schedule(function(){i.apply(void 0,l)})}},a.flush=function(){var i=this,n=this.queue;this.queue=[],n.length&&It(function(){i.batchNotifyFn(function(){n.forEach(function(c){i.notifyFn(c)})})})},a.setNotifyFunction=function(i){this.notifyFn=i},a.setBatchNotifyFunction=function(i){this.batchNotifyFn=i},t}(),ie=new Ur,Wt=console;function tt(){return Wt}function $r(t){Wt=t}var jr=function(){function t(s){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=s.defaultOptions,this.setOptions(s.options),this.observers=[],this.cache=s.cache,this.queryKey=s.queryKey,this.queryHash=s.queryHash,this.initialState=s.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=s.meta,this.scheduleGc()}var a=t.prototype;return a.setOptions=function(i){var n;this.options=J({},this.defaultOptions,i),this.meta=i==null?void 0:i.meta,this.cacheTime=Math.max(this.cacheTime||0,(n=this.options.cacheTime)!=null?n:5*60*1e3)},a.setDefaultOptions=function(i){this.defaultOptions=i},a.scheduleGc=function(){var i=this;this.clearGcTimeout(),ut(this.cacheTime)&&(this.gcTimeout=setTimeout(function(){i.optionalRemove()},this.cacheTime))},a.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},a.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},a.setData=function(i,n){var c,l,o=this.state.data,d=Pr(i,o);return(c=(l=this.options).isDataEqual)!=null&&c.call(l,o,d)?d=o:this.options.structuralSharing!==!1&&(d=Xe(o,d)),this.dispatch({data:d,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt}),d},a.setState=function(i,n){this.dispatch({type:"setState",state:i,setStateOptions:n})},a.cancel=function(i){var n,c=this.promise;return(n=this.retryer)==null||n.cancel(i),c?c.then(he).catch(he):Promise.resolve()},a.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},a.reset=function(){this.destroy(),this.setState(this.initialState)},a.isActive=function(){return this.observers.some(function(i){return i.options.enabled!==!1})},a.isFetching=function(){return this.state.isFetching},a.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(function(i){return i.getCurrentResult().isStale})},a.isStaleByTime=function(i){return i===void 0&&(i=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!Bt(this.state.dataUpdatedAt,i)},a.onFocus=function(){var i,n=this.observers.find(function(c){return c.shouldFetchOnWindowFocus()});n&&n.refetch(),(i=this.retryer)==null||i.continue()},a.onOnline=function(){var i,n=this.observers.find(function(c){return c.shouldFetchOnReconnect()});n&&n.refetch(),(i=this.retryer)==null||i.continue()},a.addObserver=function(i){this.observers.indexOf(i)===-1&&(this.observers.push(i),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:i}))},a.removeObserver=function(i){this.observers.indexOf(i)!==-1&&(this.observers=this.observers.filter(function(n){return n!==i}),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:i}))},a.getObserversCount=function(){return this.observers.length},a.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},a.fetch=function(i,n){var c=this,l,o,d;if(this.state.isFetching){if(this.state.dataUpdatedAt&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(this.promise){var u;return(u=this.retryer)==null||u.continueRetry(),this.promise}}if(i&&this.setOptions(i),!this.options.queryFn){var h=this.observers.find(function(N){return N.options.queryFn});h&&this.setOptions(h.options)}var C=Je(this.queryKey),w=zt(),m={queryKey:C,pageParam:void 0,meta:this.meta};Object.defineProperty(m,"signal",{enumerable:!0,get:function(){if(w)return c.abortSignalConsumed=!0,w.signal}});var f=function(){return c.options.queryFn?(c.abortSignalConsumed=!1,c.options.queryFn(m)):Promise.reject("Missing queryFn")},S={fetchOptions:n,options:this.options,queryKey:C,state:this.state,fetchFn:f,meta:this.meta};if((l=this.options.behavior)!=null&&l.onFetch){var v;(v=this.options.behavior)==null||v.onFetch(S)}if(this.revertState=this.state,!this.state.isFetching||this.state.fetchMeta!==((o=S.fetchOptions)==null?void 0:o.meta)){var b;this.dispatch({type:"fetch",meta:(b=S.fetchOptions)==null?void 0:b.meta})}return this.retryer=new Kt({fn:S.fetchFn,abort:w==null||(d=w.abort)==null?void 0:d.bind(w),onSuccess:function(y){c.setData(y),c.cache.config.onSuccess==null||c.cache.config.onSuccess(y,c),c.cacheTime===0&&c.optionalRemove()},onError:function(y){We(y)&&y.silent||c.dispatch({type:"error",error:y}),We(y)||(c.cache.config.onError==null||c.cache.config.onError(y,c),tt().error(y)),c.cacheTime===0&&c.optionalRemove()},onFail:function(){c.dispatch({type:"failed"})},onPause:function(){c.dispatch({type:"pause"})},onContinue:function(){c.dispatch({type:"continue"})},retry:S.options.retry,retryDelay:S.options.retryDelay}),this.promise=this.retryer.promise,this.promise},a.dispatch=function(i){var n=this;this.state=this.reducer(this.state,i),ie.batch(function(){n.observers.forEach(function(c){c.onQueryUpdate(i)}),n.cache.notify({query:n,type:"queryUpdated",action:i})})},a.getDefaultState=function(i){var n=typeof i.initialData=="function"?i.initialData():i.initialData,c=typeof i.initialData<"u",l=c?typeof i.initialDataUpdatedAt=="function"?i.initialDataUpdatedAt():i.initialDataUpdatedAt:0,o=typeof n<"u";return{data:n,dataUpdateCount:0,dataUpdatedAt:o?l??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:o?"success":"idle"}},a.reducer=function(i,n){var c,l;switch(n.type){case"failed":return J({},i,{fetchFailureCount:i.fetchFailureCount+1});case"pause":return J({},i,{isPaused:!0});case"continue":return J({},i,{isPaused:!1});case"fetch":return J({},i,{fetchFailureCount:0,fetchMeta:(c=n.meta)!=null?c:null,isFetching:!0,isPaused:!1},!i.dataUpdatedAt&&{error:null,status:"loading"});case"success":return J({},i,{data:n.data,dataUpdateCount:i.dataUpdateCount+1,dataUpdatedAt:(l=n.dataUpdatedAt)!=null?l:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var o=n.error;return We(o)&&o.revert&&this.revertState?J({},this.revertState):J({},i,{error:o,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return J({},i,{isInvalidated:!0});case"setState":return J({},i,n.state);default:return i}},t}(),qr=function(t){Me(a,t);function a(i){var n;return n=t.call(this)||this,n.config=i||{},n.queries=[],n.queriesMap={},n}var s=a.prototype;return s.build=function(n,c,l){var o,d=c.queryKey,u=(o=c.queryHash)!=null?o:Ct(d,c),h=this.get(u);return h||(h=new jr({cache:this,queryKey:d,queryHash:u,options:n.defaultQueryOptions(c),state:l,defaultOptions:n.getQueryDefaults(d),meta:c.meta}),this.add(h)),h},s.add=function(n){this.queriesMap[n.queryHash]||(this.queriesMap[n.queryHash]=n,this.queries.push(n),this.notify({type:"queryAdded",query:n}))},s.remove=function(n){var c=this.queriesMap[n.queryHash];c&&(n.destroy(),this.queries=this.queries.filter(function(l){return l!==n}),c===n&&delete this.queriesMap[n.queryHash],this.notify({type:"queryRemoved",query:n}))},s.clear=function(){var n=this;ie.batch(function(){n.queries.forEach(function(c){n.remove(c)})})},s.get=function(n){return this.queriesMap[n]},s.getAll=function(){return this.queries},s.find=function(n,c){var l=Re(n,c),o=l[0];return typeof o.exact>"u"&&(o.exact=!0),this.queries.find(function(d){return Pt(o,d)})},s.findAll=function(n,c){var l=Re(n,c),o=l[0];return Object.keys(o).length>0?this.queries.filter(function(d){return Pt(o,d)}):this.queries},s.notify=function(n){var c=this;ie.batch(function(){c.listeners.forEach(function(l){l(n)})})},s.onFocus=function(){var n=this;ie.batch(function(){n.queries.forEach(function(c){c.onFocus()})})},s.onOnline=function(){var n=this;ie.batch(function(){n.queries.forEach(function(c){c.onOnline()})})},a}($e),Qr=function(){function t(s){this.options=J({},s.defaultOptions,s.options),this.mutationId=s.mutationId,this.mutationCache=s.mutationCache,this.observers=[],this.state=s.state||Br(),this.meta=s.meta}var a=t.prototype;return a.setState=function(i){this.dispatch({type:"setState",state:i})},a.addObserver=function(i){this.observers.indexOf(i)===-1&&this.observers.push(i)},a.removeObserver=function(i){this.observers=this.observers.filter(function(n){return n!==i})},a.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(he).catch(he)):Promise.resolve()},a.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},a.execute=function(){var i=this,n,c=this.state.status==="loading",l=Promise.resolve();return c||(this.dispatch({type:"loading",variables:this.options.variables}),l=l.then(function(){i.mutationCache.config.onMutate==null||i.mutationCache.config.onMutate(i.state.variables,i)}).then(function(){return i.options.onMutate==null?void 0:i.options.onMutate(i.state.variables)}).then(function(o){o!==i.state.context&&i.dispatch({type:"loading",context:o,variables:i.state.variables})})),l.then(function(){return i.executeMutation()}).then(function(o){n=o,i.mutationCache.config.onSuccess==null||i.mutationCache.config.onSuccess(n,i.state.variables,i.state.context,i)}).then(function(){return i.options.onSuccess==null?void 0:i.options.onSuccess(n,i.state.variables,i.state.context)}).then(function(){return i.options.onSettled==null?void 0:i.options.onSettled(n,null,i.state.variables,i.state.context)}).then(function(){return i.dispatch({type:"success",data:n}),n}).catch(function(o){return i.mutationCache.config.onError==null||i.mutationCache.config.onError(o,i.state.variables,i.state.context,i),tt().error(o),Promise.resolve().then(function(){return i.options.onError==null?void 0:i.options.onError(o,i.state.variables,i.state.context)}).then(function(){return i.options.onSettled==null?void 0:i.options.onSettled(void 0,o,i.state.variables,i.state.context)}).then(function(){throw i.dispatch({type:"error",error:o}),o})})},a.executeMutation=function(){var i=this,n;return this.retryer=new Kt({fn:function(){return i.options.mutationFn?i.options.mutationFn(i.state.variables):Promise.reject("No mutationFn found")},onFail:function(){i.dispatch({type:"failed"})},onPause:function(){i.dispatch({type:"pause"})},onContinue:function(){i.dispatch({type:"continue"})},retry:(n=this.options.retry)!=null?n:0,retryDelay:this.options.retryDelay}),this.retryer.promise},a.dispatch=function(i){var n=this;this.state=Gr(this.state,i),ie.batch(function(){n.observers.forEach(function(c){c.onMutationUpdate(i)}),n.mutationCache.notify(n)})},t}();function Br(){return{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0}}function Gr(t,a){switch(a.type){case"failed":return J({},t,{failureCount:t.failureCount+1});case"pause":return J({},t,{isPaused:!0});case"continue":return J({},t,{isPaused:!1});case"loading":return J({},t,{context:a.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:a.variables});case"success":return J({},t,{data:a.data,error:null,status:"success",isPaused:!1});case"error":return J({},t,{data:void 0,error:a.error,failureCount:t.failureCount+1,isPaused:!1,status:"error"});case"setState":return J({},t,a.state);default:return t}}var zr=function(t){Me(a,t);function a(i){var n;return n=t.call(this)||this,n.config=i||{},n.mutations=[],n.mutationId=0,n}var s=a.prototype;return s.build=function(n,c,l){var o=new Qr({mutationCache:this,mutationId:++this.mutationId,options:n.defaultMutationOptions(c),state:l,defaultOptions:c.mutationKey?n.getMutationDefaults(c.mutationKey):void 0,meta:c.meta});return this.add(o),o},s.add=function(n){this.mutations.push(n),this.notify(n)},s.remove=function(n){this.mutations=this.mutations.filter(function(c){return c!==n}),n.cancel(),this.notify(n)},s.clear=function(){var n=this;ie.batch(function(){n.mutations.forEach(function(c){n.remove(c)})})},s.getAll=function(){return this.mutations},s.find=function(n){return typeof n.exact>"u"&&(n.exact=!0),this.mutations.find(function(c){return Ft(n,c)})},s.findAll=function(n){return this.mutations.filter(function(c){return Ft(n,c)})},s.notify=function(n){var c=this;ie.batch(function(){c.listeners.forEach(function(l){l(n)})})},s.onFocus=function(){this.resumePausedMutations()},s.onOnline=function(){this.resumePausedMutations()},s.resumePausedMutations=function(){var n=this.mutations.filter(function(c){return c.state.isPaused});return ie.batch(function(){return n.reduce(function(c,l){return c.then(function(){return l.continue().catch(he)})},Promise.resolve())})},a}($e);function Hr(){return{onFetch:function(a){a.fetchFn=function(){var s,i,n,c,l,o,d=(s=a.fetchOptions)==null||(i=s.meta)==null?void 0:i.refetchPage,u=(n=a.fetchOptions)==null||(c=n.meta)==null?void 0:c.fetchMore,h=u==null?void 0:u.pageParam,C=(u==null?void 0:u.direction)==="forward",w=(u==null?void 0:u.direction)==="backward",m=((l=a.state.data)==null?void 0:l.pages)||[],f=((o=a.state.data)==null?void 0:o.pageParams)||[],S=zt(),v=S==null?void 0:S.signal,b=f,N=!1,y=a.options.queryFn||function(){return Promise.reject("Missing queryFn")},L=function(R,B,G,X){return b=X?[B].concat(b):[].concat(b,[B]),X?[G].concat(R):[].concat(R,[G])},x=function(R,B,G,X){if(N)return Promise.reject("Cancelled");if(typeof G>"u"&&!B&&R.length)return Promise.resolve(R);var ne={queryKey:a.queryKey,signal:v,pageParam:G,meta:a.meta},ae=y(ne),me=Promise.resolve(ae).then(function(Oe){return L(R,G,Oe,X)});if(et(ae)){var ke=me;ke.cancel=ae.cancel}return me},F;if(!m.length)F=x([]);else if(C){var Q=typeof h<"u",E=Q?h:Ot(a.options,m);F=x(m,Q,E)}else if(w){var $=typeof h<"u",D=$?h:Kr(a.options,m);F=x(m,$,D,!0)}else(function(){b=[];var V=typeof a.options.getNextPageParam>"u",R=d&&m[0]?d(m[0],0,m):!0;F=R?x([],V,f[0]):Promise.resolve(L([],f[0],m[0]));for(var B=function(ne){F=F.then(function(ae){var me=d&&m[ne]?d(m[ne],ne,m):!0;if(me){var ke=V?f[ne]:Ot(a.options,ae);return x(ae,V,ke)}return Promise.resolve(L(ae,f[ne],m[ne]))})},G=1;G<m.length;G++)B(G)})();var I=F.then(function(V){return{pages:V,pageParams:b}}),K=I;return K.cancel=function(){N=!0,S==null||S.abort(),et(F)&&F.cancel()},I}}}}function Ot(t,a){return t.getNextPageParam==null?void 0:t.getNextPageParam(a[a.length-1],a)}function Kr(t,a){return t.getPreviousPageParam==null?void 0:t.getPreviousPageParam(a[0],a)}var Wr=function(){function t(s){s===void 0&&(s={}),this.queryCache=s.queryCache||new qr,this.mutationCache=s.mutationCache||new zr,this.defaultOptions=s.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var a=t.prototype;return a.mount=function(){var i=this;this.unsubscribeFocus=De.subscribe(function(){De.isFocused()&&Ke.isOnline()&&(i.mutationCache.onFocus(),i.queryCache.onFocus())}),this.unsubscribeOnline=Ke.subscribe(function(){De.isFocused()&&Ke.isOnline()&&(i.mutationCache.onOnline(),i.queryCache.onOnline())})},a.unmount=function(){var i,n;(i=this.unsubscribeFocus)==null||i.call(this),(n=this.unsubscribeOnline)==null||n.call(this)},a.isFetching=function(i,n){var c=Re(i,n),l=c[0];return l.fetching=!0,this.queryCache.findAll(l).length},a.isMutating=function(i){return this.mutationCache.findAll(J({},i,{fetching:!0})).length},a.getQueryData=function(i,n){var c;return(c=this.queryCache.find(i,n))==null?void 0:c.state.data},a.getQueriesData=function(i){return this.getQueryCache().findAll(i).map(function(n){var c=n.queryKey,l=n.state,o=l.data;return[c,o]})},a.setQueryData=function(i,n,c){var l=He(i),o=this.defaultQueryOptions(l);return this.queryCache.build(this,o).setData(n,c)},a.setQueriesData=function(i,n,c){var l=this;return ie.batch(function(){return l.getQueryCache().findAll(i).map(function(o){var d=o.queryKey;return[d,l.setQueryData(d,n,c)]})})},a.getQueryState=function(i,n){var c;return(c=this.queryCache.find(i,n))==null?void 0:c.state},a.removeQueries=function(i,n){var c=Re(i,n),l=c[0],o=this.queryCache;ie.batch(function(){o.findAll(l).forEach(function(d){o.remove(d)})})},a.resetQueries=function(i,n,c){var l=this,o=Re(i,n,c),d=o[0],u=o[1],h=this.queryCache,C=J({},d,{active:!0});return ie.batch(function(){return h.findAll(d).forEach(function(w){w.reset()}),l.refetchQueries(C,u)})},a.cancelQueries=function(i,n,c){var l=this,o=Re(i,n,c),d=o[0],u=o[1],h=u===void 0?{}:u;typeof h.revert>"u"&&(h.revert=!0);var C=ie.batch(function(){return l.queryCache.findAll(d).map(function(w){return w.cancel(h)})});return Promise.all(C).then(he).catch(he)},a.invalidateQueries=function(i,n,c){var l,o,d,u=this,h=Re(i,n,c),C=h[0],w=h[1],m=J({},C,{active:(l=(o=C.refetchActive)!=null?o:C.active)!=null?l:!0,inactive:(d=C.refetchInactive)!=null?d:!1});return ie.batch(function(){return u.queryCache.findAll(C).forEach(function(f){f.invalidate()}),u.refetchQueries(m,w)})},a.refetchQueries=function(i,n,c){var l=this,o=Re(i,n,c),d=o[0],u=o[1],h=ie.batch(function(){return l.queryCache.findAll(d).map(function(w){return w.fetch(void 0,J({},u,{meta:{refetchPage:d==null?void 0:d.refetchPage}}))})}),C=Promise.all(h).then(he);return u!=null&&u.throwOnError||(C=C.catch(he)),C},a.fetchQuery=function(i,n,c){var l=He(i,n,c),o=this.defaultQueryOptions(l);typeof o.retry>"u"&&(o.retry=!1);var d=this.queryCache.build(this,o);return d.isStaleByTime(o.staleTime)?d.fetch(o):Promise.resolve(d.state.data)},a.prefetchQuery=function(i,n,c){return this.fetchQuery(i,n,c).then(he).catch(he)},a.fetchInfiniteQuery=function(i,n,c){var l=He(i,n,c);return l.behavior=Hr(),this.fetchQuery(l)},a.prefetchInfiniteQuery=function(i,n,c){return this.fetchInfiniteQuery(i,n,c).then(he).catch(he)},a.cancelMutations=function(){var i=this,n=ie.batch(function(){return i.mutationCache.getAll().map(function(c){return c.cancel()})});return Promise.all(n).then(he).catch(he)},a.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},a.executeMutation=function(i){return this.mutationCache.build(this,i).execute()},a.getQueryCache=function(){return this.queryCache},a.getMutationCache=function(){return this.mutationCache},a.getDefaultOptions=function(){return this.defaultOptions},a.setDefaultOptions=function(i){this.defaultOptions=i},a.setQueryDefaults=function(i,n){var c=this.queryDefaults.find(function(l){return Pe(i)===Pe(l.queryKey)});c?c.defaultOptions=n:this.queryDefaults.push({queryKey:i,defaultOptions:n})},a.getQueryDefaults=function(i){var n;return i?(n=this.queryDefaults.find(function(c){return Ze(i,c.queryKey)}))==null?void 0:n.defaultOptions:void 0},a.setMutationDefaults=function(i,n){var c=this.mutationDefaults.find(function(l){return Pe(i)===Pe(l.mutationKey)});c?c.defaultOptions=n:this.mutationDefaults.push({mutationKey:i,defaultOptions:n})},a.getMutationDefaults=function(i){var n;return i?(n=this.mutationDefaults.find(function(c){return Ze(i,c.mutationKey)}))==null?void 0:n.defaultOptions:void 0},a.defaultQueryOptions=function(i){if(i!=null&&i._defaulted)return i;var n=J({},this.defaultOptions.queries,this.getQueryDefaults(i==null?void 0:i.queryKey),i,{_defaulted:!0});return!n.queryHash&&n.queryKey&&(n.queryHash=Ct(n.queryKey,n)),n},a.defaultQueryObserverOptions=function(i){return this.defaultQueryOptions(i)},a.defaultMutationOptions=function(i){return i!=null&&i._defaulted?i:J({},this.defaultOptions.mutations,this.getMutationDefaults(i==null?void 0:i.mutationKey),i,{_defaulted:!0})},a.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},t}(),Vr=function(t){Me(a,t);function a(i,n){var c;return c=t.call(this)||this,c.client=i,c.options=n,c.trackedProps=[],c.selectError=null,c.bindMethods(),c.setOptions(n),c}var s=a.prototype;return s.bindMethods=function(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)},s.onSubscribe=function(){this.listeners.length===1&&(this.currentQuery.addObserver(this),Tt(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())},s.onUnsubscribe=function(){this.listeners.length||this.destroy()},s.shouldFetchOnReconnect=function(){return mt(this.currentQuery,this.options,this.options.refetchOnReconnect)},s.shouldFetchOnWindowFocus=function(){return mt(this.currentQuery,this.options,this.options.refetchOnWindowFocus)},s.destroy=function(){this.listeners=[],this.clearTimers(),this.currentQuery.removeObserver(this)},s.setOptions=function(n,c){var l=this.options,o=this.currentQuery;if(this.options=this.client.defaultQueryObserverOptions(n),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=l.queryKey),this.updateQuery();var d=this.hasListeners();d&&Dt(this.currentQuery,o,this.options,l)&&this.executeFetch(),this.updateResult(c),d&&(this.currentQuery!==o||this.options.enabled!==l.enabled||this.options.staleTime!==l.staleTime)&&this.updateStaleTimeout();var u=this.computeRefetchInterval();d&&(this.currentQuery!==o||this.options.enabled!==l.enabled||u!==this.currentRefetchInterval)&&this.updateRefetchInterval(u)},s.getOptimisticResult=function(n){var c=this.client.defaultQueryObserverOptions(n),l=this.client.getQueryCache().build(this.client,c);return this.createResult(l,c)},s.getCurrentResult=function(){return this.currentResult},s.trackResult=function(n,c){var l=this,o={},d=function(h){l.trackedProps.includes(h)||l.trackedProps.push(h)};return Object.keys(n).forEach(function(u){Object.defineProperty(o,u,{configurable:!1,enumerable:!0,get:function(){return d(u),n[u]}})}),(c.useErrorBoundary||c.suspense)&&d("error"),o},s.getNextResult=function(n){var c=this;return new Promise(function(l,o){var d=c.subscribe(function(u){u.isFetching||(d(),u.isError&&(n!=null&&n.throwOnError)?o(u.error):l(u))})})},s.getCurrentQuery=function(){return this.currentQuery},s.remove=function(){this.client.getQueryCache().remove(this.currentQuery)},s.refetch=function(n){return this.fetch(J({},n,{meta:{refetchPage:n==null?void 0:n.refetchPage}}))},s.fetchOptimistic=function(n){var c=this,l=this.client.defaultQueryObserverOptions(n),o=this.client.getQueryCache().build(this.client,l);return o.fetch().then(function(){return c.createResult(o,l)})},s.fetch=function(n){var c=this;return this.executeFetch(n).then(function(){return c.updateResult(),c.currentResult})},s.executeFetch=function(n){this.updateQuery();var c=this.currentQuery.fetch(this.options,n);return n!=null&&n.throwOnError||(c=c.catch(he)),c},s.updateStaleTimeout=function(){var n=this;if(this.clearStaleTimeout(),!(Ye||this.currentResult.isStale||!ut(this.options.staleTime))){var c=Bt(this.currentResult.dataUpdatedAt,this.options.staleTime),l=c+1;this.staleTimeoutId=setTimeout(function(){n.currentResult.isStale||n.updateResult()},l)}},s.computeRefetchInterval=function(){var n;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(n=this.options.refetchInterval)!=null?n:!1},s.updateRefetchInterval=function(n){var c=this;this.clearRefetchInterval(),this.currentRefetchInterval=n,!(Ye||this.options.enabled===!1||!ut(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(function(){(c.options.refetchIntervalInBackground||De.isFocused())&&c.executeFetch()},this.currentRefetchInterval))},s.updateTimers=function(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())},s.clearTimers=function(){this.clearStaleTimeout(),this.clearRefetchInterval()},s.clearStaleTimeout=function(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)},s.clearRefetchInterval=function(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)},s.createResult=function(n,c){var l=this.currentQuery,o=this.options,d=this.currentResult,u=this.currentResultState,h=this.currentResultOptions,C=n!==l,w=C?n.state:this.currentQueryInitialState,m=C?this.currentResult:this.previousQueryResult,f=n.state,S=f.dataUpdatedAt,v=f.error,b=f.errorUpdatedAt,N=f.isFetching,y=f.status,L=!1,x=!1,F;if(c.optimisticResults){var Q=this.hasListeners(),E=!Q&&Tt(n,c),$=Q&&Dt(n,l,c,o);(E||$)&&(N=!0,S||(y="loading"))}if(c.keepPreviousData&&!f.dataUpdateCount&&(m!=null&&m.isSuccess)&&y!=="error")F=m.data,S=m.dataUpdatedAt,y=m.status,L=!0;else if(c.select&&typeof f.data<"u")if(d&&f.data===(u==null?void 0:u.data)&&c.select===this.selectFn)F=this.selectResult;else try{this.selectFn=c.select,F=c.select(f.data),c.structuralSharing!==!1&&(F=Xe(d==null?void 0:d.data,F)),this.selectResult=F,this.selectError=null}catch(K){tt().error(K),this.selectError=K}else F=f.data;if(typeof c.placeholderData<"u"&&typeof F>"u"&&(y==="loading"||y==="idle")){var D;if(d!=null&&d.isPlaceholderData&&c.placeholderData===(h==null?void 0:h.placeholderData))D=d.data;else if(D=typeof c.placeholderData=="function"?c.placeholderData():c.placeholderData,c.select&&typeof D<"u")try{D=c.select(D),c.structuralSharing!==!1&&(D=Xe(d==null?void 0:d.data,D)),this.selectError=null}catch(K){tt().error(K),this.selectError=K}typeof D<"u"&&(y="success",F=D,x=!0)}this.selectError&&(v=this.selectError,F=this.selectResult,b=Date.now(),y="error");var I={status:y,isLoading:y==="loading",isSuccess:y==="success",isError:y==="error",isIdle:y==="idle",data:F,dataUpdatedAt:S,error:v,errorUpdatedAt:b,failureCount:f.fetchFailureCount,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>w.dataUpdateCount||f.errorUpdateCount>w.errorUpdateCount,isFetching:N,isRefetching:N&&y!=="loading",isLoadingError:y==="error"&&f.dataUpdatedAt===0,isPlaceholderData:x,isPreviousData:L,isRefetchError:y==="error"&&f.dataUpdatedAt!==0,isStale:St(n,c),refetch:this.refetch,remove:this.remove};return I},s.shouldNotifyListeners=function(n,c){if(!c)return!0;var l=this.options,o=l.notifyOnChangeProps,d=l.notifyOnChangePropsExclusions;if(!o&&!d||o==="tracked"&&!this.trackedProps.length)return!0;var u=o==="tracked"?this.trackedProps:o;return Object.keys(n).some(function(h){var C=h,w=n[C]!==c[C],m=u==null?void 0:u.some(function(S){return S===h}),f=d==null?void 0:d.some(function(S){return S===h});return w&&!f&&(!u||m)})},s.updateResult=function(n){var c=this.currentResult;if(this.currentResult=this.createResult(this.currentQuery,this.options),this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,!Ir(this.currentResult,c)){var l={cache:!0};(n==null?void 0:n.listeners)!==!1&&this.shouldNotifyListeners(this.currentResult,c)&&(l.listeners=!0),this.notify(J({},l,n))}},s.updateQuery=function(){var n=this.client.getQueryCache().build(this.client,this.options);if(n!==this.currentQuery){var c=this.currentQuery;this.currentQuery=n,this.currentQueryInitialState=n.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(c==null||c.removeObserver(this),n.addObserver(this))}},s.onQueryUpdate=function(n){var c={};n.type==="success"?c.onSuccess=!0:n.type==="error"&&!We(n.error)&&(c.onError=!0),this.updateResult(c),this.hasListeners()&&this.updateTimers()},s.notify=function(n){var c=this;ie.batch(function(){n.onSuccess?(c.options.onSuccess==null||c.options.onSuccess(c.currentResult.data),c.options.onSettled==null||c.options.onSettled(c.currentResult.data,null)):n.onError&&(c.options.onError==null||c.options.onError(c.currentResult.error),c.options.onSettled==null||c.options.onSettled(void 0,c.currentResult.error)),n.listeners&&c.listeners.forEach(function(l){l(c.currentResult)}),n.cache&&c.client.getQueryCache().notify({query:c.currentQuery,type:"observerResultsUpdated"})})},a}($e);function Yr(t,a){return a.enabled!==!1&&!t.state.dataUpdatedAt&&!(t.state.status==="error"&&a.retryOnMount===!1)}function Tt(t,a){return Yr(t,a)||t.state.dataUpdatedAt>0&&mt(t,a,a.refetchOnMount)}function mt(t,a,s){if(a.enabled!==!1){var i=typeof s=="function"?s(t):s;return i==="always"||i!==!1&&St(t,a)}return!1}function Dt(t,a,s,i){return s.enabled!==!1&&(t!==a||i.enabled===!1)&&(!s.suspense||t.state.status!=="error")&&St(t,s)}function St(t,a){return t.isStaleByTime(a.staleTime)}var Jr=kr.unstable_batchedUpdates;ie.setBatchNotifyFunction(Jr);var Zr=console;$r(Zr);var Mt=te.createContext(void 0),Vt=te.createContext(!1);function Yt(t){return t&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=Mt),window.ReactQueryClientContext):Mt}var Jt=function(){var a=te.useContext(Yt(te.useContext(Vt)));if(!a)throw new Error("No QueryClient set, use QueryClientProvider to set one");return a},Xr=function(a){var s=a.client,i=a.contextSharing,n=i===void 0?!1:i,c=a.children;te.useEffect(function(){return s.mount(),function(){s.unmount()}},[s]);var l=Yt(n);return te.createElement(Vt.Provider,{value:n},te.createElement(l.Provider,{value:s},c))};function ea(){var t=!1;return{clearReset:function(){t=!1},reset:function(){t=!0},isReset:function(){return t}}}var ta=te.createContext(ea()),ra=function(){return te.useContext(ta)};function aa(t,a,s){return typeof a=="function"?a.apply(void 0,s):typeof a=="boolean"?a:!!t}function sa(t,a){var s=te.useRef(!1),i=te.useState(0),n=i[1],c=Jt(),l=ra(),o=c.defaultQueryObserverOptions(t);o.optimisticResults=!0,o.onError&&(o.onError=ie.batchCalls(o.onError)),o.onSuccess&&(o.onSuccess=ie.batchCalls(o.onSuccess)),o.onSettled&&(o.onSettled=ie.batchCalls(o.onSettled)),o.suspense&&(typeof o.staleTime!="number"&&(o.staleTime=1e3),o.cacheTime===0&&(o.cacheTime=1)),(o.suspense||o.useErrorBoundary)&&(l.isReset()||(o.retryOnMount=!1));var d=te.useState(function(){return new a(c,o)}),u=d[0],h=u.getOptimisticResult(o);if(te.useEffect(function(){s.current=!0,l.clearReset();var C=u.subscribe(ie.batchCalls(function(){s.current&&n(function(w){return w+1})}));return u.updateResult(),function(){s.current=!1,C()}},[l,u]),te.useEffect(function(){u.setOptions(o,{listeners:!1})},[o,u]),o.suspense&&h.isLoading)throw u.fetchOptimistic(o).then(function(C){var w=C.data;o.onSuccess==null||o.onSuccess(w),o.onSettled==null||o.onSettled(w,null)}).catch(function(C){l.clearReset(),o.onError==null||o.onError(C),o.onSettled==null||o.onSettled(void 0,C)});if(h.isError&&!l.isReset()&&!h.isFetching&&aa(o.suspense,o.useErrorBoundary,[h.error,u.getCurrentQuery()]))throw h.error;return o.notifyOnChangeProps==="tracked"&&(h=u.trackResult(h,o)),h}function be(t,a,s){var i=He(t,a,s);return sa(i,Vr)}let na={data:""},ia=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||na,la=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,ca=/\/\*[^]*?\*\/|  +/g,Ut=/\n+/g,Ae=(t,a)=>{let s="",i="",n="";for(let c in t){let l=t[c];c[0]=="@"?c[1]=="i"?s=c+" "+l+";":i+=c[1]=="f"?Ae(l,c):c+"{"+Ae(l,c[1]=="k"?"":a)+"}":typeof l=="object"?i+=Ae(l,a?a.replace(/([^,])+/g,o=>c.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,o):o?o+" "+d:d)):c):l!=null&&(c=/^--/.test(c)?c:c.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=Ae.p?Ae.p(c,l):c+":"+l+";")}return s+(a&&n?a+"{"+n+"}":n)+i},_e={},Zt=t=>{if(typeof t=="object"){let a="";for(let s in t)a+=s+Zt(t[s]);return a}return t},oa=(t,a,s,i,n)=>{let c=Zt(t),l=_e[c]||(_e[c]=(d=>{let u=0,h=11;for(;u<d.length;)h=101*h+d.charCodeAt(u++)>>>0;return"go"+h})(c));if(!_e[l]){let d=c!==t?t:(u=>{let h,C,w=[{}];for(;h=la.exec(u.replace(ca,""));)h[4]?w.shift():h[3]?(C=h[3].replace(Ut," ").trim(),w.unshift(w[0][C]=w[0][C]||{})):w[0][h[1]]=h[2].replace(Ut," ").trim();return w[0]})(t);_e[l]=Ae(n?{["@keyframes "+l]:d}:d,s?"":"."+l)}let o=s&&_e.g?_e.g:null;return s&&(_e.g=_e[l]),((d,u,h,C)=>{C?u.data=u.data.replace(C,d):u.data.indexOf(d)===-1&&(u.data=h?d+u.data:u.data+d)})(_e[l],a,i,o),l},da=(t,a,s)=>t.reduce((i,n,c)=>{let l=a[c];if(l&&l.call){let o=l(s),d=o&&o.props&&o.props.className||/^go/.test(o)&&o;l=d?"."+d:o&&typeof o=="object"?o.props?"":Ae(o,""):o===!1?"":o}return i+n+(l??"")},"");function it(t){let a=this||{},s=t.call?t(a.p):t;return oa(s.unshift?s.raw?da(s,[].slice.call(arguments,1),a.p):s.reduce((i,n)=>Object.assign(i,n&&n.call?n(a.p):n),{}):s,ia(a.target),a.g,a.o,a.k)}let Xt,pt,ft;it.bind({g:1});let xe=it.bind({k:1});function ua(t,a,s,i){Ae.p=a,Xt=t,pt=s,ft=i}function Le(t,a){let s=this||{};return function(){let i=arguments;function n(c,l){let o=Object.assign({},c),d=o.className||n.className;s.p=Object.assign({theme:pt&&pt()},o),s.o=/ *go\d+/.test(d),o.className=it.apply(s,i)+(d?" "+d:""),a&&(o.ref=l);let u=t;return t[0]&&(u=o.as||t,delete o.as),ft&&u[0]&&ft(o),Xt(u,o)}return a?a(n):n}}var ha=t=>typeof t=="function",rt=(t,a)=>ha(t)?t(a):t,ma=(()=>{let t=0;return()=>(++t).toString()})(),er=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let a=matchMedia("(prefers-reduced-motion: reduce)");t=!a||a.matches}return t}})(),pa=20,wt="default",tr=(t,a)=>{let{toastLimit:s}=t.settings;switch(a.type){case 0:return{...t,toasts:[a.toast,...t.toasts].slice(0,s)};case 1:return{...t,toasts:t.toasts.map(l=>l.id===a.toast.id?{...l,...a.toast}:l)};case 2:let{toast:i}=a;return tr(t,{type:t.toasts.find(l=>l.id===i.id)?1:0,toast:i});case 3:let{toastId:n}=a;return{...t,toasts:t.toasts.map(l=>l.id===n||n===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return a.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(l=>l.id!==a.toastId)};case 5:return{...t,pausedAt:a.time};case 6:let c=a.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+c}))}}},Ve=[],rr={toasts:[],pausedAt:void 0,settings:{toastLimit:pa}},Se={},ar=(t,a=wt)=>{Se[a]=tr(Se[a]||rr,t),Ve.forEach(([s,i])=>{s===a&&i(Se[a])})},sr=t=>Object.keys(Se).forEach(a=>ar(t,a)),fa=t=>Object.keys(Se).find(a=>Se[a].toasts.some(s=>s.id===t)),lt=(t=wt)=>a=>{ar(a,t)},ga={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},va=(t={},a=wt)=>{let[s,i]=p.useState(Se[a]||rr),n=p.useRef(Se[a]);p.useEffect(()=>(n.current!==Se[a]&&i(Se[a]),Ve.push([a,i]),()=>{let l=Ve.findIndex(([o])=>o===a);l>-1&&Ve.splice(l,1)}),[a]);let c=s.toasts.map(l=>{var o,d,u;return{...t,...t[l.type],...l,removeDelay:l.removeDelay||((o=t[l.type])==null?void 0:o.removeDelay)||(t==null?void 0:t.removeDelay),duration:l.duration||((d=t[l.type])==null?void 0:d.duration)||(t==null?void 0:t.duration)||ga[l.type],style:{...t.style,...(u=t[l.type])==null?void 0:u.style,...l.style}}});return{...s,toasts:c}},ba=(t,a="blank",s)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:a,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...s,id:(s==null?void 0:s.id)||ma()}),je=t=>(a,s)=>{let i=ba(a,t,s);return lt(i.toasterId||fa(i.id))({type:2,toast:i}),i.id},ce=(t,a)=>je("blank")(t,a);ce.error=je("error");ce.success=je("success");ce.loading=je("loading");ce.custom=je("custom");ce.dismiss=(t,a)=>{let s={type:3,toastId:t};a?lt(a)(s):sr(s)};ce.dismissAll=t=>ce.dismiss(void 0,t);ce.remove=(t,a)=>{let s={type:4,toastId:t};a?lt(a)(s):sr(s)};ce.removeAll=t=>ce.remove(void 0,t);ce.promise=(t,a,s)=>{let i=ce.loading(a.loading,{...s,...s==null?void 0:s.loading});return typeof t=="function"&&(t=t()),t.then(n=>{let c=a.success?rt(a.success,n):void 0;return c?ce.success(c,{id:i,...s,...s==null?void 0:s.success}):ce.dismiss(i),n}).catch(n=>{let c=a.error?rt(a.error,n):void 0;c?ce.error(c,{id:i,...s,...s==null?void 0:s.error}):ce.dismiss(i)}),t};var ya=1e3,Na=(t,a="default")=>{let{toasts:s,pausedAt:i}=va(t,a),n=p.useRef(new Map).current,c=p.useCallback((C,w=ya)=>{if(n.has(C))return;let m=setTimeout(()=>{n.delete(C),l({type:4,toastId:C})},w);n.set(C,m)},[]);p.useEffect(()=>{if(i)return;let C=Date.now(),w=s.map(m=>{if(m.duration===1/0)return;let f=(m.duration||0)+m.pauseDuration-(C-m.createdAt);if(f<0){m.visible&&ce.dismiss(m.id);return}return setTimeout(()=>ce.dismiss(m.id,a),f)});return()=>{w.forEach(m=>m&&clearTimeout(m))}},[s,i,a]);let l=p.useCallback(lt(a),[a]),o=p.useCallback(()=>{l({type:5,time:Date.now()})},[l]),d=p.useCallback((C,w)=>{l({type:1,toast:{id:C,height:w}})},[l]),u=p.useCallback(()=>{i&&l({type:6,time:Date.now()})},[i,l]),h=p.useCallback((C,w)=>{let{reverseOrder:m=!1,gutter:f=8,defaultPosition:S}=w||{},v=s.filter(y=>(y.position||S)===(C.position||S)&&y.height),b=v.findIndex(y=>y.id===C.id),N=v.filter((y,L)=>L<b&&y.visible).length;return v.filter(y=>y.visible).slice(...m?[N+1]:[0,N]).reduce((y,L)=>y+(L.height||0)+f,0)},[s]);return p.useEffect(()=>{s.forEach(C=>{if(C.dismissed)c(C.id,C.removeDelay);else{let w=n.get(C.id);w&&(clearTimeout(w),n.delete(C.id))}})},[s,c]),{toasts:s,handlers:{updateHeight:d,startPause:o,endPause:u,calculateOffset:h}}},Ca=xe`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Sa=xe`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,wa=xe`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,_a=Le("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Ca} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Sa} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${wa} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,xa=xe`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Ra=Le("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${xa} 1s linear infinite;
`,Aa=xe`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,La=xe`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,ka=Le("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Aa} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${La} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Pa=Le("div")`
  position: absolute;
`,Fa=Le("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Ea=xe`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Ia=Le("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Ea} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Oa=({toast:t})=>{let{icon:a,type:s,iconTheme:i}=t;return a!==void 0?typeof a=="string"?p.createElement(Ia,null,a):a:s==="blank"?null:p.createElement(Fa,null,p.createElement(Ra,{...i}),s!=="loading"&&p.createElement(Pa,null,s==="error"?p.createElement(_a,{...i}):p.createElement(ka,{...i})))},Ta=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Da=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,Ma="0%{opacity:0;} 100%{opacity:1;}",Ua="0%{opacity:1;} 100%{opacity:0;}",$a=Le("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,ja=Le("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,qa=(t,a)=>{let s=t.includes("top")?1:-1,[i,n]=er()?[Ma,Ua]:[Ta(s),Da(s)];return{animation:a?`${xe(i)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${xe(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Qa=p.memo(({toast:t,position:a,style:s,children:i})=>{let n=t.height?qa(t.position||a||"top-center",t.visible):{opacity:0},c=p.createElement(Oa,{toast:t}),l=p.createElement(ja,{...t.ariaProps},rt(t.message,t));return p.createElement($a,{className:t.className,style:{...n,...s,...t.style}},typeof i=="function"?i({icon:c,message:l}):p.createElement(p.Fragment,null,c,l))});ua(p.createElement);var Ba=({id:t,className:a,style:s,onHeightUpdate:i,children:n})=>{let c=p.useCallback(l=>{if(l){let o=()=>{let d=l.getBoundingClientRect().height;i(t,d)};o(),new MutationObserver(o).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[t,i]);return p.createElement("div",{ref:c,className:a,style:s},n)},Ga=(t,a)=>{let s=t.includes("top"),i=s?{top:0}:{bottom:0},n=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:er()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${a*(s?1:-1)}px)`,...i,...n}},za=it`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ge=16,Ha=({reverseOrder:t,position:a="top-center",toastOptions:s,gutter:i,children:n,toasterId:c,containerStyle:l,containerClassName:o})=>{let{toasts:d,handlers:u}=Na(s,c);return p.createElement("div",{"data-rht-toaster":c||"",style:{position:"fixed",zIndex:9999,top:Ge,left:Ge,right:Ge,bottom:Ge,pointerEvents:"none",...l},className:o,onMouseEnter:u.startPause,onMouseLeave:u.endPause},d.map(h=>{let C=h.position||a,w=u.calculateOffset(h,{reverseOrder:t,gutter:i,defaultPosition:a}),m=Ga(C,w);return p.createElement(Ba,{id:h.id,key:h.id,onHeightUpdate:u.updateHeight,className:h.visible?za:"",style:m},h.type==="custom"?rt(h.message,h):n?n(h):p.createElement(Qa,{toast:h,position:C}))}))},P=ce;const nr="/assets/logo-3b0ed7d8.jpg";function Ka(){return p.useEffect(()=>(["icon","shortcut icon"].forEach(a=>{let s=document.querySelector(`link[rel="${a}"]`);s||(s=document.createElement("link"),s.setAttribute("rel",a),document.head.appendChild(s)),s.setAttribute("href",nr),s.setAttribute("type","image/jpeg")}),()=>{}),[]),null}const Wa=typeof import.meta<"u"&&{VITE_API_URL:"http://localhost:5003/api",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&!1,U=gr.create({baseURL:Wa?"/api":typeof import.meta<"u"&&{VITE_API_URL:"http://localhost:5003/api",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"http://localhost:5003/api"||typeof process<"u"&&process.env&&{}.REACT_APP_API_URL||"/api",timeout:3e4,headers:{"Content-Type":"application/json"}});U.interceptors.request.use(t=>{const a=localStorage.getItem("token");return a&&(t.headers.Authorization=`Bearer ${a}`),t},t=>Promise.reject(t));U.interceptors.response.use(t=>t,t=>{var l,o,d,u,h;const{response:a}=t,s=((l=a==null?void 0:a.config)==null?void 0:l.url)||((o=t==null?void 0:t.config)==null?void 0:o.url)||"",i=typeof s=="string"&&s.startsWith("/dashboard"),c=(((d=a==null?void 0:a.config)==null?void 0:d.method)||((u=t==null?void 0:t.config)==null?void 0:u.method)||"get").toLowerCase()==="get";if(a)switch(a.status){case 401:localStorage.removeItem("token"),delete U.defaults.headers.common.Authorization,window.location.pathname!=="/login"&&(window.location.href="/login");break;case 403:P.error("Access denied. You do not have permission for this action.");break;case 404:c||P.error("Resource not found.");break;case 429:c||P.error("Too many requests. Please try again later.");break;case 500:!i&&!c&&P.error("Server error. Please try again later.");break;default:!i&&!c&&((h=a.data)!=null&&h.error?P.error(a.data.error):P.error("An unexpected error occurred."))}else c||(t.code==="NETWORK_ERROR"?P.error("Network error. Please check your connection."):t.code==="TIMEOUT"?P.error("Request timeout. Please try again."):P.error("An unexpected error occurred."));return Promise.reject(t)});const T={auth:{login:t=>U.post("/auth/login",t),register:t=>U.post("/auth/register",t),getMe:()=>U.get("/auth/me"),changePassword:t=>U.post("/auth/change-password",t),logout:()=>U.post("/auth/logout"),verifyToken:()=>U.get("/auth/verify-token")},dashboard:{getPublic:()=>U.get("/dashboard/public"),getPersonal:()=>U.get("/dashboard/personal"),getAnalytics:(t=30)=>U.get("/dashboard/analytics",{params:{days:t}}),getNotifications:t=>U.get("/dashboard/notifications",{params:t}),getPending:t=>U.get("/dashboard/pending",{params:t}),getPendingCount:()=>U.get("/dashboard/pending/count"),getNotificationsCount:()=>U.get("/dashboard/notifications/count"),markNotificationRead:(t,a)=>U.post("/dashboard/notifications/mark-read",{type:t,id:a}),markAllNotificationsRead:()=>U.post("/dashboard/notifications/mark-all-read")},reports:{getAll:t=>U.get("/reports",{params:t}),getById:t=>U.get(`/reports/${t}`),create:t=>U.post("/reports",t),update:(t,a)=>U.put(`/reports/${t}`,a),moderate:(t,a)=>U.put(`/reports/${t}/moderate`,a),submit:t=>U.post(`/reports/${t}/submit`),delete:t=>U.delete(`/reports/${t}`),uploadAttachments:(t,a)=>U.post(`/reports/${t}/attachments`,a,{headers:{"Content-Type":"multipart/form-data"}}),listAttachments:t=>U.get(`/reports/${t}/attachments`),addFeedback:(t,a)=>U.post(`/reports/${t}/feedback`,a),getStats:()=>U.get("/reports/stats/summary")},users:{getMe:()=>U.get("/users/me"),updateMe:t=>U.put("/users/me",t),uploadAvatar:t=>{const a=new FormData;return a.append("avatar",t),U.post("/users/me/avatar",a,{headers:{"Content-Type":"multipart/form-data"}})},getAll:t=>U.get("/users",{params:t}),getById:t=>U.get(`/users/${t}`),create:t=>U.post("/users",t),update:(t,a)=>U.put(`/users/${t}`,a),delete:t=>U.delete(`/users/${t}`),deactivate:t=>U.post(`/users/${t}/deactivate`),reactivate:t=>U.post(`/users/${t}/reactivate`),resetPassword:t=>U.post(`/users/${t}/reset-password`),enroll:(t,a)=>U.post(`/users/${t}/enroll`,a),assignCourse:(t,a)=>U.post(`/users/${t}/assign-course`,a),getAvailableCourses:t=>U.get("/users/courses/available",{params:t}),getStreams:()=>U.get("/users/streams/list"),getLecturersByCourse:t=>U.get("/users/lecturers/by-course",{params:{courseId:t}}),rateClass:t=>U.post("/users/rate-class",t)},export:{reportsExcel:t=>U.get("/export/reports/excel",{params:t,responseType:"blob"}),reportsPdf:t=>U.get("/export/reports/pdf",{params:t}),analyticsExcel:t=>U.get("/export/analytics/excel",{params:t,responseType:"blob"}),usersExcel:t=>U.get("/export/users/excel",{params:t,responseType:"blob"})},admin:{getOverview:t=>t?U.get("/admin/overview",{params:{days:t}}):U.get("/admin/overview"),bulkUsers:t=>U.post("/admin/users/bulk",t),getAudit:t=>U.get("/admin/audit",{params:t})}},Ie=(t,a)=>{const s=window.URL.createObjectURL(t),i=document.createElement("a");i.setAttribute("href",s),i.setAttribute("download",a),document.body.appendChild(i),i.click(),i.remove(),window.URL.revokeObjectURL(s)},Va={user:null,token:localStorage.getItem("token"),isAuthenticated:!1,isLoading:!0},oe={LOGIN_START:"LOGIN_START",LOGIN_SUCCESS:"LOGIN_SUCCESS",LOGIN_FAILURE:"LOGIN_FAILURE",LOGOUT:"LOGOUT",LOAD_USER_START:"LOAD_USER_START",LOAD_USER_SUCCESS:"LOAD_USER_SUCCESS",LOAD_USER_FAILURE:"LOAD_USER_FAILURE",UPDATE_USER:"UPDATE_USER"},Ya=(t,a)=>{switch(a.type){case oe.LOGIN_START:case oe.LOAD_USER_START:return{...t,isLoading:!0};case oe.LOGIN_SUCCESS:return{...t,user:a.payload.user,token:a.payload.token,isAuthenticated:!0,isLoading:!1};case oe.LOAD_USER_SUCCESS:return{...t,user:a.payload.user,isAuthenticated:!0,isLoading:!1};case oe.LOGIN_FAILURE:case oe.LOAD_USER_FAILURE:case oe.LOGOUT:return{...t,user:null,token:null,isAuthenticated:!1,isLoading:!1};case oe.UPDATE_USER:return{...t,user:{...t.user,...a.payload}};default:return t}},ir=p.createContext(),ye=()=>{const t=p.useContext(ir);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},Ja=({children:t})=>{const[a,s]=p.useReducer(Ya,Va),i=m=>{m?(localStorage.setItem("token",m),U.defaults.headers.common.Authorization=`Bearer ${m}`):(localStorage.removeItem("token"),delete U.defaults.headers.common.Authorization)},n=async()=>{var f;const m=localStorage.getItem("token");if(!m){s({type:oe.LOAD_USER_FAILURE});return}try{s({type:oe.LOAD_USER_START}),i(m);let v=(await U.get("/auth/me")).data.user;try{const b=await U.get("/users/me");(f=b==null?void 0:b.data)!=null&&f.avatarUrl&&(v={...v,avatarUrl:b.data.avatarUrl})}catch{}s({type:oe.LOAD_USER_SUCCESS,payload:{user:v}})}catch(S){console.error("Load user error:",S),s({type:oe.LOAD_USER_FAILURE}),i(null)}},c=async m=>{var f,S,v;try{s({type:oe.LOGIN_START});const b=await U.post("/auth/login",m),{user:N,token:y}=b.data;i(y);let L=N;try{const x=await U.get("/users/me");(f=x==null?void 0:x.data)!=null&&f.avatarUrl&&(L={...L,avatarUrl:x.data.avatarUrl})}catch{}return s({type:oe.LOGIN_SUCCESS,payload:{user:L,token:y}}),P.success(`Welcome back, ${N.firstName}!`),{success:!0}}catch(b){const N=((v=(S=b.response)==null?void 0:S.data)==null?void 0:v.error)||"Login failed";return s({type:oe.LOGIN_FAILURE}),P.error(N),{success:!1,error:N}}},l=async m=>{var f,S;try{const v=await U.post("/auth/register",m),{user:b,token:N}=v.data;return i(N),s({type:oe.LOGIN_SUCCESS,payload:{user:b,token:N}}),P.success(`Welcome to Faculty Reporting, ${b.firstName}!`),{success:!0}}catch(v){const b=((S=(f=v.response)==null?void 0:f.data)==null?void 0:S.error)||"Registration failed";return P.error(b),{success:!1,error:b}}},o=async()=>{try{await U.post("/auth/logout")}catch(m){console.error("Logout API error:",m)}i(null),s({type:oe.LOGOUT}),P.success("Logged out successfully")},d=async m=>{var f,S;try{const v=await U.post("/auth/change-password",m);return P.success(v.data.message),{success:!0}}catch(v){const b=((S=(f=v.response)==null?void 0:f.data)==null?void 0:S.error)||"Password change failed";return P.error(b),{success:!1,error:b}}},u=async m=>{var f,S;try{const v=await U.put(`/users/${a.user.id}`,m);return s({type:oe.UPDATE_USER,payload:v.data.user}),P.success("Profile updated successfully"),{success:!0}}catch(v){const b=((S=(f=v.response)==null?void 0:f.data)==null?void 0:S.error)||"Profile update failed";return P.error(b),{success:!1,error:b}}},h=m=>a.user?Array.isArray(m)?m.includes(a.user.role):a.user.role===m:!1,C=m=>{if(!a.user)return!1;const f={student:1,lecturer:2,program_leader:3,principal_lecturer:4,faculty_manager:5},S=f[a.user.role]||0,v=f[m]||0;return S>=v};p.useEffect(()=>{n()},[]);const w={user:a.user,token:a.token,isAuthenticated:a.isAuthenticated,isLoading:a.isLoading,login:c,register:l,logout:o,loadUser:n,changePassword:d,updateProfile:u,hasRole:h,hasPermission:C};return e(ir.Provider,{value:w,children:t})};const lr=({size:t=64,rounded:a=!0,alt:s="App Logo",className:i=""})=>{const n=typeof t=="number"?`${t}px`:t;return e("img",{src:nr,alt:s,width:n,height:n,className:`${a?"rounded-circle":""} ${i}`.trim(),style:{objectFit:"cover"}})},Za=()=>{const{user:t,isAuthenticated:a,logout:s}=ye(),i=at(),n=Fe(),[c,l]=p.useState(!1),[o,d]=p.useState(""),u=Jt();p.useEffect(()=>{let N=localStorage.getItem("theme");N||(N=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),d(N),document.documentElement.setAttribute("data-theme",N)},[]);const h=()=>{const b=o==="dark"?"light":"dark";d(b),document.documentElement.setAttribute("data-theme",b),localStorage.setItem("theme",b)},{data:C}=be("notifications-count",async()=>{const b=await T.dashboard.getNotificationsCount();return(b==null?void 0:b.data)??b},{enabled:a,refetchInterval:3e4}),{data:w}=be("pending-count",async()=>{const b=await T.dashboard.getPendingCount();return(b==null?void 0:b.data)??b},{enabled:a&&(t==null?void 0:t.role)!=="student",refetchInterval:3e4}),m=async()=>{await s(),n("/"),l(!1)},f=()=>{l(!1)},S=b=>i.pathname===b||i.pathname.startsWith(b+"/"),v=(C==null?void 0:C.unread)||0;return p.useEffect(()=>{if(!a)return;let b;try{b=new EventSource("/api/notifications/stream"),b.addEventListener("message",()=>{u.invalidateQueries("notifications-count"),u.invalidateQueries("notifications-page")})}catch{}return()=>{try{b&&b.close()}catch{}}},[a,u]),r(Qe,{bg:"dark",variant:"dark",expand:"lg",sticky:"top",expanded:c,onToggle:l,className:"custom-navbar",children:[r(st,{children:[r(Qe.Brand,{as:M,to:"/",onClick:f,className:"d-flex align-items-center gap-2",children:[e(lr,{size:28,rounded:!0,alt:"LUCT Logo",className:"navbar-logo"}),r("span",{className:"brand-text",children:[e("strong",{children:"LUCT"})," Faculty Reporting"]})]}),e(Qe.Toggle,{"aria-controls":"basic-navbar-nav"}),r(Qe.Collapse,{id:"basic-navbar-nav",children:[r(fe,{className:"me-auto d-lg-flex justify-content-lg-between",children:[e(fe.Link,{as:M,to:"/",onClick:f,className:`${S("/")&&i.pathname==="/"?"active":""} my-1 my-lg-0`,children:"Dashboard"}),a&&r(de,{children:[(t==null?void 0:t.role)!=="student"&&r(fe.Link,{as:M,to:"/pending",onClick:f,className:`${S("/pending")?"active":""} my-1 my-lg-0`,children:[e("i",{className:"bi bi-inbox me-1"}),"Pending",((w==null?void 0:w.count)||0)>0&&e(ue,{bg:"warning",text:"dark",className:"ms-1",children:w.count})]}),r(fe.Link,{as:M,to:"/notifications",onClick:f,className:`${S("/notifications")?"active":""} my-1 my-lg-0`,children:[e("i",{className:"bi bi-bell me-1"}),"Notifications",v>0&&e(ue,{bg:"danger",className:"ms-1",children:v})]}),r(fe.Link,{as:M,to:"/reports",onClick:f,className:`${S("/reports")?"active":""} my-1 my-lg-0`,children:["Reports",(t==null?void 0:t.role)==="student"&&v>0&&e(ue,{bg:"primary",className:"ms-1",children:v})]}),(t==null?void 0:t.role)==="student"&&e(fe.Link,{as:M,to:"/my-progress",onClick:f,className:S("/my-progress")?"active":"",children:"My Progress"}),(t==null?void 0:t.role)==="student"&&e(fe.Link,{as:M,to:"/my-classes",onClick:f,className:S("/my-classes")?"active":"",children:"My Classes"}),(t==null?void 0:t.role)==="student"&&e(fe.Link,{as:M,to:"/monitoring",onClick:f,className:S("/monitoring")?"active":"",children:"Monitoring"}),(t==null?void 0:t.role)==="student"&&e(fe.Link,{as:M,to:"/rating",onClick:f,className:S("/rating")?"active":"",children:"Rating"}),(t==null?void 0:t.role)==="lecturer"&&r(W,{title:"Lecturer",id:"lecturer-dropdown",children:[r(W.Item,{as:M,to:"/reports",onClick:f,active:S("/reports"),children:[e("i",{className:"bi bi-file-text me-2"}),"Reports"]}),r(W.Item,{as:M,to:"/lecturer/classes",onClick:f,active:S("/lecturer/classes"),children:[e("i",{className:"bi bi-journal-text me-2"}),"Classes"]}),r(W.Item,{as:M,to:"/lecturer/monitoring",onClick:f,active:S("/lecturer/monitoring"),children:[e("i",{className:"bi bi-activity me-2"}),"Monitoring"]}),r(W.Item,{as:M,to:"/lecturer/rating",onClick:f,active:S("/lecturer/rating"),children:[e("i",{className:"bi bi-star-half me-2"}),"Rating"]}),r(W.Item,{as:M,to:"/reports/lecturer/new",onClick:f,children:[e("i",{className:"bi bi-journal-plus me-2"}),"New Lecturer Report"]}),r(W.Item,{as:M,to:"/analytics",onClick:f,active:S("/analytics"),children:[e("i",{className:"bi bi-graph-up me-2"}),"Analytics"]})]}),(t==null?void 0:t.role)==="principal_lecturer"&&r(W,{title:"PRL",id:"prl-dropdown",children:[r(W.Item,{as:M,to:"/prl/courses",onClick:f,active:S("/prl/courses"),children:[e("i",{className:"bi bi-journal-text me-2"}),"Courses"]}),r(W.Item,{as:M,to:"/reports",onClick:f,active:S("/reports"),children:[e("i",{className:"bi bi-file-text me-2"}),"Reports"]}),r(W.Item,{as:M,to:"/prl/monitoring",onClick:f,active:S("/prl/monitoring"),children:[e("i",{className:"bi bi-activity me-2"}),"Monitoring"]}),r(W.Item,{as:M,to:"/prl/rating",onClick:f,active:S("/prl/rating"),children:[e("i",{className:"bi bi-star-half me-2"}),"Rating"]}),r(W.Item,{as:M,to:"/prl/classes",onClick:f,active:S("/prl/classes"),children:[e("i",{className:"bi bi-collection me-2"}),"Classes"]})]}),(t==null?void 0:t.role)==="program_leader"&&r(W,{title:"PL",id:"pl-dropdown",children:[r(W.Item,{as:M,to:"/pl/courses",onClick:f,active:S("/pl/courses"),children:[e("i",{className:"bi bi-journal-text me-2"}),"Courses"]}),r(W.Item,{as:M,to:"/admin/assign-modules",onClick:f,active:S("/admin/assign-modules"),children:[e("i",{className:"bi bi-diagram-3 me-2"}),"Assign Modules"]}),r(W.Item,{as:M,to:"/reports",onClick:f,active:S("/reports"),children:[e("i",{className:"bi bi-file-text me-2"}),"Reports"]}),r(W.Item,{as:M,to:"/pl/monitoring",onClick:f,active:S("/pl/monitoring"),children:[e("i",{className:"bi bi-activity me-2"}),"Monitoring"]}),r(W.Item,{as:M,to:"/pl/classes",onClick:f,active:S("/pl/classes"),children:[e("i",{className:"bi bi-collection me-2"}),"Classes"]}),r(W.Item,{as:M,to:"/admin/assign-modules",onClick:f,active:S("/admin/assign-modules"),children:[e("i",{className:"bi bi-clipboard-check me-2"}),"Assign Classes"]}),r(W.Item,{as:M,to:"/pl/lectures",onClick:f,active:S("/pl/lectures"),children:[e("i",{className:"bi bi-people me-2"}),"Lectures"]}),r(W.Item,{as:M,to:"/pl/rating",onClick:f,active:S("/pl/rating"),children:[e("i",{className:"bi bi-star-half me-2"}),"Rating"]})]}),(t==null?void 0:t.role)==="faculty_manager"&&r(W,{title:"Manager",id:"fm-dropdown",children:[r(W.Item,{as:M,to:"/reports",onClick:f,active:S("/reports"),children:[e("i",{className:"bi bi-file-text me-2"}),"Reports"]}),r(W.Item,{as:M,to:"/analytics",onClick:f,active:S("/analytics"),children:[e("i",{className:"bi bi-graph-up me-2"}),"Analytics"]}),r(W.Item,{as:M,to:"/users",onClick:f,active:S("/users"),children:[e("i",{className:"bi bi-people me-2"}),"Users"]})]}),((t==null?void 0:t.role)==="program_leader"||(t==null?void 0:t.role)==="principal_lecturer"||(t==null?void 0:t.role)==="faculty_manager"||(t==null?void 0:t.role)==="admin")&&r(W,{title:"Admin Tools",id:"admintools-dropdown",children:[r(W.Item,{as:M,to:"/analytics",onClick:f,active:S("/analytics"),children:[e("i",{className:"bi bi-graph-up me-2"}),"Analytics"]}),r(W.Item,{as:M,to:"/users",onClick:f,active:S("/users"),children:[e("i",{className:"bi bi-people me-2"}),"User Management"]}),(t==null?void 0:t.role)==="admin"&&r(W.Item,{as:M,to:"/admin/audit",onClick:f,active:S("/admin/audit"),children:[e("i",{className:"bi bi-clipboard-data me-2"}),"Audit Logs"]})]})]})]}),e(fe,{className:"ms-auto",children:a?r(W,{title:r("span",{className:"d-inline-flex align-items-center",children:[t!=null&&t.avatarUrl?e("img",{src:t.avatarUrl,alt:"Avatar",className:"rounded-circle me-2",style:{width:24,height:24,objectFit:"cover"},onError:b=>{b.currentTarget.onerror=null,b.currentTarget.src="/default-avatar.svg"}}):e("i",{className:"bi bi-person-circle me-1"}),t==null?void 0:t.firstName," ",t==null?void 0:t.lastName,(t==null?void 0:t.role)&&e("span",{className:"badge bg-secondary text-uppercase ms-2",style:{fontSize:"0.6rem"},children:String(t.role).replace("_"," ")}),v>0&&e(ue,{bg:"danger",className:"ms-2",children:v})]}),id:"user-dropdown",align:"end",children:[r(W.Item,{as:M,to:"/profile",onClick:f,children:[e("i",{className:"bi bi-person me-2"}),"Profile"]}),r(W.Item,{onClick:()=>{n("/reports/create"),f()},children:[e("i",{className:"bi bi-plus-circle me-2"}),"Create Report"]}),v>0&&r(de,{children:[e(W.Divider,{}),r(W.Item,{disabled:!0,children:[e("i",{className:"bi bi-bell me-2"}),v," New Notification",v>1?"s":""]})]}),e(W.Divider,{}),r(W.Item,{onClick:m,children:[e("i",{className:"bi bi-box-arrow-right me-2"}),"Logout"]})]}):r(de,{children:[e(fe.Link,{as:M,to:"/login",onClick:f,className:S("/login")?"active":"",children:"Login"}),e(fe.Link,{as:M,to:"/register",onClick:f,className:S("/register")?"active":"",children:"Register"})]})})]}),e("div",{className:"d-lg-none ms-auto me-2 my-2",children:e("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:h,"aria-label":"Toggle theme",children:e("i",{className:`bi ${o==="dark"?"bi-sun":"bi-moon"}`})})})]}),e("div",{className:"d-none d-lg-block me-3",children:e("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:h,"aria-label":"Toggle theme",children:e("i",{className:`bi ${o==="dark"?"bi-sun":"bi-moon"}`})})})]})},ee=({children:t,roles:a})=>{const{isAuthenticated:s,user:i}=ye(),n=at();return s?a&&i&&!a.includes(i.role)?e(At,{to:"/",replace:!0}):t:e(At,{to:"/login",replace:!0,state:{from:n}})},_t=()=>e("div",{className:"spinner-wrap",children:e("div",{className:"spinner-border text-primary",role:"status",children:e("span",{className:"visually-hidden",children:"Loading..."})})}),ve=({title:t,value:a,subtitle:s="",icon:i="",color:n="primary",variant:c="default"})=>{const l=c==="hero";return e("div",{className:`card mb-3 ${l?"card-modern":""}`,children:e("div",{className:"card-body",children:r("div",{className:"d-flex align-items-center",children:[i&&e("i",{className:`bi ${i} me-3 text-${n}`,style:{fontSize:l?28:18}}),r("div",{children:[e("div",{className:"small text-muted",children:t}),e("div",{className:l?"display-6 fw-bold mb-0":"fs-4",children:a}),s&&e("div",{className:"text-muted small mt-1",children:s})]})]})})})},Xa=t=>{switch((t||"").toLowerCase()){case"approved":return"success";case"rejected":return"danger";case"submitted":return"warning";default:return"secondary"}},es=({reports:t=[]})=>r("div",{className:"card mb-3",children:[r("div",{className:"card-header d-flex align-items-center",children:[e("i",{className:"bi bi-clock-history me-2"}),"Recent Reports"]}),e("div",{className:"card-body",children:!Array.isArray(t)||t.length===0?e("div",{className:"text-muted",children:"No recent reports"}):t.map(a=>r("div",{className:"d-flex align-items-center py-2 border-bottom",children:[e("div",{className:"me-3",children:e("div",{className:"avatar-circle bg-primary text-white d-inline-flex align-items-center justify-content-center",children:e("i",{className:"bi bi-file-earmark-text"})})}),r("div",{className:"flex-grow-1",children:[r("div",{className:"fw-semibold d-flex align-items-center gap-2",children:[e(M,{to:`/reports/${a.id}`,className:"text-decoration-none",children:a.title||"Untitled report"}),(a.status||"").toLowerCase()==="draft"&&e("span",{className:"badge bg-secondary",children:"Draft"}),(a.status||"").toLowerCase()==="reviewed"&&e("span",{className:"badge bg-info text-dark",children:"Reviewed"}),(a.status||"").toLowerCase()==="submitted"&&e("span",{className:"badge bg-warning text-dark",children:"Submitted"}),(a.status||"").toLowerCase()==="approved"&&e("span",{className:"badge bg-success",children:"Approved"}),(a.status||"").toLowerCase()==="rejected"&&e("span",{className:"badge bg-danger",children:"Rejected"})]}),e("div",{className:"text-muted small",children:a.course_name?a.course_name:"General"})]}),r("div",{className:"d-flex align-items-center gap-3",children:[a.status&&(a.status||"").toLowerCase()!=="draft"&&e("span",{className:`badge bg-${Xa(a.status)}`,children:a.status}),a.created_at&&e("small",{className:"text-muted",children:new Date(a.created_at).toLocaleDateString()})]})]},a.id))})]}),ts=({userRole:t})=>r("div",{className:"card mb-3",children:[e("div",{className:"card-header",children:"Quick Actions"}),e("div",{className:"card-body",children:r("div",{className:"quick-tiles",children:[t!=="student"?r(M,{to:"/reports/lecturer/new",className:"tile tile-primary",children:[e("i",{className:"bi bi-journal-plus"}),r("div",{children:[e("div",{className:"tile-title",children:"New Lecturer Report"}),e("div",{className:"tile-sub",children:"Submit your lecture details"})]})]}):r(M,{to:"/reports/create",className:"tile tile-primary",children:[e("i",{className:"bi bi-plus-circle"}),r("div",{children:[e("div",{className:"tile-title",children:"Create Report"}),e("div",{className:"tile-sub",children:"Start a new submission"})]})]}),r(M,{to:"/reports",className:"tile tile-secondary",children:[e("i",{className:"bi bi-file-text"}),r("div",{children:[e("div",{className:"tile-title",children:"My Reports"}),e("div",{className:"tile-sub",children:"View and manage"})]})]}),t==="student"&&r(M,{to:"/my-progress",className:"tile tile-success",children:[e("i",{className:"bi bi-graph-up-arrow"}),r("div",{children:[e("div",{className:"tile-title",children:"My Progress"}),e("div",{className:"tile-sub",children:"Performance insights"})]})]})]})})]}),rs=()=>{var d,u;const{data:t,isLoading:a,error:s,refetch:i,isFetching:n}=be("dashboard-notifications",async()=>{const h=await T.dashboard.getNotifications();return(h==null?void 0:h.data)??h},{refetchInterval:3e4}),c=(t==null?void 0:t.notifications)||[],l=c.filter(h=>!h.read).length,o=async()=>{var h,C;try{await T.dashboard.markAllNotificationsRead(),await i(),P.success("All notifications marked as read")}catch(w){P.error(((C=(h=w==null?void 0:w.response)==null?void 0:h.data)==null?void 0:C.error)||"Failed to mark all as read")}};return r("div",{className:"card",children:[r("div",{className:"card-header d-flex align-items-center justify-content-between",children:[r("div",{className:"d-flex align-items-center gap-2",children:[e("span",{children:"Notifications"}),l>0&&e("span",{className:"badge bg-danger",title:"Unread",children:l})]}),r("div",{className:"d-flex align-items-center gap-2",children:[e("span",{className:"badge bg-secondary",title:"Total shown",children:c.length}),e("button",{className:"btn btn-sm btn-outline-success",onClick:o,disabled:a||n||l===0,children:e("i",{className:"bi bi-check2-all"})}),e(M,{to:"/notifications",className:"btn btn-sm btn-outline-primary",children:"View all"})]})]}),r("div",{className:"card-body",children:[a&&e("div",{className:"text-muted",children:"Loading notifications..."}),s&&e("div",{className:"alert alert-danger",children:((u=(d=s==null?void 0:s.response)==null?void 0:d.data)==null?void 0:u.error)||"Failed to load notifications"}),!a&&!s&&c.length===0&&e("div",{className:"text-muted",children:"No notifications."}),!a&&!s&&c.length>0&&e("div",{className:"list-group list-group-flush",children:c.map(h=>r("div",{className:`list-group-item d-flex align-items-start gap-3 ${h.read?"":"bg-light"}`,children:[e("div",{className:"text-primary",children:h.type==="feedback"?e("i",{className:"bi bi-chat-left-text"}):e("i",{className:"bi bi-file-earmark-text"})}),r("div",{className:"flex-grow-1",children:[e("div",{className:"fw-semibold",children:h.title||"Notification"}),e("div",{className:"text-muted small",children:h.message})]}),e("div",{className:"text-nowrap small text-muted",children:h.created_at?new Date(h.created_at).toLocaleString():""})]},`${h.type}-${h.id}`))})]})]})},cr="label";function $t(t,a){typeof t=="function"?t(a):t&&(t.current=a)}function as(t,a){const s=t.options;s&&a&&Object.assign(s,a)}function or(t,a){t.labels=a}function dr(t,a){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:cr;const i=[];t.datasets=a.map(n=>{const c=t.datasets.find(l=>l[s]===n[s]);return!c||!n.data||i.includes(c)?{...n}:(i.push(c),Object.assign(c,n),c)})}function ss(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cr;const s={labels:[],datasets:[]};return or(s,t.labels),dr(s,t.datasets,a),s}function ns(t,a){const{height:s=150,width:i=300,redraw:n=!1,datasetIdKey:c,type:l,data:o,options:d,plugins:u=[],fallbackContent:h,updateMode:C,...w}=t,m=p.useRef(null),f=p.useRef(null),S=()=>{m.current&&(f.current=new Ue(m.current,{type:l,data:ss(o,c),options:d&&{...d},plugins:u}),$t(a,f.current))},v=()=>{$t(a,null),f.current&&(f.current.destroy(),f.current=null)};return p.useEffect(()=>{!n&&f.current&&d&&as(f.current,d)},[n,d]),p.useEffect(()=>{!n&&f.current&&or(f.current.config.data,o.labels)},[n,o.labels]),p.useEffect(()=>{!n&&f.current&&o.datasets&&dr(f.current.config.data,o.datasets,c)},[n,o.datasets]),p.useEffect(()=>{f.current&&(n?(v(),setTimeout(S)):f.current.update(C))},[n,d,o.labels,o.datasets,C]),p.useEffect(()=>{f.current&&(v(),setTimeout(S))},[l]),p.useEffect(()=>(S(),()=>v()),[]),te.createElement("canvas",{ref:m,role:"img",height:s,width:i,...w},h)}const is=p.forwardRef(ns);function xt(t,a){return Ue.register(a),p.forwardRef((s,i)=>te.createElement(is,{...s,ref:i,type:t}))}const Rt=xt("line",vr),ot=xt("bar",br),ls=xt("pie",yr);Ue.register(gt,vt,bt,yt,Nt,qt);const cs={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!0,backgroundColor:"rgba(15, 23, 42, 0.9)",borderColor:"rgba(255,255,255,0.12)",borderWidth:1,titleColor:"#fff",bodyColor:"#e5e7eb",displayColors:!1,callbacks:{label:t=>` ${t.parsed.y}`}}},elements:{point:{radius:0,hitRadius:6,hoverRadius:4},line:{tension:.35}},scales:{x:{grid:{display:!1},ticks:{display:!1}},y:{grid:{display:!1},ticks:{display:!1}}}};function jt({label:t="Activity",series:a=[]}){let s="rgba(13,110,253,1)",i="rgba(13,110,253,0.20)";try{const o=(getComputedStyle(document.documentElement).getPropertyValue("--brand")||"").trim();o&&(s=o,i=o.startsWith("#")?`${o}33`:"rgba(13,110,253,0.20)")}catch{}const c={labels:a.map((l,o)=>`${o+1}`),datasets:[{data:a,borderColor:s,backgroundColor:i,fill:!0,borderWidth:2}]};return e("div",{style:{height:140},children:e(Rt,{data:c,options:cs,"aria-label":t,role:"img"})})}const os=()=>{const{isAuthenticated:t,user:a}=ye(),{data:s,isLoading:i,error:n}=be("dashboard-public",T.dashboard.getPublic,{refetchInterval:6e4,select:C=>(C==null?void 0:C.data)??C,onError:()=>{}}),{data:c}=be(["reports-drafts",a==null?void 0:a.id],async()=>{const C=await T.reports.getAll({status:"draft",limit:5,page:1});return(C==null?void 0:C.data)??C},{enabled:t&&(a==null?void 0:a.role)==="student"}),{data:l,isLoading:o,error:d}=be("dashboard-personal",T.dashboard.getPersonal,{enabled:t,refetchInterval:3e4,select:C=>(C==null?void 0:C.data)??C,onError:()=>{}});return i||t&&o?e(_t,{}):r(st,{fluid:!0,className:"dashboard-container",children:[r("div",{className:"dashboard-header mb-4",children:[r("h2",{children:[e("i",{className:"bi bi-speedometer2 me-2"}),t?"Personal Dashboard":"Faculty Reporting Dashboard"]}),e("p",{className:"text-muted",children:t?"Welcome back! Here's your personalized overview.":"Monitor academic reporting and faculty activities."})]}),t?(()=>{var C,w,m,f,S,v,b,N,y,L,x,F,Q,E,$;return r(de,{children:[d&&e(z,{className:"mb-3",children:e(k,{children:e(Z,{variant:"danger",children:((w=(C=d==null?void 0:d.response)==null?void 0:C.data)==null?void 0:w.error)||"Failed to load personal dashboard"})})}),e(z,{className:"mb-4",children:e(k,{children:r(Z,{variant:"success",className:"d-flex align-items-center",children:[e("i",{className:"bi bi-person-check-fill me-3 fs-4"}),r("div",{children:[r("h5",{className:"mb-0",children:["Welcome back, ",a==null?void 0:a.firstName," ",a==null?void 0:a.lastName,"!"]}),r("small",{children:["Role: ",(m=a==null?void 0:a.role)==null?void 0:m.replace("_"," ").toUpperCase()]})]})]})})}),e(z,{className:"mb-4",children:(a==null?void 0:a.role)==="student"?r(de,{children:[e(k,{md:3,children:e(ve,{title:"My Reports",value:((f=l==null?void 0:l.personalStats)==null?void 0:f.my_reports)||0,icon:"bi-file-text",color:"primary",variant:"hero"})}),e(k,{md:3,children:e(ve,{title:"Pending Reports",value:((S=l==null?void 0:l.personalStats)==null?void 0:S.pending_reports)||0,icon:"bi-clock",color:"warning",variant:"hero"})}),e(k,{md:3,children:e(ve,{title:"Enrolled Courses",value:((v=l==null?void 0:l.personalStats)==null?void 0:v.enrolled_courses)||0,icon:"bi-book",color:"info",variant:"hero"})}),e(k,{md:3,children:e(ve,{title:"Avg Rating Given",value:(b=l==null?void 0:l.personalStats)!=null&&b.avg_class_rating?parseFloat(l.personalStats.avg_class_rating).toFixed(1):"N/A",icon:"bi-star",color:"success",variant:"hero"})})]}):r(de,{children:[e(k,{md:3,children:e(ve,{title:"My Courses",value:((N=l==null?void 0:l.personalStats)==null?void 0:N.my_courses)||0,icon:"bi-book",color:"primary",variant:"hero"})}),e(k,{md:3,children:e(ve,{title:"My Reports",value:((y=l==null?void 0:l.personalStats)==null?void 0:y.my_reports)||0,icon:"bi-file-text",color:"info",variant:"hero"})}),e(k,{md:3,children:e(ve,{title:"Total Students",value:((L=l==null?void 0:l.personalStats)==null?void 0:L.total_students)||0,icon:"bi-people",color:"success",variant:"hero"})}),e(k,{md:3,children:e(ve,{title:"Avg Rating Received",value:(x=l==null?void 0:l.personalStats)!=null&&x.avg_received_rating?parseFloat(l.personalStats.avg_received_rating).toFixed(1):"N/A",icon:"bi-star-fill",color:"warning",variant:"hero"})})]})}),e(z,{className:"mb-4",children:e(k,{md:12,children:r(_,{children:[e(_.Header,{children:r("h6",{className:"mb-0",children:[e("i",{className:"bi bi-activity me-2"}),"My Activity (Recent)"]})}),e(_.Body,{children:e(jt,{label:"My reports trend",series:(((F=l==null?void 0:l.trends)==null?void 0:F.my_reports_recent)??((Q=l==null?void 0:l.trends)==null?void 0:Q.reports)??[]).slice(0,12)})})]})})}),r(z,{children:[r(k,{lg:8,children:[e(es,{reports:(l==null?void 0:l.recentReports)||[]}),e(ts,{userRole:a==null?void 0:a.role})]}),r(k,{lg:4,children:[e(rs,{}),(a==null?void 0:a.role)==="student"&&r(_,{className:"mt-3",children:[e(_.Header,{children:r("h6",{className:"mb-0",children:[e("i",{className:"bi bi-file-earmark-diff me-2"}),"My Drafts"]})}),r(_.Body,{children:[Array.isArray(c==null?void 0:c.reports)&&c.reports.length>0?e("div",{className:"list-group list-group-flush",children:c.reports.map(D=>r("div",{className:"list-group-item d-flex align-items-center justify-content-between",children:[r("div",{className:"me-2",children:[e("div",{className:"fw-semibold",children:D.title||"Untitled draft"}),e("small",{className:"text-muted",children:new Date(D.created_at).toLocaleDateString()})]}),e(M,{to:`/reports/${D.id}`,className:"btn btn-sm btn-outline-secondary",children:"Open"})]},D.id))}):e("div",{className:"text-muted",children:"No drafts"}),e("div",{className:"mt-2 text-end",children:e(M,{to:"/reports?status=draft",className:"btn btn-sm btn-outline-primary",children:"View all drafts"})})]})]}),((E=l==null?void 0:l.pendingActions)==null?void 0:E.length)>0&&r(_,{className:"mt-3",children:[e(_.Header,{children:r("h6",{children:[e("i",{className:"bi bi-exclamation-triangle me-2"}),"Pending Actions"]})}),e(_.Body,{children:l.pendingActions.map((D,I)=>r("div",{className:"d-flex align-items-center mb-2 p-2 bg-light rounded",children:[r("div",{className:"flex-grow-1",children:[e("div",{className:"fw-bold",children:D.title}),r("small",{className:"text-muted",children:["From: ",D.first_name," ",D.last_name,D.course_name&&`  ${D.course_name}`]})]}),e(H,{size:"sm",variant:"outline-primary",as:M,to:`/reports/${D.id}`,children:"Review"})]},I))})]}),(($=l==null?void 0:l.courses)==null?void 0:$.length)>0&&r(_,{className:"mt-3",children:[e(_.Header,{children:r("h6",{children:[e("i",{className:"bi bi-book me-2"}),"My Courses"]})}),e(_.Body,{children:l.courses.map((D,I)=>r("div",{className:"course-item mb-2 p-2 border rounded",children:[e("div",{className:"fw-bold",children:D.course_name}),r("div",{className:"text-muted small",children:[D.course_code,"  ",D.stream_name,D.student_count&&`  ${D.student_count} students`,D.avg_rating&&`  ${parseFloat(D.avg_rating).toFixed(1)} `]})]},I))})]})]})]})]})})():(()=>{var C,w,m,f,S,v,b,N;return r(de,{children:[n&&e(z,{className:"mb-3",children:e(k,{children:e(Z,{variant:"danger",children:((w=(C=n==null?void 0:n.response)==null?void 0:C.data)==null?void 0:w.error)||"Failed to load public dashboard"})})}),e(z,{className:"mb-4",children:e(k,{children:r(Z,{variant:"info",className:"text-center",children:[e("h4",{children:"Welcome to LUCT Faculty Reporting System"}),e("p",{children:"A centralized platform for students, lecturers, and faculty management to submit reports, provide feedback, and monitor academic progress."}),!t&&r("div",{className:"mt-3",children:[e(H,{as:M,to:"/login",variant:"primary",className:"me-2",children:"Login"}),e(H,{as:M,to:"/register",variant:"outline-primary",children:"Register"})]})]})})}),r(z,{className:"mb-4",children:[e(k,{md:3,className:"mb-3 mb-md-0",children:e(ve,{title:"Total Users",value:(((m=s==null?void 0:s.generalStats)==null?void 0:m.total_users)??(s==null?void 0:s.total_users))||0,icon:"bi-people",color:"primary",variant:"hero"})}),e(k,{md:3,className:"mb-3 mb-md-0",children:e(ve,{title:"Students",value:(((f=s==null?void 0:s.generalStats)==null?void 0:f.total_students)??(s==null?void 0:s.total_students))||0,icon:"bi-mortarboard",color:"success",variant:"hero"})}),e(k,{md:3,className:"mb-3 mb-md-0",children:e(ve,{title:"Lecturers",value:(((S=s==null?void 0:s.generalStats)==null?void 0:S.total_lecturers)??(s==null?void 0:s.total_lecturers))||0,icon:"bi-person-workspace",color:"info",variant:"hero"})}),e(k,{md:3,children:e(ve,{title:"Courses",value:(((v=s==null?void 0:s.generalStats)==null?void 0:v.total_courses)??(s==null?void 0:s.total_courses))||0,icon:"bi-book",color:"warning",variant:"hero"})})]}),e(z,{className:"mb-4",children:e(k,{md:12,children:r(_,{children:[e(_.Header,{children:r("h6",{className:"mb-0",children:[e("i",{className:"bi bi-graph-up me-2"}),"Overall Activity"]})}),e(_.Body,{children:e(jt,{label:"Reports trend",series:(((b=s==null?void 0:s.trends)==null?void 0:b.reports_weekly)??((N=s==null?void 0:s.trends)==null?void 0:N.reports)??[]).slice(0,12)})})]})})}),e(z,{className:"mb-4",children:e(k,{children:r(_,{children:[e(_.Header,{children:r("h5",{children:[e("i",{className:"bi bi-bar-chart me-2"}),"Academic Streams"]})}),e(_.Body,{children:e(z,{children:Array.isArray(s==null?void 0:s.courseStats)&&s.courseStats.length>0?s.courseStats.map((y,L)=>e(k,{md:4,className:"mb-3",children:e(_,{className:"h-100 border-left-accent",children:r(_.Body,{children:[e("h6",{children:y.stream_name}),r("div",{className:"text-muted small",children:[r("div",{children:["Courses: ",y.course_count]}),r("div",{children:["Students: ",y.enrolled_students]})]})]})})},L)):e(k,{children:e("div",{className:"text-muted",children:"No stream statistics available"})})})})]})})}),e(z,{children:e(k,{children:r(_,{children:[e(_.Header,{children:r("h5",{children:[e("i",{className:"bi bi-activity me-2"}),"Recent Activity"]})}),e(_.Body,{children:Array.isArray(s==null?void 0:s.recentActivity)&&s.recentActivity.length>0?e("div",{className:"activity-list",children:s.recentActivity.map((y,L)=>r("div",{className:"activity-item d-flex align-items-center mb-2",children:[e("div",{className:"activity-icon me-3",children:e("i",{className:"bi bi-file-text text-primary"})}),r("div",{className:"flex-grow-1",children:[r("div",{children:["New report from ",y.user_role,y.course_name&&` in ${y.course_name}`]}),e("small",{className:"text-muted",children:new Date(y.created_at).toLocaleDateString()})]})]},L))}):e("p",{className:"text-muted",children:"No recent activity"})})]})})}),r(z,{className:"mt-4",children:[e(k,{md:6,className:"mb-3 mb-md-0",children:r(_,{children:[e(_.Header,{children:r("h6",{className:"mb-0",children:[e("i",{className:"bi bi-people me-2"}),"Latest Users"]})}),e(_.Body,{children:Array.isArray(s==null?void 0:s.latest_users)&&s.latest_users.length>0?e("div",{className:"list-group list-group-flush",children:s.latest_users.map((y,L)=>r("div",{className:"list-group-item d-flex align-items-center justify-content-between",children:[r("div",{className:"d-flex align-items-center gap-3",children:[e("div",{className:"avatar-circle bg-secondary text-white d-inline-flex align-items-center justify-content-center",children:(y.username||"?").charAt(0).toUpperCase()}),r("div",{children:[e("div",{className:"fw-semibold",children:y.username}),e("div",{className:"text-muted small",children:y.email})]})]}),r("div",{className:"d-flex align-items-center gap-3",children:[y.role&&e("span",{className:"badge bg-secondary text-uppercase",children:y.role}),e("small",{className:"text-muted",children:y.created_at?new Date(y.created_at).toLocaleDateString():""})]})]},L))}):e("div",{className:"text-muted",children:"No recent users"})})]})}),e(k,{md:6,children:r(_,{children:[e(_.Header,{children:r("h6",{className:"mb-0",children:[e("i",{className:"bi bi-file-earmark-text me-2"}),"Latest Reports"]})}),e(_.Body,{children:Array.isArray(s==null?void 0:s.latest_reports)&&s.latest_reports.length>0?e("div",{className:"list-group list-group-flush",children:s.latest_reports.map((y,L)=>r("div",{className:"list-group-item d-flex align-items-center justify-content-between",children:[r("div",{className:"d-flex align-items-center gap-3",children:[e("div",{className:"avatar-circle bg-primary text-white d-inline-flex align-items-center justify-content-center",children:e("i",{className:"bi bi-file-earmark-text"})}),r("div",{children:[r("div",{className:"fw-semibold d-flex align-items-center gap-2",children:[y.title||"Untitled report",(y.status||"").toLowerCase()==="draft"&&e("span",{className:"badge bg-secondary",children:"Draft"}),(y.status||"").toLowerCase()==="reviewed"&&e("span",{className:"badge bg-info text-dark",children:"Reviewed"}),(y.status||"").toLowerCase()==="submitted"&&e("span",{className:"badge bg-warning text-dark",children:"Submitted"}),(y.status||"").toLowerCase()==="approved"&&e("span",{className:"badge bg-success",children:"Approved"}),(y.status||"").toLowerCase()==="rejected"&&e("span",{className:"badge bg-danger",children:"Rejected"})]}),e("div",{className:"text-muted small",children:y.course_name||"General"})]})]}),r("div",{className:"d-flex align-items-center gap-3",children:[y.status&&(y.status||"").toLowerCase()!=="draft"&&e("span",{className:`badge bg-${(y.status||"").toLowerCase()==="approved"?"success":(y.status||"").toLowerCase()==="rejected"?"danger":(y.status||"").toLowerCase()==="submitted"?"warning":"secondary"}`,children:y.status}),e("small",{className:"text-muted",children:y.created_at?new Date(y.created_at).toLocaleDateString():""})]})]},L))}):e("div",{className:"text-muted",children:"No recent reports"})})]})})]})]})})()]})},ur=({title:t,subtitle:a,children:s,footer:i})=>e(st,{className:"auth-container",children:e(z,{className:"justify-content-center w-100 mx-0",children:e(k,{md:6,lg:5,xl:4,className:"px-2",children:e(_,{className:"auth-card shadow-lg border-0",children:r(_.Body,{className:"p-5",children:[(t||a)&&r("div",{className:"text-center mb-4",children:[e(lr,{size:64,className:"auth-logo mb-3"}),t&&e("h2",{className:"auth-title mb-1",children:t}),a&&e("p",{className:"text-muted mb-0",children:a})]}),s,i&&e("div",{className:"mt-4 text-center",children:i})]})})})})});const ds=()=>{const{login:t,isAuthenticated:a,isLoading:s}=ye(),i=Fe(),n=at(),[c,l]=p.useState({username:"",password:""}),[o,d]=p.useState({}),[u,h]=p.useState(!1),[C,w]=p.useState(!1),[m,f]=p.useState(!1);p.useEffect(()=>{var N,y;if(a&&!s){const L=((y=(N=n.state)==null?void 0:N.from)==null?void 0:y.pathname)||"/";i(L,{replace:!0})}},[a,s,i,n]),p.useEffect(()=>{const N=localStorage.getItem("remember_username");N&&!c.username&&(l(y=>({...y,username:N})),f(!0))},[]);const S=N=>{const{name:y,value:L}=N.target;l(x=>({...x,[y]:L})),o[y]&&d(x=>({...x,[y]:""}))},v=()=>{const N={};return c.username.trim()||(N.username="Username or email is required"),c.password||(N.password="Password is required"),d(N),Object.keys(N).length===0},b=async N=>{var y,L,x,F;if(N.preventDefault(),!!v()){h(!0);try{const Q=await t(c);if(Q.success){m?localStorage.setItem("remember_username",c.username):localStorage.removeItem("remember_username");const E=((L=(y=n.state)==null?void 0:y.from)==null?void 0:L.pathname)||"/";i(E,{replace:!0})}else Q.message&&d(E=>({...E,form:Q.message}))}catch(Q){const E=((F=(x=Q==null?void 0:Q.response)==null?void 0:x.data)==null?void 0:F.error)||"Failed to sign in. Please check your credentials and try again.";d($=>({...$,form:E}))}finally{h(!1)}}};return s?e("div",{className:"auth-container d-flex justify-content-center align-items-center",children:e(se,{animation:"border",variant:"primary"})}):r(ur,{title:"Welcome Back",subtitle:"Sign in to your account",footer:r("p",{className:"mb-0",children:["Don't have an account?"," ",e(M,{to:"/register",className:"text-decoration-none",children:"Sign up here"})]}),children:[o.form&&e(Z,{variant:"danger",className:"py-2",role:"alert",children:o.form}),r(g,{onSubmit:b,noValidate:!0,children:[r(g.Group,{className:"mb-3",children:[r(g.Label,{children:[e("i",{className:"bi bi-person me-2"}),"Username or Email"]}),e(g.Control,{type:"text",name:"username",value:c.username,onChange:S,placeholder:"Enter your username or email",isInvalid:!!o.username,disabled:u,autoComplete:"username",inputMode:"email"}),e(g.Control.Feedback,{type:"invalid",children:o.username})]}),r(g.Group,{className:"mb-3",children:[r(g.Label,{children:[e("i",{className:"bi bi-lock me-2"}),"Password"]}),r(Ee,{children:[e(g.Control,{type:C?"text":"password",name:"password",value:c.password,onChange:S,placeholder:"Enter your password",isInvalid:!!o.password,disabled:u,autoComplete:"current-password"}),e(H,{variant:"outline-secondary",onClick:()=>w(N=>!N),tabIndex:-1,children:e("i",{className:`bi ${C?"bi-eye-slash":"bi-eye"}`})})]}),e(g.Control.Feedback,{type:"invalid",children:o.password})]}),r("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e(g.Check,{type:"checkbox",id:"rememberMe",label:"Remember me",checked:m,onChange:N=>f(N.target.checked),disabled:u}),e("span",{className:"small text-muted",children:"Use your assigned credentials"})]}),e(H,{variant:"primary",type:"submit",className:"w-100 mb-3",disabled:u,children:u?r(de,{children:[e(se,{size:"sm",className:"me-2"}),"Signing In..."]}):r(de,{children:[e("i",{className:"bi bi-box-arrow-in-right me-2"}),"Sign In"]})})]}),r(Z,{variant:"info",className:"small",children:[e("strong",{children:"Demo Accounts (Password: Password123):"}),e("br",{}),r("div",{className:"mt-2",children:[r("div",{children:[e("strong",{children:"Admin:"})," admin1 or admin1@example.com"]}),r("div",{children:[e("strong",{children:"Faculty Manager:"})," fm1 or fm1@example.com"]}),r("div",{children:[e("strong",{children:"Program Leader:"})," pl1 or pl1@example.com"]}),r("div",{children:[e("strong",{children:"Lecturer:"})," lecturer1 or lecturer1@example.com"]}),r("div",{children:[e("strong",{children:"Student:"})," student1 or student1@example.com"]})]})]})]})},us=()=>{const{register:t,isAuthenticated:a,isLoading:s}=ye(),i=Fe(),[n,c]=p.useState({username:"",email:"",password:"",confirmPassword:"",firstName:"",lastName:"",phone:"",role:"student"}),[l,o]=p.useState({}),[d,u]=p.useState(!1),[h,C]=p.useState(!1),[w,m]=p.useState(!1),[f,S]=p.useState("");p.useEffect(()=>{a&&!s&&i("/",{replace:!0})},[a,s,i]);const v=y=>{const{name:L,value:x}=y.target;c(F=>({...F,[L]:x})),l[L]&&o(F=>({...F,[L]:""}))},b=()=>{const y={};return n.username.trim()?n.username.length<3?y.username="Username must be at least 3 characters":/^[a-zA-Z0-9_]+$/.test(n.username)||(y.username="Username can only contain letters, numbers, and underscores"):y.username="Username is required",n.email.trim()?/\S+@\S+\.\S+/.test(n.email)||(y.email="Please enter a valid email address"):y.email="Email is required",n.password?n.password.length<6?y.password="Password must be at least 6 characters":/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(n.password)||(y.password="Password must contain at least one lowercase letter, one uppercase letter, and one number"):y.password="Password is required",n.confirmPassword?n.password!==n.confirmPassword&&(y.confirmPassword="Passwords do not match"):y.confirmPassword="Please confirm your password",n.firstName.trim()||(y.firstName="First name is required"),n.lastName.trim()||(y.lastName="Last name is required"),n.role||(y.role="Please select a role"),o(y),Object.keys(y).length===0},N=async y=>{var L,x;if(y.preventDefault(),!!b()){u(!0);try{const F=await t(n);F.success?i("/",{replace:!0}):F.message&&S(F.message)}catch(F){const Q=((x=(L=F==null?void 0:F.response)==null?void 0:L.data)==null?void 0:x.error)||"Registration failed. Please review your details and try again.";S(Q)}finally{u(!1)}}};return s?e("div",{className:"auth-container d-flex justify-content-center align-items-center",style:{minHeight:"80vh"},children:e(se,{animation:"border",variant:"primary"})}):r(ur,{title:"Create Account",subtitle:"Join the Faculty Reporting System",footer:r("p",{className:"mb-0",children:["Already have an account?"," ",e(M,{to:"/login",className:"text-decoration-none",children:"Sign in here"})]}),children:[f&&e(Z,{variant:"danger",className:"py-2",role:"alert",children:f}),r(g,{onSubmit:N,children:[r(z,{children:[e(k,{md:6,children:r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"First Name *"}),e(g.Control,{type:"text",name:"firstName",value:n.firstName,onChange:v,placeholder:"Enter first name",isInvalid:!!l.firstName,disabled:d,autoComplete:"given-name"}),e(g.Control.Feedback,{type:"invalid",children:l.firstName})]})}),e(k,{md:6,children:r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Last Name *"}),e(g.Control,{type:"text",name:"lastName",value:n.lastName,onChange:v,placeholder:"Enter last name",isInvalid:!!l.lastName,disabled:d,autoComplete:"family-name"}),e(g.Control.Feedback,{type:"invalid",children:l.lastName})]})})]}),r(g.Group,{className:"mb-3",children:[r(g.Label,{children:[e("i",{className:"bi bi-person me-2"}),"Username *"]}),e(g.Control,{type:"text",name:"username",value:n.username,onChange:v,placeholder:"Choose a username",isInvalid:!!l.username,disabled:d,autoComplete:"username"}),e(g.Control.Feedback,{type:"invalid",children:l.username}),e(g.Text,{className:"text-muted",children:"Only letters, numbers, and underscores allowed"})]}),r(g.Group,{className:"mb-3",children:[r(g.Label,{children:[e("i",{className:"bi bi-envelope me-2"}),"Email Address *"]}),e(g.Control,{type:"email",name:"email",value:n.email,onChange:v,placeholder:"Enter email address",isInvalid:!!l.email,disabled:d,autoComplete:"email"}),e(g.Control.Feedback,{type:"invalid",children:l.email})]}),r(g.Group,{className:"mb-3",children:[r(g.Label,{children:[e("i",{className:"bi bi-telephone me-2"}),"Phone Number (Optional)"]}),e(g.Control,{type:"tel",name:"phone",value:n.phone,onChange:v,placeholder:"Enter phone number",disabled:d,autoComplete:"tel"})]}),r(g.Group,{className:"mb-3",children:[r(g.Label,{children:[e("i",{className:"bi bi-person-badge me-2"}),"Role *"]}),r(g.Select,{name:"role",value:n.role,onChange:v,isInvalid:!!l.role,disabled:d,children:[e("option",{value:"",children:"Select your role"}),e("option",{value:"student",children:"Student"}),e("option",{value:"lecturer",children:"Lecturer"}),e("option",{value:"program_leader",children:"Program Leader"}),e("option",{value:"principal_lecturer",children:"Principal Lecturer"}),e("option",{value:"faculty_manager",children:"Faculty Manager"})]}),e(g.Control.Feedback,{type:"invalid",children:l.role})]}),r(z,{children:[e(k,{md:6,children:r(g.Group,{className:"mb-3",children:[r(g.Label,{children:[e("i",{className:"bi bi-lock me-2"}),"Password *"]}),r(Ee,{children:[e(g.Control,{type:h?"text":"password",name:"password",value:n.password,onChange:v,placeholder:"Create password",isInvalid:!!l.password,disabled:d,autoComplete:"new-password"}),e(H,{variant:"outline-secondary",onClick:()=>C(y=>!y),tabIndex:-1,children:e("i",{className:`bi ${h?"bi-eye-slash":"bi-eye"}`})})]}),e(g.Control.Feedback,{type:"invalid",children:l.password})]})}),e(k,{md:6,children:r(g.Group,{className:"mb-4",children:[r(g.Label,{children:[e("i",{className:"bi bi-lock-fill me-2"}),"Confirm Password *"]}),r(Ee,{children:[e(g.Control,{type:w?"text":"password",name:"confirmPassword",value:n.confirmPassword,onChange:v,placeholder:"Confirm password",isInvalid:!!l.confirmPassword,disabled:d,autoComplete:"new-password"}),e(H,{variant:"outline-secondary",onClick:()=>m(y=>!y),tabIndex:-1,children:e("i",{className:`bi ${w?"bi-eye-slash":"bi-eye"}`})})]}),e(g.Control.Feedback,{type:"invalid",children:l.confirmPassword})]})})]}),e(H,{variant:"primary",type:"submit",className:"w-100 mb-3",disabled:d,size:"lg",children:d?r(de,{children:[e(se,{size:"sm",className:"me-2"}),"Creating Account..."]}):r(de,{children:[e("i",{className:"bi bi-person-plus me-2"}),"Create Account"]})})]})]})};const hs=()=>{var K,V;const{user:t}=ye(),a=Fe(),[s,i]=Nr(),[n,c]=p.useState(()=>{const R=(B,G)=>{const X=parseInt(s.get(B));return Number.isFinite(X)&&X>0?X:G};return{page:R("page",1),limit:R("limit",10),status:s.get("status")||"",reportType:s.get("reportType")||"",search:s.get("search")||"",courseId:s.get("courseId")||"",streamId:s.get("streamId")||s.get("stream_id")||""}});p.useEffect(()=>{const R=new URLSearchParams;n.page&&n.page!==1&&R.set("page",String(n.page)),n.limit&&n.limit!==10&&R.set("limit",String(n.limit)),n.status&&R.set("status",n.status),n.reportType&&R.set("reportType",n.reportType),n.search&&R.set("search",n.search),n.courseId&&R.set("courseId",String(n.courseId)),n.streamId&&R.set("streamId",String(n.streamId)),i(R)},[n,i]);const[l,o]=p.useState([]),[d,u]=p.useState(!1),[h,C]=p.useState([]),[w,m]=p.useState(!1);p.useEffect(()=>{(async()=>{try{m(!0);const{data:B}=await T.users.getStreams(),G=Array.isArray(B==null?void 0:B.streams)?B.streams:[];C(G)}catch{}finally{m(!1)}})()},[]),p.useEffect(()=>{(async()=>{try{u(!0);const B=n.streamId?{stream_id:n.streamId}:void 0,{data:G}=await T.users.getAvailableCourses(B),X=Array.isArray(G==null?void 0:G.courses)?G.courses:Array.isArray(G)?G:[];o(X)}catch{}finally{u(!1)}})()},[n.streamId]);const{data:f,isLoading:S,refetch:v}=be(["reports",n],()=>T.reports.getAll(n),{keepPreviousData:!0,refetchOnWindowFocus:!1,select:R=>(R==null?void 0:R.data)??R}),b=["admin","faculty_manager","principal_lecturer","program_leader"].includes(t==null?void 0:t.role),N=async(R,B)=>{var G,X;try{await T.reports.moderate(R,B),P.success("Report updated"),v()}catch(ne){const ae=((X=(G=ne==null?void 0:ne.response)==null?void 0:G.data)==null?void 0:X.error)||"Failed to update report";P.error(ae)}},y=(R,B)=>{c(G=>({...G,[R]:B,page:1}))},L=R=>{c(B=>({...B,page:R}))},x=async()=>{try{const R={...n};R.streamId&&(R.stream_id=R.streamId,delete R.streamId);const B=await T.export.reportsExcel(R),G=`reports_${new Date().toISOString().split("T")[0]}.xlsx`;Ie(B.data,G),P.success("Reports exported to Excel successfully!")}catch{P.error("Failed to export reports")}},F=async()=>{try{const R={...n};R.streamId&&(R.stream_id=R.streamId,delete R.streamId);const B=await T.export.reportsPdf(R),G=`reports_${new Date().toISOString().split("T")[0]}.pdf`;Ie(B.data,G),P.success("Reports exported to PDF successfully!")}catch{P.error("Failed to export reports")}},Q=R=>{switch(R){case"submitted":return"primary";case"reviewed":return"info";case"approved":return"success";case"rejected":return"danger";case"draft":return"secondary";default:return"secondary"}},E=R=>R.replace("_"," ").split(" ").map(B=>B.charAt(0).toUpperCase()+B.slice(1)).join(" "),$=()=>{if(!(f!=null&&f.pagination))return null;const{page:R,pages:B}=f.pagination,G=[];G.push(e(Be.Prev,{onClick:()=>L(R-1),disabled:R===1},"prev"));for(let X=Math.max(1,R-2);X<=Math.min(B,R+2);X++)G.push(e(Be.Item,{active:X===R,onClick:()=>L(X),children:X},X));return G.push(e(Be.Next,{onClick:()=>L(R+1),disabled:R===B},"next")),e(Be,{className:"justify-content-center",children:G})};if(S&&!f)return e(_t,{});const D=(f==null?void 0:f.reports)||[],I=(f==null?void 0:f.pagination)||{};return r(st,{fluid:!0,className:"reports-container",children:[e(z,{className:"mb-4",children:e(k,{children:r("div",{className:"d-flex justify-content-between align-items-center",children:[r("div",{children:[r("h2",{children:[e("i",{className:"bi bi-file-text me-2"}),"Reports Management"]}),r("p",{className:"text-muted mb-0",children:[I.total||0," total reports"]}),r("div",{className:"mt-2 small d-flex gap-2 flex-wrap align-items-center",children:[e("span",{className:"text-muted me-1",children:"Legend:"}),e("span",{className:"badge bg-secondary",children:"Draft"}),e("span",{className:"badge bg-warning text-dark",children:"Submitted"}),e("span",{className:"badge bg-info text-dark",children:"Reviewed"}),e("span",{className:"badge bg-success",children:"Approved"}),e("span",{className:"badge bg-danger",children:"Rejected"})]}),(n.courseId||n.streamId)&&r("div",{className:"mt-2 d-flex gap-2 flex-wrap",children:[n.streamId&&r(ue,{bg:"secondary",children:["Stream: ",((K=h.find(R=>String(R.id)===String(n.streamId)))==null?void 0:K.stream_name)||n.streamId]}),n.courseId&&r(ue,{bg:"info",children:["Course: ",((V=l.find(R=>String(R.id)===String(n.courseId)))==null?void 0:V.course_name)||n.courseId]})]})]}),r("div",{children:[(t==null?void 0:t.role)==="lecturer"&&(n.reportType==="lecturer_report"?r(H,{variant:"outline-secondary",className:"me-2",onClick:()=>y("reportType",""),children:[e("i",{className:"bi bi-x-circle me-2"}),"Clear My Lecturer Reports"]}):r(H,{variant:"outline-info",className:"me-2",onClick:()=>y("reportType","lecturer_report"),children:[e("i",{className:"bi bi-funnel me-2"}),"My Lecturer Reports"]})),(t==null?void 0:t.role)!=="lecturer"&&r(H,{variant:"primary",as:M,to:"/reports/create",className:"me-2",children:[e("i",{className:"bi bi-plus-circle me-2"}),"Create Report"]}),(t==null?void 0:t.role)==="lecturer"&&r(H,{variant:"outline-primary",as:M,to:"/reports/lecturer/new",className:"me-2",children:[e("i",{className:"bi bi-journal-plus me-2"}),"New Lecturer Report"]}),r(ge,{as:Lt,children:[r(H,{variant:"outline-success",children:[e("i",{className:"bi bi-download me-2"}),"Export"]}),e(ge.Toggle,{split:!0,variant:"outline-success"}),r(ge.Menu,{align:"end",children:[r(ge.Item,{onClick:x,children:[e("i",{className:"bi bi-file-excel me-2"}),"Export to Excel"]}),r(ge.Item,{onClick:F,children:[e("i",{className:"bi bi-file-pdf me-2"}),"Export to PDF"]})]})]})]})]})})}),e(_,{className:"mb-4",children:r(_.Body,{children:[r(z,{className:"align-items-center",children:[e(k,{md:4,children:r(Ee,{children:[e(Ee.Text,{children:e("i",{className:"bi bi-search"})}),e(g.Control,{type:"text",placeholder:"Search reports...",value:n.search,onChange:R=>y("search",R.target.value)})]})}),e(k,{md:3,children:r(g.Select,{value:n.status,onChange:R=>y("status",R.target.value),children:[e("option",{value:"",children:"All Status"}),e("option",{value:"submitted",children:"Submitted"}),e("option",{value:"reviewed",children:"Reviewed"}),e("option",{value:"approved",children:"Approved"}),e("option",{value:"rejected",children:"Rejected"}),e("option",{value:"draft",children:"Draft"})]})}),e(k,{md:3,children:r(g.Select,{value:n.reportType,onChange:R=>y("reportType",R.target.value),children:[e("option",{value:"",children:"All Types"}),e("option",{value:"student_report",children:"Student Report"}),e("option",{value:"lecturer_report",children:"Lecturer Report"}),e("option",{value:"progress_report",children:"Progress Report"}),e("option",{value:"feedback_report",children:"Feedback Report"})]})}),e(k,{md:3,children:r(g.Select,{value:n.courseId,onChange:R=>y("courseId",R.target.value),disabled:d,children:[e("option",{value:"",children:"All Courses"}),l.map(R=>r("option",{value:R.id,children:[R.course_name||R.name," ",R.course_code?`(${R.course_code})`:""]},R.id))]})}),e(k,{md:2,children:r(g.Select,{value:n.limit,onChange:R=>y("limit",parseInt(R.target.value)),children:[e("option",{value:5,children:"5 per page"}),e("option",{value:10,children:"10 per page"}),e("option",{value:20,children:"20 per page"}),e("option",{value:50,children:"50 per page"})]})})]}),r(z,{className:"align-items-center mt-3",children:[e(k,{md:6,className:"mb-2 mb-md-0",children:r(g.Select,{value:n.streamId,onChange:R=>y("streamId",R.target.value),disabled:w,children:[e("option",{value:"",children:"All Streams"}),h.map(R=>r("option",{value:R.id,children:[R.stream_name," ",R.stream_code?`(${R.stream_code})`:""]},R.id))]})}),e(k,{md:6,children:r(g.Select,{value:n.courseId,onChange:R=>y("courseId",R.target.value),disabled:d,children:[e("option",{value:"",children:"All Courses"}),l.map(R=>r("option",{value:R.id,children:[R.course_name||R.name," ",R.course_code?`(${R.course_code})`:""]},R.id))]})})]}),e("div",{className:"mt-3 d-flex justify-content-end",children:e(H,{variant:"outline-secondary",size:"sm",onClick:()=>c({page:1,limit:10,status:"",reportType:"",search:"",courseId:"",streamId:""}),children:"Reset Filters"})})]})}),e(_,{children:e(_.Body,{className:"p-0",children:D.length===0?r("div",{className:"text-center py-5",children:[e("i",{className:"bi bi-file-text display-1 text-muted"}),e("h4",{className:"mt-3",children:"No Reports Found"}),e("p",{className:"text-muted",children:n.search||n.status||n.reportType?"Try adjusting your filters":"Create your first report to get started"}),!n.search&&!n.status&&!n.reportType&&r("div",{className:"d-flex justify-content-center gap-2",children:[(t==null?void 0:t.role)!=="lecturer"&&r(H,{variant:"primary",as:M,to:"/reports/create",children:[e("i",{className:"bi bi-plus-circle me-2"}),"Create Report"]}),(t==null?void 0:t.role)==="lecturer"&&r(H,{variant:"primary",as:M,to:"/reports/lecturer/new",children:[e("i",{className:"bi bi-journal-plus me-2"}),"New Lecturer Report"]})]})]}):r(de,{children:[r(le,{responsive:!0,hover:!0,className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Title"}),e("th",{children:"Type"}),e("th",{children:"Status"}),e("th",{children:"Reporter"}),e("th",{children:"Course"}),e("th",{children:"Rating"}),e("th",{children:"Created"}),e("th",{children:"Actions"})]})}),e("tbody",{children:D.map(R=>r("tr",{children:[r("td",{children:[r("div",{className:"fw-bold d-flex align-items-center gap-2",children:[R.title,(R.status||"").toLowerCase()==="draft"&&e("span",{className:"badge bg-secondary",children:"Draft"}),(R.status||"").toLowerCase()==="submitted"&&e("span",{className:"badge bg-warning text-dark",children:"Submitted"}),(R.status||"").toLowerCase()==="reviewed"&&e("span",{className:"badge bg-info text-dark",children:"Reviewed"}),(R.status||"").toLowerCase()==="approved"&&e("span",{className:"badge bg-success",children:"Approved"}),(R.status||"").toLowerCase()==="rejected"&&e("span",{className:"badge bg-danger",children:"Rejected"})]}),r("small",{className:"text-muted",children:[R.content.substring(0,80),R.content.length>80?"...":""]})]}),e("td",{children:e(ue,{bg:"info",children:E(R.report_type)})}),e("td",{children:e(ue,{bg:Q(R.status),children:R.status.toUpperCase()})}),r("td",{children:[r("div",{children:[R.first_name," ",R.last_name]}),e("small",{className:"text-muted",children:E(R.reporter_role)})]}),e("td",{children:R.course_name?r("div",{children:[e("div",{className:"fw-bold",children:R.course_name}),e("small",{className:"text-muted",children:R.course_code})]}):e("span",{className:"text-muted",children:"N/A"})}),e("td",{children:R.rating?e("div",{className:"d-flex align-items-center",title:`${R.rating} / 5`,children:[1,2,3,4,5].map(B=>e("i",{className:`bi ${B<=R.rating?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:14,marginRight:2}},B))}):e("span",{className:"text-muted",children:"N/A"})}),r("td",{children:[e("div",{children:new Date(R.created_at).toLocaleDateString()}),e("small",{className:"text-muted",children:new Date(R.created_at).toLocaleTimeString()})]}),e("td",{children:r("div",{className:"d-flex gap-1",children:[e(H,{size:"sm",variant:"outline-primary",as:M,to:`/reports/${R.id}`,title:"View Details",children:e("i",{className:"bi bi-eye"})}),R.reporter_id===(t==null?void 0:t.id)&&R.status==="draft"&&e(H,{size:"sm",variant:"outline-secondary",onClick:()=>a(`/reports/${R.id}/edit`),title:"Edit Report",children:e("i",{className:"bi bi-pencil"})}),R.reporter_id===(t==null?void 0:t.id)&&R.status==="draft"&&e(H,{size:"sm",variant:"outline-primary",onClick:()=>handleSubmitDraft(R.id),title:"Submit Draft",children:e("i",{className:"bi bi-send"})}),b&&r(ge,{as:Lt,size:"sm",children:[e(H,{variant:"outline-success",onClick:()=>N(R.id,{status:"approved"}),title:"Approve",children:e("i",{className:"bi bi-check2-circle"})}),e(ge.Toggle,{split:!0,variant:"outline-success"}),r(ge.Menu,{align:"end",children:[r(ge.Item,{onClick:()=>N(R.id,{status:"reviewed"}),children:[e("i",{className:"bi bi-eye me-2"}),"Mark Reviewed"]}),r(ge.Item,{onClick:()=>N(R.id,{status:"rejected"}),children:[e("i",{className:"bi bi-x-circle me-2"}),"Reject"]}),e(ge.Divider,{}),r(ge.Item,{onClick:()=>{const B=window.prompt("Enter rating 1-5"),G=Number(B);Number.isInteger(G)&&G>=1&&G<=5?N(R.id,{rating:G}):B!==null&&P.error("Invalid rating")},children:[e("i",{className:"bi bi-star-half me-2"}),"Set Rating"]})]})]})]})})]},R.id))})]}),I.pages>1&&e("div",{className:"p-3 border-top",children:r(z,{className:"align-items-center",children:[e(k,{md:6,children:r("small",{className:"text-muted",children:["Showing ",(I.page-1)*I.limit+1," to"," ",Math.min(I.page*I.limit,I.total)," of"," ",I.total," results"]})}),e(k,{md:6,children:$()})]})})]})})})]})};function ms(){const t=Fe(),{user:a}=ye(),[s,i]=p.useState(""),[n,c]=p.useState(""),[l,o]=p.useState(""),[d,u]=p.useState(""),[h,C]=p.useState([]),[w,m]=p.useState(!1),[f,S]=p.useState([]),[v,b]=p.useState(!1),[N,y]=p.useState("");p.useEffect(()=>{(async()=>{try{m(!0);const{data:Q}=await T.users.getAvailableCourses(),E=Array.isArray(Q)?Q:(Q==null?void 0:Q.courses)||[];C(Array.isArray(E)?E:[])}catch{}finally{m(!1)}})()},[]);const L=F=>{const Q=Array.from(F.target.files||[]),E=5*1024*1024,$=["image/png","image/jpeg","application/pdf","text/plain"];if(Q.find(I=>I.size>E||!$.includes(I.type))){P.error("Files must be PNG/JPEG/PDF/TXT and <= 5MB each");return}S(Q)},x=async F=>{var Q,E,$;if(F.preventDefault(),y(""),!s.trim()||!n.trim()){y("Title and description are required");return}if((a==null?void 0:a.role)!=="student"&&!d){y("Please select a course for this report");return}try{b(!0);const D={title:s.trim(),description:n.trim(),reportType:l||void 0,courseId:d?Number(d):void 0},{data:I}=await T.reports.create(D);P.success("Report created successfully");const K=(Q=I==null?void 0:I.report)==null?void 0:Q.id;if(K&&f.length>0)try{const V=new FormData;f.forEach(R=>V.append("files",R)),await T.reports.uploadAttachments(K,V),P.success("Attachments uploaded")}catch{P("Report saved. Attachments upload will be enabled once storage is configured.",{icon:""})}t(K?`/reports/${K}`:"/reports")}catch(D){const I=(($=(E=D==null?void 0:D.response)==null?void 0:E.data)==null?void 0:$.error)||"Failed to create report";y(I),P.error(I)}finally{b(!1)}};return r("div",{className:"container py-4",children:[e("h1",{className:"mb-3",children:"Create Report"}),e(_,{children:r(_.Body,{children:[N&&e(Z,{variant:"danger",children:N}),r(g,{onSubmit:x,children:[r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Title"}),e(g.Control,{type:"text",placeholder:"Enter a concise title",value:s,onChange:F=>i(F.target.value),disabled:v,required:!0})]}),r(g.Group,{className:"mb-4",children:[e(g.Label,{children:"Description"}),e(g.Control,{as:"textarea",rows:6,placeholder:"Describe your report details",value:n,onChange:F=>c(F.target.value),disabled:v,required:!0})]}),r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Report Type (optional)"}),r(g.Select,{value:l,onChange:F=>o(F.target.value),disabled:v,children:[e("option",{value:"",children:"Auto (based on role)"}),e("option",{value:"student_report",children:"Student Report"}),e("option",{value:"lecturer_report",children:"Lecturer Report"}),e("option",{value:"progress_report",children:"Progress Report"}),e("option",{value:"feedback_report",children:"Feedback Report"})]})]}),r(g.Group,{className:"mb-4",children:[r(g.Label,{children:["Course",(a==null?void 0:a.role)!=="student"?" (required)":" (optional)"]}),r("div",{className:"d-flex align-items-center gap-2",children:[r(g.Select,{value:d,onChange:F=>u(F.target.value),disabled:v||w,required:(a==null?void 0:a.role)!=="student",children:[e("option",{value:"",children:w?"Loading courses...":"Select a course"}),h.map(F=>e("option",{value:F.id,children:F.course_name||F.name},F.id))]}),w&&e(se,{size:"sm"})]}),(a==null?void 0:a.role)==="student"&&e(g.Text,{className:"text-muted",children:"If applicable, associate this report with a course"})]}),r(g.Group,{className:"mb-4",children:[e(g.Label,{children:"Attachments (PNG, JPEG, PDF, TXT up to 5MB each)"}),e(g.Control,{type:"file",multiple:!0,onChange:L,disabled:v}),f.length>0&&r(g.Text,{className:"text-muted",children:[f.length," file(s) selected"]})]}),r("div",{className:"d-flex gap-2",children:[e(H,{type:"submit",variant:"primary",disabled:v,children:v?"Submitting...":"Submit Report"}),e(H,{variant:"outline-secondary",onClick:()=>t(-1),disabled:v,children:"Cancel"})]})]})]})})]})}function ps(){var O;const{id:t}=Cr(),{user:a}=ye(),[s,i]=p.useState(null),[n,c]=p.useState([]),[l,o]=p.useState([]),[d,u]=p.useState(!0),[h,C]=p.useState(!1),[w,m]=p.useState(""),[f,S]=p.useState(!1),[v,b]=p.useState("suggestion"),[N,y]=p.useState(""),[L,x]=p.useState([]),[F,Q]=p.useState(!1),[E,$]=p.useState(5),[D,I]=p.useState(""),[K,V]=p.useState(""),[R,B]=p.useState(""),[G,X]=p.useState(!1),[ne,ae]=p.useState(!1),me=()=>{if(!a||!s)return!1;const A=["admin","faculty_manager","principal_lecturer","program_leader"];return s.reporter_id===a.id||A.includes(a.role)},ke=()=>!a||!s?!1:["admin","faculty_manager","principal_lecturer","program_leader","lecturer"].includes(a.role)&&s.reporter_id!==a.id,Oe=async A=>{var j,q;if(A.preventDefault(),!N.trim()){P.error("Feedback content is required");return}try{S(!0),await T.reports.addFeedback(t,{content:N.trim(),feedbackType:v}),P.success("Feedback submitted"),y(""),await pe()}catch(re){P.error(((q=(j=re==null?void 0:re.response)==null?void 0:j.data)==null?void 0:q.error)||"Failed to submit feedback")}finally{S(!1)}},pe=async()=>{var A,j,q,re,Ne;try{u(!0);const[Ce,qe]=await Promise.all([T.reports.getById(t),T.reports.listAttachments(t)]);i(((A=Ce.data)==null?void 0:A.report)||Ce.data),c(((j=Ce.data)==null?void 0:j.feedback)||[]),o(((q=qe.data)==null?void 0:q.files)||[])}catch(Ce){m(((Ne=(re=Ce==null?void 0:Ce.response)==null?void 0:re.data)==null?void 0:Ne.error)||"Failed to load report")}finally{u(!1)}};p.useEffect(()=>{pe()},[t]),p.useEffect(()=>{(async()=>{try{if(s!=null&&s.course_id){const{data:j}=await T.users.getLecturersByCourse(s.course_id);x((j==null?void 0:j.lecturers)||[])}else x([])}catch{x([])}})()},[s==null?void 0:s.course_id]),p.useEffect(()=>{(s==null?void 0:s.rating)!=null&&B(String(s.rating))},[s==null?void 0:s.rating]);const ct=async A=>{var Ce,qe;const j=Array.from(A.target.files||[]);if(j.length===0)return;const q=5*1024*1024,re=["image/png","image/jpeg","application/pdf","text/plain"];if(j.find(we=>we.size>q||!re.includes(we.type))){P.error("Files must be PNG/JPEG/PDF/TXT and <= 5MB each");return}try{C(!0);const we=new FormData;j.forEach(fr=>we.append("files",fr)),await T.reports.uploadAttachments(t,we),P.success("Attachments uploaded"),await pe()}catch(we){P.error(((qe=(Ce=we==null?void 0:we.response)==null?void 0:Ce.data)==null?void 0:qe.error)||"Failed to upload attachments")}finally{C(!1),A.target.value=""}};return d?e("div",{className:"container py-4",children:e(se,{})}):w?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:w})}):s?r("div",{className:"container py-4",children:[r(z,{className:"mb-3",children:[r(k,{children:[e("h2",{className:"mb-1",children:s.title}),r("div",{className:"text-muted small",children:["Created ",new Date(s.created_at).toLocaleString()]})]}),r(k,{className:"text-md-end",children:[r("div",{className:"d-flex gap-2 justify-content-md-end",children:[e(ue,{bg:"secondary",children:s.course_name||"No course"}),e(ue,{bg:s.status==="approved"?"success":s.status==="rejected"?"danger":s.status==="submitted"?"primary":"secondary",children:(O=s.status)==null?void 0:O.toUpperCase()})]}),s.reporter_id===(a==null?void 0:a.id)&&s.status==="draft"&&r("div",{className:"mt-2 d-flex justify-content-md-end",children:[r("div",{className:"me-2 text-muted small d-flex align-items-center",children:["Will be submitted to ",(a==null?void 0:a.role)==="student"?"LECTURER":"PROGRAM_LEADER"]}),r(H,{size:"sm",variant:"primary",disabled:ne,onClick:async()=>{var q,re;const A=(a==null?void 0:a.role)==="student"?"LECTURER":"PROGRAM_LEADER";if(window.confirm(`Submit this draft for review to ${A}?`))try{ae(!0),await T.reports.submit(t),P.success(`Report submitted to ${A}`),await pe()}catch(Ne){P.error(((re=(q=Ne==null?void 0:Ne.response)==null?void 0:q.data)==null?void 0:re.error)||"Failed to submit report")}finally{ae(!1)}},children:[e("i",{className:"bi bi-send-fill me-1"}),"Submit"]})]}),s.rating?e("div",{className:"mt-2 d-flex justify-content-md-end align-items-center",title:`${s.rating} / 5`,children:[1,2,3,4,5].map(A=>e("i",{className:`bi ${A<=s.rating?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:16,marginLeft:2}},A))}):null,["admin","faculty_manager","principal_lecturer","program_leader"].includes(a==null?void 0:a.role)&&s.reporter_id!==(a==null?void 0:a.id)&&!["approved","rejected"].includes(s.status)&&r("div",{className:"mt-2 d-flex gap-2 justify-content-md-end",children:[r(H,{size:"sm",variant:"success",disabled:ne,onClick:async()=>{var A,j;try{ae(!0),await T.reports.moderate(t,{status:"approved"}),P.success("Report approved"),await pe()}catch(q){P.error(((j=(A=q==null?void 0:q.response)==null?void 0:A.data)==null?void 0:j.error)||"Failed to approve")}finally{ae(!1)}},children:[e("i",{className:"bi bi-check2-circle me-1"}),"Approve"]}),r(H,{size:"sm",variant:"outline-secondary",disabled:ne,onClick:async()=>{var A,j;try{ae(!0),await T.reports.moderate(t,{status:"reviewed"}),P.success("Report marked as reviewed"),await pe()}catch(q){P.error(((j=(A=q==null?void 0:q.response)==null?void 0:A.data)==null?void 0:j.error)||"Failed to mark reviewed")}finally{ae(!1)}},children:[e("i",{className:"bi bi-eye me-1"}),"Mark Reviewed"]}),r(H,{size:"sm",variant:"outline-danger",disabled:ne,onClick:async()=>{var A,j;try{ae(!0),await T.reports.moderate(t,{status:"rejected"}),P.success("Report rejected"),await pe()}catch(q){P.error(((j=(A=q==null?void 0:q.response)==null?void 0:A.data)==null?void 0:j.error)||"Failed to reject")}finally{ae(!1)}},children:[e("i",{className:"bi bi-x-circle me-1"}),"Reject"]}),r(H,{size:"sm",variant:"outline-warning",disabled:ne,onClick:async()=>{var q,re;const A=window.prompt("Set rating (1-5)"),j=Number(A);if(A!==null){if(!Number.isInteger(j)||j<1||j>5){P.error("Invalid rating");return}try{ae(!0),await T.reports.moderate(t,{rating:j}),P.success("Rating updated"),await pe()}catch(Ne){P.error(((re=(q=Ne==null?void 0:Ne.response)==null?void 0:q.data)==null?void 0:re.error)||"Failed to set rating")}finally{ae(!1)}}},children:[e("i",{className:"bi bi-star-half me-1"}),"Set Rating"]})]})]})]}),r(z,{children:[r(k,{md:8,className:"mb-3",children:[r(_,{children:[e(_.Header,{children:e("strong",{children:"Content"})}),e(_.Body,{style:{whiteSpace:"pre-wrap"},children:s.content})]}),["admin","faculty_manager","principal_lecturer","program_leader"].includes(a==null?void 0:a.role)&&r(_,{className:"mb-3 mt-3",children:[e(_.Header,{children:e("strong",{children:"Manual Rating"})}),e(_.Body,{children:r(g,{onSubmit:async A=>{var j,q;A.preventDefault();try{X(!0),await T.reports.moderate(t,{rating:Number(R||0)}),P.success("Rating updated"),await pe()}catch(re){P.error(((q=(j=re==null?void 0:re.response)==null?void 0:j.data)==null?void 0:q.error)||"Failed to update rating")}finally{X(!1)}},children:[r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Set Rating (1-5)"}),r(g.Select,{value:R,onChange:A=>B(A.target.value),disabled:G,children:[e("option",{value:"",children:"Select"}),[5,4,3,2,1].map(A=>e("option",{value:A,children:A},A))]})]}),e("div",{className:"d-flex justify-content-end",children:e(H,{type:"submit",variant:"warning",disabled:G||!R,children:G?"Saving...":"Save Rating"})})]})})]}),r(_,{className:"mt-3",children:[e(_.Header,{children:e("strong",{children:"Feedback"})}),r(_.Body,{children:[Array.isArray(n)&&n.length>0?e("ul",{className:"list-unstyled",children:n.map(A=>r("li",{className:"mb-3",children:[r("div",{className:"d-flex justify-content-between",children:[r("div",{children:[e(ue,{bg:"secondary",className:"me-2",children:A.feedback_type}),r("strong",{children:[A.from_first_name," ",A.from_last_name]}),r("span",{className:"text-muted ms-2 small",children:["to ",A.to_first_name," ",A.to_last_name]})]}),e("small",{className:"text-muted",children:new Date(A.created_at).toLocaleString()})]}),e("div",{className:"mt-1",style:{whiteSpace:"pre-wrap"},children:A.feedback_content})]},A.id))}):e("div",{className:"text-muted",children:"No feedback yet"}),ke()&&r(g,{onSubmit:Oe,className:"mt-3",children:[r(z,{className:"g-2 align-items-end",children:[r(k,{md:3,children:[e(g.Label,{children:"Type"}),r(g.Select,{value:v,onChange:A=>b(A.target.value),disabled:f,children:[e("option",{value:"approval",children:"Approval"}),e("option",{value:"rejection",children:"Rejection"}),e("option",{value:"suggestion",children:"Suggestion"}),e("option",{value:"clarification",children:"Clarification"})]})]}),r(k,{md:9,children:[e(g.Label,{children:"Feedback"}),e(g.Control,{as:"textarea",rows:3,value:N,onChange:A=>y(A.target.value),disabled:f,placeholder:"Write your feedback..."})]})]}),e("div",{className:"mt-2 d-flex justify-content-end",children:e(H,{type:"submit",variant:"primary",disabled:f,children:f?"Submitting...":"Submit Feedback"})})]})]})]})]}),r(k,{md:4,children:[r(_,{className:"mb-3",children:[e(_.Header,{children:e("strong",{children:"Attachments"})}),r(_.Body,{children:[l.length===0?e("div",{className:"text-muted",children:"No attachments"}):e("ul",{className:"list-unstyled mb-0",children:l.map((A,j)=>r("li",{className:"d-flex justify-content-between align-items-center mb-2",children:[r("a",{href:A.url,target:"_blank",rel:"noreferrer",className:"text-decoration-none",children:[e("i",{className:"bi bi-paperclip me-1"}),A.filename]}),r("small",{className:"text-muted",children:[Math.ceil(A.size/1024)," KB"]})]},j))}),me()&&r(g.Group,{className:"mt-3",children:[e(g.Label,{className:"btn btn-outline-primary",children:h?"Uploading...":"Upload Files"}),e(g.Control,{type:"file",multiple:!0,onChange:ct,hidden:!0,disabled:h})]})]})]}),(a==null?void 0:a.role)==="student"&&(s==null?void 0:s.course_id)&&r(_,{children:[e(_.Header,{children:e("strong",{children:"Rate This Class"})}),e(_.Body,{children:L.length===0?e("div",{className:"text-muted",children:"No lecturers assigned to this course"}):r(g,{onSubmit:async A=>{var j,q;if(A.preventDefault(),!D){P.error("Please select a lecturer");return}try{Q(!0),await T.users.rateClass({courseId:s.course_id,lecturerId:Number(D),rating:Number(E),comments:K,classDate:new Date().toISOString().split("T")[0]}),P.success("Thank you for your rating"),V("")}catch(re){P.error(((q=(j=re==null?void 0:re.response)==null?void 0:j.data)==null?void 0:q.error)||"Failed to submit rating")}finally{Q(!1)}},children:[r(g.Group,{className:"mb-2",children:[e(g.Label,{children:"Lecturer"}),r(g.Select,{value:D,onChange:A=>I(A.target.value),disabled:F,children:[e("option",{value:"",children:"Select lecturer"}),L.map(A=>r("option",{value:A.id,children:[A.first_name," ",A.last_name]},A.id))]})]}),r(g.Group,{className:"mb-2",children:[e(g.Label,{children:"Rating"}),e(g.Select,{value:E,onChange:A=>$(A.target.value),disabled:F,children:[5,4,3,2,1].map(A=>e("option",{value:A,children:A},A))})]}),r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Comments (optional)"}),e(g.Control,{as:"textarea",rows:3,value:K,onChange:A=>V(A.target.value),disabled:F})]}),e("div",{className:"d-flex justify-content-end",children:e(H,{type:"submit",variant:"success",disabled:F,children:F?"Submitting...":"Submit Rating"})})]})})]})]})]})]}):null}const hr="registered_students_by_course_code_v1",mr=()=>{try{return JSON.parse(localStorage.getItem(hr)||"{}")}catch{return{}}},fs=(t,a)=>{const s=mr();t&&(s[String(t).toUpperCase()]=Number(a)||0,localStorage.setItem(hr,JSON.stringify(s)))},gs=t=>{const a=mr();if(!t)return;const s=String(t).toUpperCase();return a[s]};function vs(){const t=Fe(),{user:a}=ye(),[s,i]=p.useState([]),[n,c]=p.useState(!1),[l,o]=p.useState({facultyName:"",className:"",weekOfReporting:"",dateOfLecture:"",courseId:"",courseName:"",courseCode:"",lecturerName:"",actualStudentsPresent:"",totalRegisteredStudents:"",venue:"",scheduledLectureTime:"",topicTaught:"",learningOutcomes:"",recommendations:""}),[d,u]=p.useState({}),[h,C]=p.useState(!1),[w,m]=p.useState("");p.useEffect(()=>{(a!=null&&a.firstName||a!=null&&a.lastName)&&o(b=>({...b,lecturerName:`${(a==null?void 0:a.firstName)||""} ${(a==null?void 0:a.lastName)||""}`.trim()}))},[a]),p.useEffect(()=>{(async()=>{try{c(!0);const{data:N}=await T.users.getAvailableCourses(),y=Array.isArray(N)?N:(N==null?void 0:N.courses)||[];i(Array.isArray(y)?y:[])}catch{}finally{c(!1)}})()},[]),p.useEffect(()=>{if(l.courseCode){const b=gs(l.courseCode);typeof b=="number"&&b>0&&o(N=>({...N,totalRegisteredStudents:String(b)}))}},[l.courseCode]);const f=b=>{const{name:N,value:y}=b.target;o(L=>({...L,[N]:y})),d[N]&&u(L=>({...L,[N]:""}))},S=()=>{const b={};l.facultyName.trim()||(b.facultyName="Faculty Name is required"),l.className.trim()||(b.className="Class Name is required"),l.weekOfReporting||(b.weekOfReporting="Week of Reporting is required"),l.dateOfLecture||(b.dateOfLecture="Date of Lecture is required"),l.courseId||(b.courseId="Please select a Course"),l.courseName.trim()||(b.courseName="Course Name is required"),l.courseCode.trim()||(b.courseCode="Course Code is required"),l.lecturerName.trim()||(b.lecturerName="Lecturer's Name is required");const N=Number(l.actualStudentsPresent);l.actualStudentsPresent?(!Number.isFinite(N)||N<0)&&(b.actualStudentsPresent="Enter a valid non-negative number"):b.actualStudentsPresent="Actual number present is required";const y=Number(l.totalRegisteredStudents);return l.totalRegisteredStudents===""?b.totalRegisteredStudents="Total Registered Students is required":!Number.isFinite(y)||y<=0?b.totalRegisteredStudents="Enter a valid positive number":Number.isFinite(N)&&N>y&&(b.actualStudentsPresent="Present cannot exceed total registered"),l.venue.trim()||(b.venue="Venue is required"),l.scheduledLectureTime||(b.scheduledLectureTime="Scheduled Lecture Time is required"),l.topicTaught.trim()||(b.topicTaught="Topic Taught is required"),l.learningOutcomes.trim()||(b.learningOutcomes="Learning Outcomes are required"),u(b),Object.keys(b).length===0},v=async b=>{var N,y;if(b.preventDefault(),m(""),!!S())try{C(!0),l.courseCode&&l.totalRegisteredStudents&&fs(l.courseCode,Number(l.totalRegisteredStudents));const L={reportType:"lecturer_report",title:`${l.courseCode}  ${l.topicTaught}`,description:[`Faculty: ${l.facultyName}`,`Class: ${l.className}`,`Week: ${l.weekOfReporting}`,`Date of Lecture: ${l.dateOfLecture}`,`Course: ${l.courseName} (${l.courseCode})`,`Lecturer: ${l.lecturerName}`,`Students Present: ${l.actualStudentsPresent} / ${l.totalRegisteredStudents}`,`Venue: ${l.venue}`,`Scheduled Time: ${l.scheduledLectureTime}`,`Topic Taught: ${l.topicTaught}`,`Learning Outcomes: ${l.learningOutcomes}`,`Recommendations: ${l.recommendations||"N/A"}`].join(`
`),courseId:Number(l.courseId),details:{facultyName:l.facultyName,className:l.className,weekOfReporting:l.weekOfReporting,dateOfLecture:l.dateOfLecture,courseName:l.courseName,courseCode:l.courseCode,lecturerName:l.lecturerName,actualStudentsPresent:Number(l.actualStudentsPresent),totalRegisteredStudents:Number(l.totalRegisteredStudents),venue:l.venue,scheduledLectureTime:l.scheduledLectureTime,topicTaught:l.topicTaught,learningOutcomes:l.learningOutcomes,recommendations:l.recommendations}};await T.reports.create(L),P.success("Lecturer report submitted"),t("/reports")}catch(L){const x=((y=(N=L==null?void 0:L.response)==null?void 0:N.data)==null?void 0:y.error)||"Failed to submit lecturer report";m(x),P.error(x)}finally{C(!1)}};return r("div",{className:"container py-4",children:[e("h1",{className:"mb-3",children:"Data Entry (Lecturer Reporting Form)"}),e(_,{children:r(_.Body,{children:[w&&e(Z,{variant:"danger",children:w}),r(g,{onSubmit:v,children:[e(z,{children:e(k,{md:12,children:r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Course"}),r(g.Select,{name:"courseId",value:l.courseId,onChange:b=>{const N=b.target.value;o(L=>({...L,courseId:N})),d.courseId&&u(L=>({...L,courseId:""}));const y=s.find(L=>String(L.id)===N);y&&o(L=>({...L,courseId:String(y.id),courseName:y.course_name||y.name||L.courseName,courseCode:y.course_code||L.courseCode}))},disabled:n,isInvalid:!!d.courseId,children:[e("option",{value:"",children:n?"Loading courses...":"Select a course"}),s.map(b=>r("option",{value:b.id,children:[b.course_name||b.name,b.course_code?` (${b.course_code})`:""]},b.id))]}),e(g.Control.Feedback,{type:"invalid",children:d.courseId}),!n&&s.length===0&&e(g.Text,{className:"text-warning",children:"No courses available. Please contact your Program Leader."})]})})}),r(z,{children:[e(k,{md:6,children:r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Faculty Name"}),e(g.Control,{name:"facultyName",value:l.facultyName,onChange:f,isInvalid:!!d.facultyName}),e(g.Control.Feedback,{type:"invalid",children:d.facultyName})]})}),e(k,{md:6,children:r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Class Name"}),e(g.Control,{name:"className",value:l.className,onChange:f,isInvalid:!!d.className}),e(g.Control.Feedback,{type:"invalid",children:d.className})]})})]}),r(z,{children:[e(k,{md:6,children:r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Week of Reporting"}),e(g.Control,{type:"week",name:"weekOfReporting",value:l.weekOfReporting,onChange:f,isInvalid:!!d.weekOfReporting}),e(g.Control.Feedback,{type:"invalid",children:d.weekOfReporting})]})}),e(k,{md:6,children:r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Date of Lecture"}),e(g.Control,{type:"date",name:"dateOfLecture",value:l.dateOfLecture,onChange:f,isInvalid:!!d.dateOfLecture}),e(g.Control.Feedback,{type:"invalid",children:d.dateOfLecture})]})})]}),r(z,{children:[e(k,{md:6,children:r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Course Name"}),r(Ee,{children:[e(g.Control,{name:"courseName",value:l.courseName,onChange:f,isInvalid:!!d.courseName}),e(g.Control,{readOnly:!0,value:l.courseId?"Selected from list":"",placeholder:"",style:{maxWidth:180}})]}),e(g.Control.Feedback,{type:"invalid",children:d.courseName})]})}),e(k,{md:6,children:r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Course Code"}),e(g.Control,{name:"courseCode",value:l.courseCode,onChange:f,isInvalid:!!d.courseCode}),e(g.Control.Feedback,{type:"invalid",children:d.courseCode})]})})]}),r(z,{children:[e(k,{md:6,children:r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Lecturers Name"}),e(g.Control,{name:"lecturerName",value:l.lecturerName,onChange:f,isInvalid:!!d.lecturerName}),e(g.Control.Feedback,{type:"invalid",children:d.lecturerName})]})}),e(k,{md:3,children:r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Actual Students Present"}),e(g.Control,{type:"number",min:0,name:"actualStudentsPresent",value:l.actualStudentsPresent,onChange:f,isInvalid:!!d.actualStudentsPresent}),e(g.Control.Feedback,{type:"invalid",children:d.actualStudentsPresent})]})}),e(k,{md:3,children:r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Total Registered Students"}),e(g.Control,{type:"number",min:1,name:"totalRegisteredStudents",value:l.totalRegisteredStudents,onChange:f,isInvalid:!!d.totalRegisteredStudents}),e(g.Text,{className:"text-muted",children:"Auto-filled for known course codes."}),e(g.Control.Feedback,{type:"invalid",children:d.totalRegisteredStudents})]})})]}),r(z,{children:[e(k,{md:6,children:r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Venue of the Class"}),e(g.Control,{name:"venue",value:l.venue,onChange:f,isInvalid:!!d.venue}),e(g.Control.Feedback,{type:"invalid",children:d.venue})]})}),e(k,{md:6,children:r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Scheduled Lecture Time"}),e(g.Control,{type:"time",name:"scheduledLectureTime",value:l.scheduledLectureTime,onChange:f,isInvalid:!!d.scheduledLectureTime}),e(g.Control.Feedback,{type:"invalid",children:d.scheduledLectureTime})]})})]}),r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Topic Taught"}),e(g.Control,{name:"topicTaught",value:l.topicTaught,onChange:f,isInvalid:!!d.topicTaught}),e(g.Control.Feedback,{type:"invalid",children:d.topicTaught})]}),r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Learning Outcomes of the Topic"}),e(g.Control,{as:"textarea",rows:4,name:"learningOutcomes",value:l.learningOutcomes,onChange:f,isInvalid:!!d.learningOutcomes}),e(g.Control.Feedback,{type:"invalid",children:d.learningOutcomes})]}),r(g.Group,{className:"mb-4",children:[e(g.Label,{children:"Lecturers Recommendations"}),e(g.Control,{as:"textarea",rows:3,name:"recommendations",value:l.recommendations,onChange:f})]}),r("div",{className:"d-flex gap-2",children:[e(H,{type:"submit",variant:"primary",disabled:h,children:h?"Submitting...":"Submit Lecturer Report"}),e(H,{variant:"outline-secondary",onClick:()=>t(-1),disabled:h,children:"Cancel"})]})]})]})})]})}function bs(){const{user:t,isLoading:a,loadUser:s}=ye(),[i,n]=p.useState(null),[c,l]=p.useState(!0),[o,d]=p.useState(!1),[u,h]=p.useState(!1),[C,w]=p.useState("");p.useEffect(()=>{(async()=>{var b,N;try{l(!0);const{data:y}=await T.users.getMe();n({id:y.id,username:y.username,email:y.email,role:y.role,firstName:y.first_name||"",lastName:y.last_name||"",phone:y.phone||"",avatarUrl:y.avatarUrl||null,created_at:y.created_at})}catch(y){w(((N=(b=y==null?void 0:y.response)==null?void 0:b.data)==null?void 0:N.error)||"Failed to load profile")}finally{l(!1)}})()},[]);const m=(v,b)=>n(N=>({...N,[v]:b})),f=async v=>{var b,N;v.preventDefault(),w("");try{d(!0),await T.users.updateMe({firstName:i.firstName,lastName:i.lastName,phone:i.phone}),P.success("Profile updated"),await s()}catch(y){const L=((N=(b=y==null?void 0:y.response)==null?void 0:b.data)==null?void 0:N.error)||"Failed to update profile";w(L),P.error(L)}finally{d(!1)}},S=async v=>{var y,L,x;const b=(y=v.target.files)==null?void 0:y[0];if(!b)return;if(!["image/png","image/jpeg","image/jpg","image/webp","image/gif"].includes(b.type)){P.error("Invalid image type");return}if(b.size>3*1024*1024){P.error("Image must be <= 3MB");return}try{h(!0);const{data:F}=await T.users.uploadAvatar(b);n(Q=>({...Q,avatarUrl:F.url})),P.success("Avatar updated"),await s()}catch(F){P.error(((x=(L=F==null?void 0:F.response)==null?void 0:L.data)==null?void 0:x.error)||"Failed to upload avatar")}finally{h(!1)}};return c||a||!i?e("div",{className:"container py-4",children:e(se,{})}):r("div",{className:"container py-4",children:[r("h2",{className:"mb-3",children:[e("i",{className:"bi bi-person-circle me-2"}),"My Profile"]}),C&&e(Z,{variant:"danger",children:C}),r(z,{children:[e(k,{md:4,className:"mb-3",children:r(_,{className:"h-100",children:[e(_.Header,{children:e("strong",{children:"Avatar"})}),r(_.Body,{className:"text-center",children:[e("div",{className:"mb-3",children:i.avatarUrl?e("img",{src:i.avatarUrl,alt:"Avatar",className:"rounded-circle",style:{width:140,height:140,objectFit:"cover",border:"1px solid #eee"},onError:v=>{v.currentTarget.onerror=null,v.currentTarget.src="/default-avatar.svg"}}):e("div",{className:"rounded-circle bg-light d-flex align-items-center justify-content-center",style:{width:140,height:140,border:"1px solid #eee"},children:e("i",{className:"bi bi-person fs-1 text-muted"})})}),r(g.Group,{controlId:"avatar",children:[e(g.Label,{className:"btn btn-outline-primary",children:u?"Uploading...":"Upload Avatar"}),e(g.Control,{type:"file",accept:"image/*",onChange:S,disabled:u,hidden:!0})]})]})]})}),e(k,{md:8,children:r(_,{children:[e(_.Header,{children:e("strong",{children:"Profile Details"})}),e(_.Body,{children:r(g,{onSubmit:f,children:[r(z,{className:"mb-3",children:[e(k,{md:6,children:r(g.Group,{children:[e(g.Label,{children:"First Name"}),e(g.Control,{value:i.firstName,onChange:v=>m("firstName",v.target.value),disabled:o})]})}),e(k,{md:6,children:r(g.Group,{children:[e(g.Label,{children:"Last Name"}),e(g.Control,{value:i.lastName,onChange:v=>m("lastName",v.target.value),disabled:o})]})})]}),r(z,{className:"mb-3",children:[e(k,{md:6,children:r(g.Group,{children:[e(g.Label,{children:"Username"}),e(g.Control,{value:i.username,disabled:!0,readOnly:!0})]})}),e(k,{md:6,children:r(g.Group,{children:[e(g.Label,{children:"Email"}),e(g.Control,{value:i.email,disabled:!0,readOnly:!0})]})})]}),r(z,{className:"mb-3",children:[e(k,{md:6,children:r(g.Group,{children:[e(g.Label,{children:"Phone"}),e(g.Control,{value:i.phone,onChange:v=>m("phone",v.target.value),disabled:o})]})}),e(k,{md:6,children:r(g.Group,{children:[e(g.Label,{children:"Role"}),e(g.Control,{value:i.role,disabled:!0,readOnly:!0})]})})]}),e("div",{className:"d-flex gap-2",children:e(H,{type:"submit",variant:"primary",disabled:o,children:o?"Saving...":"Save Changes"})})]})})]})})]})]})}function ys(){const{user:t}=ye(),[a,s]=p.useState([]),[i,n]=p.useState(!0),[c,l]=p.useState(!1),[o,d]=p.useState(!1),[u,h]=p.useState(null),[C,w]=p.useState(!1),[m,f]=p.useState(!1),[S,v]=p.useState([]),[b,N]=p.useState("student"),[y,L]=p.useState(null),[x,F]=p.useState({username:"",email:"",firstName:"",lastName:""}),[Q,E]=p.useState(null),[$,D]=p.useState(""),[I,K]=p.useState({username:"",email:"",password:"",firstName:"",lastName:"",role:"student"}),V=p.useMemo(()=>["student","lecturer","program_leader","principal_lecturer","faculty_manager"],[]),R=async()=>{var O,A;try{n(!0),h(null);const{data:j}=await T.users.getAll();s(Array.isArray(j)?j:j.users||[]),v([])}catch(j){const q=((A=(O=j.response)==null?void 0:O.data)==null?void 0:A.error)||"Failed to fetch users";h(q),P.error(q)}finally{n(!1)}},B=async O=>{var A,j;if(confirm("Generate a temporary password for this user? It will be shown once."))try{E(O);const{data:q}=await T.users.resetPassword(O);D((q==null?void 0:q.tempPassword)||"")}catch(q){P.error(((j=(A=q.response)==null?void 0:A.data)==null?void 0:j.error)||"Failed to reset password")}finally{E(null)}},G=()=>D(""),X=async()=>{try{await navigator.clipboard.writeText($),P.success("Copied")}catch{}};p.useEffect(()=>{C&&!m&&(async()=>(await R(),f(!0)))()},[C,m]);const ne=async O=>{var A,j,q;(A=O==null?void 0:O.preventDefault)==null||A.call(O);try{d(!0),await T.users.create(I),P.success("User created"),K({username:"",email:"",password:"",firstName:"",lastName:"",role:"student"}),l(!1),await R()}catch(re){P.error(((q=(j=re.response)==null?void 0:j.data)==null?void 0:q.error)||"Failed to create user")}finally{d(!1)}},ae=async(O,A)=>{var j,q;try{await T.users.update(O,{role:A}),P.success("Role updated"),await R()}catch(re){P.error(((q=(j=re.response)==null?void 0:j.data)==null?void 0:q.error)||"Failed to update role")}},me=async O=>{var A,j;try{O.is_active===!1?(await T.users.reactivate(O.id),P.success("User reactivated")):(await T.users.deactivate(O.id),P.success("User deactivated")),await R()}catch(q){P.error(((j=(A=q.response)==null?void 0:A.data)==null?void 0:j.error)||"Failed to toggle active")}},ke=async O=>{var A,j;if(confirm("Are you sure you want to delete this user?"))try{await T.users.delete(O),P.success("User deleted"),await R()}catch(q){P.error(((j=(A=q.response)==null?void 0:A.data)==null?void 0:j.error)||"Failed to delete user")}},Oe=O=>{L(O.id),F({username:O.username||"",email:O.email||"",firstName:O.firstName??O.first_name??"",lastName:O.lastName??O.last_name??""})},pe=()=>{L(null),F({username:"",email:"",firstName:"",lastName:""})},ct=async O=>{var A,j;try{const q={username:x.username,email:x.email,firstName:x.firstName,lastName:x.lastName,first_name:x.firstName,last_name:x.lastName};await T.users.update(O,q),P.success("User updated"),pe(),await R()}catch(q){P.error(((j=(A=q.response)==null?void 0:A.data)==null?void 0:j.error)||"Failed to update user")}};return r("div",{className:"container py-4",children:[r("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e("h1",{className:"m-0",children:"Users Management"}),r("div",{className:"d-flex gap-2",children:[e("button",{className:"btn btn-outline-secondary",onClick:()=>w(O=>!O),children:C?"Hide Users":"Show Users"}),e("button",{className:"btn btn-primary",onClick:()=>l(O=>!O),children:c?"Close":"Add User"})]})]}),C&&(t==null?void 0:t.role)==="admin"&&e("div",{className:"card card-body mb-3",children:r("div",{className:"d-flex flex-wrap align-items-center gap-2",children:[r("span",{className:"me-2",children:["Bulk actions for ",S.length," selected:"]}),e("button",{className:"btn btn-sm btn-outline-success",onClick:()=>doBulk("activate"),disabled:S.length===0,children:"Activate"}),e("button",{className:"btn btn-sm btn-outline-warning",onClick:()=>doBulk("deactivate"),disabled:S.length===0,children:"Deactivate"}),e("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>doBulk("delete"),disabled:S.length===0,children:"Delete"}),r("div",{className:"d-flex align-items-center gap-2 ms-2",children:[r("select",{className:"form-select form-select-sm",value:b,onChange:O=>N(O.target.value),children:[V.map(O=>e("option",{value:O,children:O},O)),e("option",{value:"admin",children:"admin"})]}),e("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>doBulk("setRole"),disabled:S.length===0,children:"Set Role"})]})]})}),c&&r("form",{className:"card card-body mb-4",onSubmit:ne,children:[r("div",{className:"row g-3",children:[r("div",{className:"col-md-4",children:[e("label",{className:"form-label",children:"Username"}),e("input",{className:"form-control",value:I.username,onChange:O=>K({...I,username:O.target.value}),required:!0})]}),r("div",{className:"col-md-4",children:[e("label",{className:"form-label",children:"Email"}),e("input",{type:"email",className:"form-control",value:I.email,onChange:O=>K({...I,email:O.target.value}),required:!0})]}),r("div",{className:"col-md-4",children:[e("label",{className:"form-label",children:"Password"}),e("input",{type:"password",className:"form-control",value:I.password,onChange:O=>K({...I,password:O.target.value}),required:!0})]}),r("div",{className:"col-md-4",children:[e("label",{className:"form-label",children:"First Name"}),e("input",{className:"form-control",value:I.firstName,onChange:O=>K({...I,firstName:O.target.value})})]}),r("div",{className:"col-md-4",children:[e("label",{className:"form-label",children:"Last Name"}),e("input",{className:"form-control",value:I.lastName,onChange:O=>K({...I,lastName:O.target.value})})]}),r("div",{className:"col-md-4",children:[e("label",{className:"form-label",children:"Role"}),e("select",{className:"form-select",value:I.role,onChange:O=>K({...I,role:O.target.value}),children:V.map(O=>e("option",{value:O,children:O},O))})]})]}),e("div",{className:"mt-3",children:e("button",{type:"submit",className:"btn btn-success",disabled:o,children:o?"Creating":"Create User"})})]}),C&&i&&e("div",{className:"py-5 text-center",children:"Loading users"}),C&&u&&e("div",{className:"alert alert-danger",children:u}),C&&!i&&!u&&e("div",{className:"table-responsive",children:r("table",{className:"table table-striped align-middle",children:[e("thead",{children:r("tr",{children:[e("th",{children:e("input",{type:"checkbox","aria-label":"Select all",checked:S.length>0&&S.length===a.length,onChange:O=>toggleAll(O.target.checked)})}),e("th",{children:"ID"}),e("th",{children:"Username"}),e("th",{children:"Email"}),e("th",{children:"Name"}),e("th",{children:"Role"}),e("th",{children:"Status"}),e("th",{style:{width:280},children:"Actions"})]})}),e("tbody",{children:a.map(O=>r("tr",{children:[e("td",{children:e("input",{type:"checkbox","aria-label":`Select user ${O.id}`,checked:S.includes(O.id),onChange:A=>toggleOne(O.id,A.target.checked)})}),e("td",{children:O.id}),e("td",{children:(t==null?void 0:t.role)==="admin"&&y===O.id?e("input",{className:"form-control form-control-sm",value:x.username,onChange:A=>F({...x,username:A.target.value})}):O.username}),e("td",{children:(t==null?void 0:t.role)==="admin"&&y===O.id?e("input",{type:"email",className:"form-control form-control-sm",value:x.email,onChange:A=>F({...x,email:A.target.value})}):O.email}),e("td",{children:(t==null?void 0:t.role)==="admin"&&y===O.id?r("div",{className:"d-flex gap-2",children:[e("input",{className:"form-control form-control-sm",placeholder:"First",style:{maxWidth:140},value:x.firstName,onChange:A=>F({...x,firstName:A.target.value})}),e("input",{className:"form-control form-control-sm",placeholder:"Last",style:{maxWidth:140},value:x.lastName,onChange:A=>F({...x,lastName:A.target.value})})]}):[O.firstName||O.first_name,O.lastName||O.last_name].filter(Boolean).join(" ")}),e("td",{children:r("select",{className:"form-select form-select-sm",value:O.role,onChange:A=>ae(O.id,A.target.value),children:[V.map(A=>e("option",{value:A,children:A},A)),e("option",{value:"admin",children:"admin"})]})}),e("td",{children:O.is_active===!1?e("span",{className:"badge bg-secondary",children:"Inactive"}):e("span",{className:"badge bg-success",children:"Active"})}),e("td",{children:r("div",{className:"d-flex gap-2",children:[(t==null?void 0:t.role)==="admin"&&(y===O.id?r(de,{children:[e("button",{className:"btn btn-sm btn-success",onClick:()=>ct(O.id),children:"Save"}),e("button",{className:"btn btn-sm btn-secondary",onClick:pe,children:"Cancel"})]}):e("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>Oe(O),children:"Edit"})),(t==null?void 0:t.role)==="admin"&&e("button",{className:"btn btn-sm btn-outline-dark",onClick:()=>B(O.id),disabled:Q===O.id,children:Q===O.id?"Resetting":"Reset Password"}),e("button",{className:"btn btn-sm btn-outline-warning",onClick:()=>me(O),children:O.is_active===!1?"Reactivate":"Deactivate"}),e("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>ke(O.id),children:"Delete"})]})})]},O.id))})]})}),$&&e("div",{className:"modal fade show",style:{display:"block",background:"rgba(0,0,0,0.5)"},tabIndex:"-1",role:"dialog","aria-modal":"true",children:e("div",{className:"modal-dialog modal-sm modal-dialog-centered",children:r("div",{className:"modal-content",children:[r("div",{className:"modal-header",children:[e("h5",{className:"modal-title",children:"Temporary Password"}),e("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:G})]}),r("div",{className:"modal-body",children:[e("div",{className:"alert alert-warning small",children:"Shown once. Copy and share securely with the user."}),r("div",{className:"input-group",children:[e("input",{className:"form-control",value:$,readOnly:!0}),e("button",{className:"btn btn-outline-secondary",onClick:X,children:"Copy"})]})]}),e("div",{className:"modal-footer",children:e("button",{type:"button",className:"btn btn-primary",onClick:G,children:"Done"})})]})})})]})}Ue.register(gt,vt,bt,yt,Sr,Nt,Qt,qt);function ze({title:t,value:a,subtitle:s}){return e("div",{className:"card shadow-sm h-100",children:r("div",{className:"card-body",children:[e("h6",{className:"text-muted mb-1",children:t}),e("div",{className:"display-6 fw-bold",children:a??"-"}),s&&e("div",{className:"text-secondary small mt-1",children:s})]})})}function pr(){const t=Fe(),[a,s]=p.useState(30),{data:i,isLoading:n,isError:c,refetch:l}=be(["admin-overview",a],async()=>{const x=await T.admin.getOverview(a);return(x==null?void 0:x.data)??x},{refetchInterval:6e4});if(n)return e("div",{className:"container py-4",children:"Loading admin overview..."});if(c)return e("div",{className:"container py-4 text-danger",children:"Failed to load admin overview"});const o=(i==null?void 0:i.users)||{},d=(i==null?void 0:i.reports)||{},u=(i==null?void 0:i.streams)||[],h=(i==null?void 0:i.topCourses)||[],C=(i==null?void 0:i.recentUsers)||[],w=(i==null?void 0:i.reportTrend)||[],m=w.map(x=>new Date(x.day).toLocaleDateString()),f=w.map(x=>x.count),S={labels:m,datasets:[{label:"Reports (last 30 days)",data:f,fill:!0,borderColor:"rgba(13,110,253,1)",backgroundColor:"rgba(13,110,253,0.15)",tension:.25,pointRadius:2}]},v={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{display:!1}},y:{beginAtZero:!0}}},b={labels:["Draft","Submitted","Approved","Rejected"],datasets:[{data:[d.drafts||0,d.submitted||0,d.approved||0,d.rejected||0],backgroundColor:["#6c757d","#0d6efd","#198754","#dc3545"],borderWidth:0}]},N={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}};return r("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Admin Dashboard"}),e("p",{className:"text-secondary",children:"System-wide overview for administrators"}),r("div",{className:"d-flex flex-wrap gap-2 mb-3 admin-controls",children:[r("select",{className:"form-select form-select-sm",value:a,onChange:x=>s(Number(x.target.value)),children:[e("option",{value:7,children:"Last 7 days"}),e("option",{value:30,children:"Last 30 days"}),e("option",{value:90,children:"Last 90 days"})]}),e("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>l(),children:"Refresh"}),r("button",{type:"button",className:"btn btn-primary",onClick:()=>t("/users"),children:[e("i",{className:"bi bi-people me-2"}),"Manage Users"]}),r("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>t("/analytics"),children:[e("i",{className:"bi bi-graph-up me-2"}),"View Analytics"]}),r("button",{type:"button",className:"btn btn-outline-success",onClick:async()=>{try{const x=await T.export.reportsExcel({});Ie(x.data,`reports_${new Date().toISOString().slice(0,10)}.xlsx`)}catch{}},children:[e("i",{className:"bi bi-file-earmark-excel me-2"}),"Export Reports (Excel)"]}),r("button",{type:"button",className:"btn btn-outline-success",onClick:async()=>{try{const x=await T.export.usersExcel({});Ie(x.data,`users_${new Date().toISOString().slice(0,10)}.xlsx`)}catch{}},children:[e("i",{className:"bi bi-file-earmark-excel me-2"}),"Export Users (Excel)"]})]}),r("div",{className:"row g-3",children:[e("div",{className:"col-12 col-sm-6 col-lg-3",children:e(ze,{title:"Total Users",value:o.total_users,subtitle:`${o.active_users||0} active`})}),e("div",{className:"col-12 col-sm-6 col-lg-3",children:e(ze,{title:"Reports",value:d.total_reports,subtitle:`${d.submitted||0} submitted`})}),e("div",{className:"col-12 col-sm-6 col-lg-3",children:e(ze,{title:"Lecturers",value:o.lecturers,subtitle:`${o.students||0} students`})}),e("div",{className:"col-12 col-sm-6 col-lg-3",children:e(ze,{title:"Streams",value:u.length,subtitle:"Active streams"})})]}),r("div",{className:"row g-3 mt-1",children:[e("div",{className:"col-12 col-lg-8",children:r("div",{className:"card h-100",children:[e("div",{className:"card-header fw-semibold",children:"Reports Trend (30 days)"}),e("div",{className:"card-body",style:{height:280},children:e(Rt,{data:S,options:v})})]})}),e("div",{className:"col-12 col-lg-4",children:r("div",{className:"card h-100",children:[e("div",{className:"card-header fw-semibold",children:"Report Status"}),e("div",{className:"card-body",style:{height:280},children:e(ls,{data:b,options:N})})]})})]}),r("div",{className:"card mt-4",children:[e("div",{className:"card-header fw-semibold",children:"Streams Overview"}),e("div",{className:"table-responsive",children:r("table",{className:"table table-sm mb-0",children:[e("thead",{children:r("tr",{children:[e("th",{children:"Stream"}),e("th",{children:"Courses"}),e("th",{children:"Students"}),e("th",{children:"Lecturers"})]})}),r("tbody",{children:[u.map(x=>r("tr",{children:[e("td",{children:x.stream_name}),e("td",{children:x.courses}),e("td",{children:x.students}),e("td",{children:x.lecturers})]},x.id)),u.length===0&&e("tr",{children:e("td",{colSpan:4,className:"text-center text-muted",children:"No streams"})})]})]})})]}),r("div",{className:"card mt-4",children:[e("div",{className:"card-header fw-semibold",children:"Top Courses"}),e("div",{className:"table-responsive",children:r("table",{className:"table table-sm mb-0",children:[e("thead",{children:r("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Enrolled"}),e("th",{children:"Reports"}),e("th",{children:"Avg Rating"})]})}),r("tbody",{children:[h.map(x=>r("tr",{children:[e("td",{children:x.course_name}),e("td",{children:x.course_code}),e("td",{children:x.enrolled_students}),e("td",{children:x.report_count}),e("td",{children:x.avg_rating?Number(x.avg_rating).toFixed(1):"-"})]},x.id)),h.length===0&&e("tr",{children:e("td",{colSpan:5,className:"text-center text-muted",children:"No courses"})})]})]})})]}),r("div",{className:"card mt-4",children:[e("div",{className:"card-header fw-semibold",children:"Recent Users"}),e("div",{className:"table-responsive",children:r("table",{className:"table table-sm mb-0",children:[e("thead",{children:r("tr",{children:[e("th",{children:"ID"}),e("th",{children:"Username"}),e("th",{children:"Email"}),e("th",{children:"Role"}),e("th",{children:"Joined"})]})}),r("tbody",{children:[C.map(x=>r("tr",{children:[e("td",{children:x.id}),e("td",{children:x.username}),e("td",{children:x.email}),e("td",{children:e("span",{className:`admin-role-badge badge-role-${x.role}`,children:String(x.role).replace("_"," ")})}),e("td",{children:new Date(x.created_at).toLocaleString()})]},x.id)),C.length===0&&e("tr",{children:e("td",{colSpan:5,className:"text-center text-muted",children:"No users"})})]})]})})]}),r("div",{className:"text-secondary small mt-3",children:["Last updated: ",new Date((i==null?void 0:i.generatedAt)||Date.now()).toLocaleString()]})]})}function Ns(){var y,L;const[t,a]=te.useState(1),[s,i]=te.useState(25),[n,c]=te.useState(""),[l,o]=te.useState(""),[d,u]=te.useState(""),[h,C]=te.useState(""),{data:w,isLoading:m,error:f,refetch:S}=be(["admin-audit",t,s,n,l,d,h],async()=>{const x={page:t,limit:s};n&&(x.action=n),l&&(x.q=l),d&&(x.startDate=d),h&&(x.endDate=h);const F=await T.admin.getAudit(x);return(F==null?void 0:F.data)??F},{keepPreviousData:!0,refetchOnWindowFocus:!1}),v=(w==null?void 0:w.logs)||[],b=(w==null?void 0:w.pagination)||{page:1,pages:1,total:0,limit:s};return r("div",{className:"container py-4",children:[r("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[r("h2",{className:"mb-0",children:[e("i",{className:"bi bi-clipboard-data me-2"}),"Audit Logs"]}),r("div",{className:"d-flex gap-2",children:[e("input",{className:"form-control form-control-sm",style:{maxWidth:220},placeholder:"Search user/email",value:l,onChange:x=>{o(x.target.value),a(1)}}),r("select",{className:"form-select form-select-sm",value:n,onChange:x=>{c(x.target.value),a(1)},children:[e("option",{value:"",children:"All actions"}),e("option",{value:"activate",children:"activate"}),e("option",{value:"deactivate",children:"deactivate"}),e("option",{value:"delete",children:"delete"}),e("option",{value:"setRole",children:"setRole"})]}),e("input",{type:"date",className:"form-control form-control-sm",value:d,onChange:x=>{u(x.target.value),a(1)}}),e("input",{type:"date",className:"form-control form-control-sm",value:h,onChange:x=>{C(x.target.value),a(1)}}),r("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>S(),disabled:m,children:[e("i",{className:"bi bi-arrow-clockwise me-1"})," Refresh"]}),r("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>{const x=["When","User","Email","Action","TargetType","TargetIds","Meta"],F=v.map(I=>[I.created_at,I.username||`User #${I.user_id}`,I.email||"",I.action,I.target_type,Array.isArray(I.target_ids)?I.target_ids.join("|"):String(I.target_ids),I.meta?JSON.stringify(I.meta):"{}"]),Q=[x,...F].map(I=>I.map(K=>'"'+String(K).replaceAll('"','""')+'"').join(",")).join(`
`),E=new Blob([Q],{type:"text/csv;charset=utf-8;"}),$=window.URL.createObjectURL(E),D=document.createElement("a");D.href=$,D.download=`audit_logs_${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(D),D.click(),D.remove(),window.URL.revokeObjectURL($)},disabled:m||v.length===0,children:[e("i",{className:"bi bi-download me-1"})," Export CSV"]})]})]}),r("div",{className:"card",children:[e("div",{className:"table-responsive",children:r("table",{className:"table table-sm table-striped mb-0",children:[e("thead",{children:r("tr",{children:[e("th",{children:"When"}),e("th",{children:"User"}),e("th",{children:"Action"}),e("th",{children:"Target"}),e("th",{children:"Meta"})]})}),r("tbody",{children:[m&&e("tr",{children:e("td",{colSpan:5,className:"text-center py-4 text-muted",children:"Loading..."})}),f&&e("tr",{children:e("td",{colSpan:5,className:"text-danger",children:((L=(y=f==null?void 0:f.response)==null?void 0:y.data)==null?void 0:L.error)||"Failed to load audit logs"})}),!m&&!f&&v.length===0&&e("tr",{children:e("td",{colSpan:5,className:"text-center py-4 text-muted",children:"No audit logs found."})}),!m&&!f&&v.map(x=>r("tr",{children:[r("td",{children:[e("div",{children:new Date(x.created_at).toLocaleDateString()}),e("div",{className:"text-muted small",children:new Date(x.created_at).toLocaleTimeString()})]}),r("td",{children:[e("div",{className:"fw-semibold",children:x.username||"User #"+x.user_id}),e("div",{className:"text-muted small",children:x.email||""})]}),e("td",{children:e("span",{className:"badge bg-secondary text-uppercase",children:String(x.action)})}),r("td",{children:[e("div",{className:"small text-muted",children:x.target_type}),e("div",{className:"fw-semibold",children:Array.isArray(x.target_ids)?x.target_ids.join(", "):String(x.target_ids)})]}),e("td",{className:"small",children:e("code",{children:x.meta?JSON.stringify(x.meta):"{}"})})]},x.id))]})]})}),b.pages>1&&r("div",{className:"card-footer d-flex align-items-center justify-content-between",children:[r("div",{className:"text-muted small",children:["Page ",b.page," of ",b.pages,"  ",b.total," total"]}),r("div",{className:"d-flex align-items-center gap-2",children:[e("button",{className:"btn btn-sm btn-outline-secondary",disabled:b.page<=1,onClick:()=>a(x=>Math.max(1,x-1)),children:"Prev"}),e("button",{className:"btn btn-sm btn-outline-secondary",disabled:b.page>=b.pages,onClick:()=>a(x=>Math.min(b.pages,x+1)),children:"Next"}),r("select",{className:"form-select form-select-sm ms-2",style:{width:120},value:s,onChange:x=>{i(parseInt(x.target.value)),a(1)},children:[e("option",{value:10,children:"10 per page"}),e("option",{value:25,children:"25 per page"}),e("option",{value:50,children:"50 per page"})]})]})]})]})]})}Ue.register(gt,vt,bt,yt,wr,_r,Nt,Qt);function Cs(){var f,S;const[t,a]=te.useState(30),{data:s,isLoading:i,error:n,refetch:c}=be(["dashboard-analytics",t],()=>T.dashboard.getAnalytics(t),{onError:v=>{var b,N;P.error(((N=(b=v==null?void 0:v.response)==null?void 0:b.data)==null?void 0:N.error)||"Failed to load analytics")}}),l=(v,b)=>{try{return(getComputedStyle(document.documentElement).getPropertyValue(v)||"").trim()||b}catch{return b}},o=l("--brand","rgba(13,110,253,1)"),d=o.startsWith("#")?`${o}33`:"rgba(13,110,253,0.2)",u=l("--text","#111827"),h=l("--muted","#6b7280"),C=v=>{a(v)},w=async()=>{var v,b;try{const{data:N}=await T.export.analyticsExcel({days:t,responseType:"blob"});Ie(N,`analytics_${t}d.xlsx`)}catch(N){P.error(((b=(v=N==null?void 0:N.response)==null?void 0:v.data)==null?void 0:b.error)||"Failed to export analytics")}},m=async()=>{var v,b;try{const N={startDate:new Date(Date.now()-t*24*60*60*1e3).toISOString().split("T")[0]},{data:y}=await T.export.reportsPdf(N);Ie(y,`reports_${t}d.pdf`)}catch(N){P.error(((b=(v=N==null?void 0:N.response)==null?void 0:v.data)==null?void 0:b.error)||"Failed to export reports PDF")}};return i?e(_t,{}):r("div",{className:"container py-4",children:[e("h1",{className:"mb-4",children:"Analytics"}),r("div",{className:"d-flex flex-wrap justify-content-between align-items-center mb-3",children:[e("div",{className:"btn-group",role:"group","aria-label":"Time range",children:[7,30,90].map(v=>r("button",{className:`btn btn-sm ${t===v?"btn-primary":"btn-outline-primary"}`,onClick:()=>C(v),children:["Last ",v," days"]},v))}),r("div",{className:"d-flex gap-2 mt-2 mt-sm-0",children:[r("button",{className:"btn btn-outline-success btn-sm",onClick:w,children:[e("i",{className:"bi bi-file-earmark-excel me-1"})," Export Analytics (Excel)"]}),r("button",{className:"btn btn-outline-danger btn-sm",onClick:m,children:[e("i",{className:"bi bi-filetype-pdf me-1"})," Export Reports (PDF)"]})]})]}),n&&e(Z,{variant:"danger",children:((S=(f=n==null?void 0:n.response)==null?void 0:f.data)==null?void 0:S.error)||"Failed to load analytics"}),r(z,{className:"g-3",children:[e(k,{lg:6,children:r(_,{className:"h-100",children:[e(_.Header,{children:r("h6",{className:"m-0",children:[e("i",{className:"bi bi-graph-up me-2"}),"Report Trends (30 days)"]})}),e(_.Body,{children:Array.isArray(s==null?void 0:s.reportTrends)&&s.reportTrends.length>0?r(de,{children:[e(Rt,{data:{labels:s.reportTrends.map(v=>new Date(v.report_date).toLocaleDateString()),datasets:[{label:"Reports",data:s.reportTrends.map(v=>v.report_count),borderColor:o,backgroundColor:d,tension:.3},{label:"Approved",data:s.reportTrends.map(v=>v.approved_count),borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.2)",tension:.3}]},options:{responsive:!0,plugins:{legend:{position:"top",labels:{color:u}}},scales:{x:{ticks:{color:h},grid:{display:!1}},y:{beginAtZero:!0,ticks:{color:h},grid:{color:"rgba(100,116,139,0.2)"}}}}}),r("div",{className:"text-muted small mt-2",children:["Legend: ",e("span",{className:"text-primary",children:"Reports"})," vs ",e("span",{className:"text-success",children:"Approved"})," across selected time range."]})]}):e("div",{className:"text-muted",children:"No trend data"})})]})}),e(k,{lg:6,children:r(_,{className:"h-100",children:[e(_.Header,{children:r("h6",{className:"m-0",children:[e("i",{className:"bi bi-star-half me-2"}),"Rating Distribution"]})}),e(_.Body,{children:Array.isArray(s==null?void 0:s.ratingDistribution)&&s.ratingDistribution.length>0?r(de,{children:[e(ot,{data:{labels:s.ratingDistribution.map(v=>`Rating ${v.rating}`),datasets:[{label:"Count",data:s.ratingDistribution.map(v=>v.count),backgroundColor:"rgba(255, 206, 86, 0.6)",borderColor:"rgba(255, 206, 86, 1)",borderWidth:1}]},options:{responsive:!0,plugins:{legend:{labels:{color:u}}},scales:{x:{ticks:{color:h},grid:{display:!1}},y:{beginAtZero:!0,ticks:{color:h},grid:{color:"rgba(100,116,139,0.2)"}}}}}),e("div",{className:"text-muted small mt-2",children:"Legend: Bars show how many reports received each rating."})]}):e("div",{className:"text-muted",children:"No rating data"})})]})})]}),r(z,{className:"g-3 mt-1",children:[e(k,{lg:6,children:r(_,{className:"h-100",children:[e(_.Header,{children:r("h6",{className:"m-0",children:[e("i",{className:"bi bi-diagram-3 me-2"}),"Stream Performance"]})}),e(_.Body,{children:Array.isArray(s==null?void 0:s.streamPerformance)&&s.streamPerformance.length>0?r(de,{children:[e(ot,{data:{labels:s.streamPerformance.map(v=>v.stream_name),datasets:[{label:"Total Reports",data:s.streamPerformance.map(v=>v.total_reports),backgroundColor:d,borderColor:o,borderWidth:1},{label:"Approved Reports",data:s.streamPerformance.map(v=>v.approved_reports),backgroundColor:"rgba(75, 192, 192, 0.6)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]},options:{responsive:!0,plugins:{legend:{labels:{color:u}}},scales:{x:{ticks:{color:h},grid:{display:!1}},y:{beginAtZero:!0,ticks:{color:h},grid:{color:"rgba(100,116,139,0.2)"}}}}}),e("div",{className:"text-muted small mt-2",children:"Legend: Blue = Total Reports, Teal = Approved Reports per stream."})]}):e("div",{className:"text-muted",children:"No stream performance data"})})]})}),e(k,{lg:6,children:r(_,{className:"h-100",children:[e(_.Header,{children:r("h6",{className:"m-0",children:[e("i",{className:"bi bi-book me-2"}),"Course Popularity"]})}),e(_.Body,{children:Array.isArray(s==null?void 0:s.coursePopularity)&&s.coursePopularity.length>0?r(de,{children:[e(ot,{data:{labels:s.coursePopularity.map(v=>v.course_name),datasets:[{label:"Enrolled Students",data:s.coursePopularity.map(v=>v.enrolled_students),backgroundColor:"rgba(153, 102, 255, 0.6)",borderColor:"rgba(153, 102, 255, 1)",borderWidth:1},{label:"Avg Rating",data:s.coursePopularity.map(v=>Number(v.avg_rating||0)),backgroundColor:"rgba(255, 159, 64, 0.6)",borderColor:"rgba(255, 159, 64, 1)",borderWidth:1}]},options:{responsive:!0,plugins:{legend:{labels:{color:u}}},scales:{x:{ticks:{color:h},grid:{display:!1}},y:{beginAtZero:!0,ticks:{color:h},grid:{color:"rgba(100,116,139,0.2)"}}}}}),e("div",{className:"text-muted small mt-2",children:"Legend: Purple = Enrolled Students, Orange = Average Rating per course."})]}):e("div",{className:"text-muted",children:"No course data"})})]})})]})]})}function Ss(){return e("div",{className:"container d-flex align-items-center justify-content-center",style:{minHeight:"70vh"},children:e("div",{className:"text-center",style:{maxWidth:560},children:r("div",{className:"card-modern p-4 mb-3",children:[e("div",{className:"display-3 fw-bold",style:{background:"linear-gradient(135deg, var(--brand), #6f42c1)",WebkitBackgroundClip:"text",backgroundClip:"text",WebkitTextFillColor:"transparent"},children:"404"}),e("h3",{className:"fw-semibold",children:"Page not found"}),e("p",{className:"text-muted mb-4",children:"The page you are looking for doesn't exist or has been moved."}),r("div",{className:"d-flex gap-2 justify-content-center",children:[r(M,{to:"/",className:"btn btn-primary",children:[e("i",{className:"bi bi-house-door me-2"}),"Go Home"]}),r(M,{to:"/reports",className:"btn btn-outline-secondary",children:[e("i",{className:"bi bi-file-text me-2"}),"View Reports"]})]})]})})})}function ws(){const{isAuthenticated:t,user:a}=ye();return t&&(a==null?void 0:a.role)==="admin"?e(pr,{}):e(os,{})}function _s(){const[t,a]=p.useState(null),[s,i]=p.useState(!0),[n,c]=p.useState("");if(p.useEffect(()=>{(async()=>{var u,h;try{i(!0);const{data:C}=await T.dashboard.getPersonal();a(C)}catch(C){const w=((h=(u=C==null?void 0:C.response)==null?void 0:u.data)==null?void 0:h.error)||"Failed to load progress";c(w),P.error(w)}finally{i(!1)}})()},[]),s)return e("div",{className:"container py-4",children:e(se,{})});if(n)return e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:n})});const l=(t==null?void 0:t.courses)||[],o=(t==null?void 0:t.personalStats)||{};return r("div",{className:"container py-4",children:[r("h2",{className:"mb-3",children:[e("i",{className:"bi bi-graph-up-arrow me-2"}),"My Progress"]}),r(z,{className:"g-3 mb-3",children:[e(k,{md:3,children:e(_,{className:"h-100",children:r(_.Body,{children:[e("div",{className:"text-muted small",children:"My Reports"}),e("div",{className:"display-6",children:o.my_reports||0})]})})}),e(k,{md:3,children:e(_,{className:"h-100",children:r(_.Body,{children:[e("div",{className:"text-muted small",children:"Pending (Submitted)"}),e("div",{className:"display-6",children:o.pending_reports||0})]})})}),e(k,{md:3,children:e(_,{className:"h-100",children:r(_.Body,{children:[e("div",{className:"text-muted small",children:"Enrolled Courses"}),e("div",{className:"display-6",children:o.enrolled_courses||l.length||0})]})})}),e(k,{md:3,children:e(_,{className:"h-100",children:r(_.Body,{children:[e("div",{className:"text-muted small",children:"Avg Class Rating"}),e("div",{className:"display-6",children:o.avg_class_rating?Number(o.avg_class_rating).toFixed(1):"N/A"})]})})})]}),r(_,{children:[e(_.Header,{children:e("strong",{children:"Course Progress"})}),e(_.Body,{children:l.length===0?e("div",{className:"text-muted",children:"No courses found"}):e(z,{className:"g-3",children:l.map(d=>e(k,{md:6,children:e(_,{className:"h-100",children:r(_.Body,{children:[r("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[r("div",{children:[r("div",{className:"fw-bold",children:[d.course_name," ",d.course_code?`(${d.course_code})`:""]}),r("div",{className:"text-muted small",children:["Stream: ",d.stream_name||"N/A"]})]}),r("div",{className:"text-muted small",children:["Sem ",d.semester||"-"]})]}),e(xr,{now:Number(d.completion_percentage||0),label:`${Number(d.completion_percentage||0)}%`})]})})},d.id))})})]})]})}function xs(){var m,f,S;const[t,a]=te.useState(1),[s,i]=te.useState(15),{data:n,isLoading:c,error:l,refetch:o}=be(["notifications-page",t,s],async()=>{const v=await T.dashboard.getNotifications({page:t,limit:s});return(v==null?void 0:v.data)??v},{refetchInterval:3e4}),d=(n==null?void 0:n.notifications)||[],u=(n==null?void 0:n.pagination)||{page:1,pages:1,total:0,limit:s},h=d.filter(v=>!v.read).length,C=async(v,b)=>{var N,y;try{await T.dashboard.markNotificationRead(v,b),o()}catch(L){P.error(((y=(N=L==null?void 0:L.response)==null?void 0:N.data)==null?void 0:y.error)||"Failed to mark as read")}};return r("div",{className:"container py-4",children:[r("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[r("h2",{className:"mb-0",children:[e("i",{className:"bi bi-bell me-2"}),"Notifications"]}),r("div",{className:"d-flex gap-2",children:[r("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>o(),disabled:c,children:[e("i",{className:"bi bi-arrow-clockwise me-1"})," Refresh"]}),r("button",{className:"btn btn-sm btn-outline-success",onClick:async()=>{var v,b;try{await T.dashboard.markAllNotificationsRead(),o()}catch(N){P.error(((b=(v=N==null?void 0:N.response)==null?void 0:v.data)==null?void 0:b.error)||"Failed to mark all as read")}},disabled:c||h===0&&(((m=n==null?void 0:n.pagination)==null?void 0:m.total)||0)===0,children:[e("i",{className:"bi bi-check2-all me-1"})," Mark all read"]}),r(M,{to:"/",className:"btn btn-sm btn-outline-primary",children:[e("i",{className:"bi bi-speedometer2 me-1"})," Dashboard"]})]})]}),r("div",{className:"card",children:[r("div",{className:"card-body",children:[c&&e("div",{className:"text-muted",children:"Loading notifications..."}),l&&e("div",{className:"alert alert-danger",children:((S=(f=l==null?void 0:l.response)==null?void 0:f.data)==null?void 0:S.error)||"Failed to load notifications"}),!c&&!l&&d.length===0&&e("div",{className:"text-muted",children:"No notifications found."}),!c&&!l&&d.length>0&&e("div",{className:"list-group list-group-flush",children:d.map(v=>r("div",{className:`list-group-item d-flex align-items-start gap-3 ${v.read?"":"bg-light"}`,children:[e("div",{className:"text-primary",children:v.type==="feedback"?e("i",{className:"bi bi-chat-left-text"}):e("i",{className:"bi bi-file-earmark-text"})}),r("div",{className:"flex-grow-1",children:[e("div",{className:"fw-semibold",children:v.title||"Notification"}),e("div",{className:"text-muted small",children:v.message})]}),e("div",{className:"text-nowrap small text-muted",children:v.created_at?new Date(v.created_at).toLocaleString():""}),!v.read&&e("div",{children:e("button",{className:"btn btn-sm btn-outline-success",onClick:()=>C(v.type,v.id),title:"Mark as read",children:e("i",{className:"bi bi-check2"})})})]},`${v.type}-${v.id}`))})]}),u.pages>1&&r("div",{className:"card-footer d-flex align-items-center justify-content-between",children:[r("div",{className:"text-muted small",children:["Page ",u.page," of ",u.pages,"  ",u.total," total"]}),r("div",{className:"d-flex align-items-center gap-2",children:[e("button",{className:"btn btn-sm btn-outline-secondary",disabled:u.page<=1,onClick:()=>a(v=>Math.max(1,v-1)),children:"Prev"}),e("button",{className:"btn btn-sm btn-outline-secondary",disabled:u.page>=u.pages,onClick:()=>a(v=>Math.min(u.pages,v+1)),children:"Next"}),r("select",{className:"form-select form-select-sm ms-2",style:{width:120},value:s,onChange:v=>{i(parseInt(v.target.value)),a(1)},children:[e("option",{value:10,children:"10 per page"}),e("option",{value:15,children:"15 per page"}),e("option",{value:25,children:"25 per page"})]})]})]})]})]})}function Rs(){var C,w;const[t,a]=te.useState(1),[s,i]=te.useState(10),{data:n,isLoading:c,error:l,refetch:o}=be(["pending-actions",t,s],async()=>{const m=await T.dashboard.getPending({page:t,limit:s});return(m==null?void 0:m.data)??m},{keepPreviousData:!0,refetchOnWindowFocus:!1}),d=(n==null?void 0:n.items)||[],u=(n==null?void 0:n.pagination)||{page:1,pages:1,total:0,limit:s},h=async(m,f)=>{var S,v;try{await T.reports.moderate(m,f),P.success("Updated"),o()}catch(b){P.error(((v=(S=b==null?void 0:b.response)==null?void 0:S.data)==null?void 0:v.error)||"Failed to update")}};return r("div",{className:"container py-4",children:[r("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[r("h2",{className:"mb-0",children:[e("i",{className:"bi bi-inbox me-2"}),"Pending Actions"]}),r("div",{className:"d-flex gap-2",children:[r("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>o(),disabled:c,children:[e("i",{className:"bi bi-arrow-clockwise me-1"})," Refresh"]}),r(M,{to:"/reports",className:"btn btn-sm btn-outline-primary",children:[e("i",{className:"bi bi-file-text me-1"})," Reports"]})]})]}),e(_,{children:r(_.Body,{className:"p-0",children:[c&&e("div",{className:"text-center py-5 text-muted",children:"Loading..."}),l&&e("div",{className:"alert alert-danger m-3",children:((w=(C=l==null?void 0:l.response)==null?void 0:C.data)==null?void 0:w.error)||"Failed to load pending actions"}),!c&&!l&&d.length===0&&e("div",{className:"text-center py-5 text-muted",children:"No pending items."}),!c&&!l&&d.length>0&&r(de,{children:[r(le,{responsive:!0,hover:!0,className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Title"}),e("th",{children:"Reporter"}),e("th",{children:"Course"}),e("th",{children:"Type"}),e("th",{children:"Created"}),e("th",{children:"Actions"})]})}),e("tbody",{children:d.map(m=>r("tr",{children:[e("td",{children:e("div",{className:"fw-semibold",children:m.title})}),r("td",{children:[m.first_name," ",m.last_name,e("div",{className:"text-muted small",children:String(m.reporter_role).replace("_"," ")})]}),e("td",{children:m.course_name||"N/A"}),e("td",{children:String(m.report_type).replace("_"," ")}),r("td",{children:[e("div",{children:new Date(m.created_at).toLocaleDateString()}),e("small",{className:"text-muted",children:new Date(m.created_at).toLocaleTimeString()})]}),e("td",{children:r("div",{className:"d-flex gap-1",children:[e(M,{to:`/reports/${m.id}`,className:"btn btn-sm btn-outline-primary",title:"View",children:e("i",{className:"bi bi-eye"})}),e("button",{className:"btn btn-sm btn-outline-success",onClick:()=>h(m.id,{status:"approved"}),title:"Approve",children:e("i",{className:"bi bi-check2-circle"})}),e("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>h(m.id,{status:"reviewed"}),title:"Mark Reviewed",children:e("i",{className:"bi bi-eye"})}),e("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>h(m.id,{status:"rejected"}),title:"Reject",children:e("i",{className:"bi bi-x-circle"})})]})})]},m.id))})]}),r("div",{className:"p-3 border-top d-flex align-items-center justify-content-between",children:[r("div",{className:"text-muted small",children:["Page ",u.page," of ",u.pages,"  ",u.total," total"]}),r("div",{className:"d-flex align-items-center gap-2",children:[e("button",{className:"btn btn-sm btn-outline-secondary",disabled:u.page<=1,onClick:()=>a(m=>Math.max(1,m-1)),children:"Prev"}),e("button",{className:"btn btn-sm btn-outline-secondary",disabled:u.page>=u.pages,onClick:()=>a(m=>Math.min(u.pages,m+1)),children:"Next"}),r("select",{className:"form-select form-select-sm ms-2",style:{width:120},value:s,onChange:m=>{i(parseInt(m.target.value)),a(1)},children:[e("option",{value:10,children:"10 per page"}),e("option",{value:20,children:"20 per page"}),e("option",{value:50,children:"50 per page"})]})]})]})]})]})})]})}function As(){const[t,a]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState({}),[l,o]=p.useState([]),[d,u]=p.useState([]);return p.useEffect(()=>{(async()=>{var C,w;try{a(!0);const{data:m}=await T.dashboard.getPersonal();c((m==null?void 0:m.personalStats)||{}),o((m==null?void 0:m.courses)||[]),u((m==null?void 0:m.recentReports)||[])}catch(m){i(((w=(C=m==null?void 0:m.response)==null?void 0:C.data)==null?void 0:w.error)||"Failed to load monitoring data")}finally{a(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):r("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Student Monitoring"}),r(z,{children:[e(k,{md:4,children:r(_,{className:"mb-3",children:[e(_.Header,{children:e("strong",{children:"My Stats"})}),e(_.Body,{children:r("div",{className:"d-flex flex-column gap-2",children:[r("div",{children:[e("strong",{children:"My Reports:"})," ",n.my_reports??0]}),r("div",{children:[e("strong",{children:"Pending Reports:"})," ",n.pending_reports??0]}),r("div",{children:[e("strong",{children:"Enrolled Courses:"})," ",n.enrolled_courses??0]}),r("div",{children:[e("strong",{children:"Avg Class Rating:"})," ",Number(n.avg_class_rating||0).toFixed(1)]})]})})]})}),e(k,{md:8,children:r(_,{className:"mb-3",children:[e(_.Header,{children:e("strong",{children:"My Courses"})}),e(_.Body,{children:l.length===0?e("div",{className:"text-muted",children:"No enrolled courses found"}):r(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Completion"})]})}),e("tbody",{children:l.map(h=>r("tr",{children:[e("td",{children:h.course_name}),e("td",{children:h.course_code}),e("td",{children:h.stream_name}),e("td",{children:r(ue,{bg:"info",children:[h.completion_percentage??0,"%"]})})]},h.id))})]})})]})})]}),r(_,{children:[e(_.Header,{children:e("strong",{children:"My Recent Reports"})}),e(_.Body,{children:d.length===0?e("div",{className:"text-muted",children:"No recent reports"}):r(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Title"}),e("th",{children:"Status"}),e("th",{children:"Date"})]})}),e("tbody",{children:d.map(h=>r("tr",{children:[e("td",{children:h.title}),e("td",{children:h.status}),e("td",{children:new Date(h.created_at).toLocaleString()})]},h.id))})]})})]})]})}function Ls(){const[t,a]=p.useState([]),[s,i]=p.useState([]),[n,c]=p.useState(!0),[l,o]=p.useState(!1),[d,u]=p.useState(""),[h,C]=p.useState({courseId:"",lecturerId:"",rating:"5",comments:"",classDate:new Date().toISOString().split("T")[0],academicYear:String(new Date().getFullYear()),semester:"1"});p.useEffect(()=>{(async()=>{var S,v,b;try{c(!0);const{data:N}=await T.dashboard.getPersonal();let y=(N==null?void 0:N.courses)||[];if(!Array.isArray(y)||y.length===0)try{const x=await T.users.getAvailableCourses();y=Array.isArray((S=x.data)==null?void 0:S.courses)?x.data.courses:Array.isArray(x.data)?x.data:[]}catch{}const L=(y||[]).map(x=>({id:x.id??x.course_id??x.courseId,course_name:x.course_name??x.name??x.title??"Untitled",course_code:x.course_code??x.code??""})).filter(x=>x.id!=null);a(L)}catch(N){u(((b=(v=N==null?void 0:N.response)==null?void 0:v.data)==null?void 0:b.error)||"Failed to load courses")}finally{c(!1)}})()},[]),p.useEffect(()=>{(async()=>{var S;try{if(!h.courseId){i([]);return}const{data:v}=await T.users.getLecturersByCourse(h.courseId);let b=Array.isArray(v==null?void 0:v.lecturers)?v.lecturers:[];if(b.length===0)try{const y=await T.users.getAll({role:"lecturer",limit:200});b=Array.isArray((S=y.data)==null?void 0:S.users)?y.data.users:Array.isArray(y.data)?y.data:[]}catch{}const N=b.map(y=>({id:y.id,first_name:y.first_name??y.firstName??"",last_name:y.last_name??y.lastName??""})).filter(y=>y.id!=null);i(N)}catch{i([])}})()},[h.courseId]);const w=f=>{const{name:S,value:v}=f.target;C(b=>({...b,[S]:v}))},m=async f=>{var v,b;if(f.preventDefault(),!h.courseId){P.error("Please select a course");return}if(!h.lecturerId){P.error("Please select a lecturer");return}const S=t.find(N=>String(N.id)===String(h.courseId));if(S!=null&&S.my_rating){P.error("You have already rated this course.");return}try{o(!0),await T.users.rateClass({courseId:Number(h.courseId),lecturerId:Number(h.lecturerId),rating:Number(h.rating),comment:h.comments,classDate:h.classDate,academicYear:h.academicYear,semester:Number(h.semester)}),P.success("Thank you for your rating"),C(N=>({...N,comments:""}))}catch(N){P.error(((b=(v=N==null?void 0:N.response)==null?void 0:v.data)==null?void 0:b.error)||"Failed to submit rating")}finally{o(!1)}};return n?e("div",{className:"container py-4",children:e(se,{})}):d?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:d})}):r("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Rate a Class"}),e(_,{children:e(_.Body,{children:r(g,{onSubmit:m,children:[r(z,{className:"mb-3",children:[e(k,{md:6,children:r(g.Group,{children:[e(g.Label,{children:"Course"}),r(g.Select,{name:"courseId",value:h.courseId,onChange:w,children:[e("option",{value:"",children:"Select course"}),t.map(f=>r("option",{value:f.id,children:[f.course_name," (",f.course_code,")"]},f.id))]})]})}),e(k,{md:6,children:r(g.Group,{children:[e(g.Label,{children:"Lecturer"}),r(g.Select,{name:"lecturerId",value:h.lecturerId,onChange:w,disabled:!h.courseId,children:[e("option",{value:"",children:h.courseId?"Select lecturer":"Select a course first"}),s.map(f=>r("option",{value:f.id,children:[f.first_name," ",f.last_name]},f.id))]})]})})]}),r(z,{className:"mb-3",children:[e(k,{md:4,children:r(g.Group,{children:[e(g.Label,{children:"Rating"}),e(g.Select,{name:"rating",value:h.rating,onChange:w,children:[5,4,3,2,1].map(f=>e("option",{value:f,children:f},f))})]})}),e(k,{md:4,children:r(g.Group,{children:[e(g.Label,{children:"Class Date"}),e(g.Control,{type:"date",name:"classDate",value:h.classDate,onChange:w})]})}),e(k,{md:2,children:r(g.Group,{children:[e(g.Label,{children:"Year"}),e(g.Control,{name:"academicYear",value:h.academicYear,onChange:w})]})}),e(k,{md:2,children:r(g.Group,{children:[e(g.Label,{children:"Semester"}),e(g.Select,{name:"semester",value:h.semester,onChange:w,children:[1,2,3,4,5,6,7,8].map(f=>e("option",{value:f,children:f},f))})]})})]}),r(g.Group,{className:"mb-3",children:[e(g.Label,{children:"Comments (optional)"}),e(g.Control,{as:"textarea",rows:3,name:"comments",value:h.comments,onChange:w})]}),e("div",{className:"d-flex justify-content-end",children:e(H,{type:"submit",variant:"success",disabled:l,children:l?"Submitting...":"Submit Rating"})})]})})}),r(_,{className:"mt-3",children:[e(_.Header,{children:e("strong",{children:"My Ratings"})}),e(_.Body,{children:t.filter(f=>f.my_rating).length===0?e("div",{className:"text-muted",children:"You have not rated any courses yet."}):e(z,{className:"g-2",children:t.filter(f=>f.my_rating).map(f=>e(k,{md:6,children:r("div",{className:"p-3 border rounded d-flex justify-content-between align-items-center",children:[r("div",{children:[r("div",{className:"fw-semibold",children:[f.course_name," ",f.course_code?`(${f.course_code})`:""]}),e("div",{className:"text-muted small",children:"Your rating:"})]}),e("div",{title:`${Number(f.my_rating).toFixed(1)} / 5`,children:[1,2,3,4,5].map(S=>e("i",{className:`bi ${S<=Math.round(f.my_rating)?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:16,marginLeft:2}},S))})]})},f.id))})})]})]})}function ks({show:t,onHide:a,onSubmit:s,initial:i={},lecturers:n=[]}){const[c,l]=p.useState(i.rating||0),[o,d]=p.useState(i.comment||""),[u,h]=p.useState(i.academicYear||String(new Date().getFullYear())),[C,w]=p.useState(i.semester||1),[m,f]=p.useState(i.lecturerId||""),S=b=>{l(b)},v=b=>{b.preventDefault(),c&&(n.length>0&&!m||s({rating:c,comment:o,academicYear:u,semester:C,lecturerId:m?Number(m):void 0}))};return r(Te,{show:t,onHide:a,centered:!0,scrollable:!0,children:[e(Te.Header,{closeButton:!0,children:e(Te.Title,{children:"Rate this class"})}),r(g,{onSubmit:v,children:[r(Te.Body,{children:[n.length>0&&e("div",{className:"row g-3 mb-3",children:e("div",{className:"col-12",children:r(g.Group,{children:[e(g.Label,{children:"Lecturer"}),r(g.Select,{value:m,onChange:b=>f(b.target.value),children:[e("option",{value:"",children:"Select lecturer"}),n.map(b=>r("option",{value:b.id,children:[b.first_name," ",b.last_name]},b.id))]})]})})}),e("div",{className:"d-flex align-items-center mb-3",role:"group","aria-label":"Star rating",children:[1,2,3,4,5].map(b=>e("i",{className:`bi ${b<=c?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:28,cursor:"pointer",marginRight:6},onClick:()=>S(b),"aria-label":`${b} star`},b))}),r("div",{className:"row g-3 mb-3",children:[e("div",{className:"col-md-6",children:r(g.Group,{children:[e(g.Label,{children:"Academic Year"}),e(g.Control,{value:u,onChange:b=>h(b.target.value)})]})}),e("div",{className:"col-md-6",children:r(g.Group,{children:[e(g.Label,{children:"Semester"}),e(g.Select,{value:C,onChange:b=>w(Number(b.target.value)),children:[1,2,3,4,5,6,7,8].map(b=>e("option",{value:b,children:b},b))})]})})]}),r(g.Group,{children:[e(g.Label,{children:"Comments (optional)"}),e(g.Control,{as:"textarea",rows:3,value:o,onChange:b=>d(b.target.value),placeholder:"What went well? What could improve?"})]})]}),r(Te.Footer,{children:[e(H,{variant:"secondary",onClick:a,children:"Cancel"}),e(H,{variant:"primary",type:"submit",disabled:!c,children:"Submit Rating"})]})]})]})}function Ps(){const[t,a]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]),[l,o]=p.useState(null),[d,u]=p.useState([]),h=async()=>{var w,m,f;try{a(!0),i("");const{data:S}=await T.dashboard.getPersonal();let v=(S==null?void 0:S.courses)||[];if(!Array.isArray(v)||v.length===0)try{const N=await T.users.getAvailableCourses();v=Array.isArray((w=N.data)==null?void 0:w.courses)?N.data.courses:Array.isArray(N.data)?N.data:[]}catch{}const b=(v||[]).map(N=>({id:N.id??N.course_id??N.courseId,course_name:N.course_name??N.name??N.title??"Untitled",course_code:N.course_code??N.code??"",stream_name:N.stream_name??N.stream??"",student_count:N.student_count??N.students??void 0,my_rating:N.my_rating??N.rating??void 0})).filter(N=>N.id!=null);c(b)}catch(S){i(((f=(m=S==null?void 0:S.response)==null?void 0:m.data)==null?void 0:f.error)||"Failed to load classes")}finally{a(!1)}};p.useEffect(()=>{h()},[]);const C=async({rating:w,comment:m,academicYear:f,semester:S,lecturerId:v})=>{var b,N;if(l){if(!v){P.error("Please select a lecturer");return}try{await T.users.rateClass({courseId:l.id,rating:Number(w),comments:m||void 0,academicYear:f||String(new Date().getFullYear()),semester:Number(S||1),lecturerId:Number(v),classDate:new Date().toISOString().split("T")[0]}),P.success("Thank you for your rating"),o(null),h()}catch(y){P.error(((N=(b=y==null?void 0:y.response)==null?void 0:b.data)==null?void 0:N.error)||"Failed to submit rating")}}};return p.useEffect(()=>{(async()=>{if(!(l!=null&&l.id)){u([]);return}try{const{data:m}=await T.users.getLecturersByCourse(l.id),f=Array.isArray(m==null?void 0:m.lecturers)?m.lecturers:[],S=new Set,v=f.filter(b=>{const N=b.id;return S.has(N)?!1:(S.add(N),!0)});u(v)}catch{u([])}})()},[l]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):r("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"My Classes"}),e(_,{children:e(_.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No classes to show."}):r(le,{responsive:!0,hover:!0,children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Lecturer"}),e("th",{children:"Your Rating"}),e("th",{children:"Actions"})]})}),e("tbody",{children:n.map(w=>r("tr",{children:[e("td",{children:w.course_name}),e("td",{children:w.course_code}),e("td",{children:w.lecturer_name||w.lecturer||""}),e("td",{children:w.my_rating?e("span",{title:`${Number(w.my_rating).toFixed(1)} / 5`,children:[1,2,3,4,5].map(m=>e("i",{className:`bi ${m<=Math.round(w.my_rating)?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:14,marginRight:2}},m))}):e("span",{className:"text-muted",children:"Not rated"})}),e("td",{children:e(H,{size:"sm",variant:"outline-primary",onClick:()=>o(w),disabled:!!w.my_rating,children:w.my_rating?"Rated":"Rate"})})]},w.id))})]})})}),e(ks,{show:!!l,onHide:()=>o(null),onSubmit:C,initial:{rating:(l==null?void 0:l.my_rating)||0,comment:""},lecturers:d})]})}function Fs(){const t=at(),a=p.useRef(null),[s,i]=p.useState([]),[n,c]=p.useState([]),[l,o]=p.useState([]),[d,u]=p.useState(""),[h,C]=p.useState(""),[w,m]=p.useState(""),[f,S]=p.useState(!0),[v,b]=p.useState(""),[N,y]=p.useState({lecturerId:"",courseId:"",academicYear:new Date().getFullYear().toString(),semester:1}),L=async()=>{var E,$,D,I,K;try{S(!0),b("");const[V,R,B]=await Promise.all([T.users.getAll({limit:100}),T.users.getAvailableCourses({all:!0}),T.users.getStreams()]),X=(Array.isArray(V.data)?V.data:((E=V.data)==null?void 0:E.users)||[]).filter(me=>(me.role||me.role_name)==="lecturer"||me.role==="lecturer");i(X);const ne=Array.isArray(($=R.data)==null?void 0:$.courses)?R.data.courses:Array.isArray(R.data)?R.data:[];c(ne);const ae=Array.isArray((D=B.data)==null?void 0:D.streams)?B.data.streams:Array.isArray(B.data)?B.data:[];o(ae)}catch(V){const R=((K=(I=V==null?void 0:V.response)==null?void 0:I.data)==null?void 0:K.error)||"Failed to load data";b(R),P.error(R)}finally{S(!1)}};p.useEffect(()=>{L()},[]),p.useEffect(()=>{(async()=>{var $;try{S(!0);const D=d?{stream_id:d,all:!0}:{all:!0},I=await T.users.getAvailableCourses(D),K=Array.isArray(($=I.data)==null?void 0:$.courses)?I.data.courses:Array.isArray(I.data)?I.data:[];c(K)}catch{}finally{S(!1)}})()},[d]);const x=p.useMemo(()=>{const E=h.trim().toLowerCase();return E?s.filter($=>[$.firstName,$.first_name,$.lastName,$.last_name,$.email].filter(Boolean).some(D=>String(D).toLowerCase().includes(E))):s},[s,h]),F=p.useMemo(()=>{const E=w.trim().toLowerCase();return E?n.filter($=>[$.course_name,$.course_code,$.name,$.title].filter(Boolean).some(D=>String(D).toLowerCase().includes(E))):n},[n,w]);p.useEffect(()=>{const E=new URLSearchParams(t.search),$=E.get("courseId");E.get("mode"),$&&(y(D=>({...D,courseId:String($)})),setTimeout(()=>{var D;return(D=a.current)==null?void 0:D.scrollIntoView({behavior:"smooth",block:"start"})},0))},[t.search]);const Q=async E=>{var $,D;if(E.preventDefault(),!N.lecturerId||!N.courseId){P.error("Please select a lecturer and a course");return}try{await T.users.assignCourse(N.lecturerId,{courseId:Number(N.courseId),academicYear:N.academicYear,semester:Number(N.semester)}),P.success("Course assigned to lecturer"),y({...N,courseId:""})}catch(I){const K=((D=($=I==null?void 0:I.response)==null?void 0:$.data)==null?void 0:D.error)||"Failed to assign course";P.error(K)}};return f?e("div",{className:"container py-4",children:e(se,{})}):v?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:v})}):r("div",{className:"container py-4",children:[r("h2",{className:"mb-3",children:[e("i",{className:"bi bi-person-workspace me-2"}),"Assign Modules"]}),new URLSearchParams(t.search).get("mode")==="add"&&r(_,{className:"mb-3",children:[e(_.Header,{children:e("strong",{children:"Add Module (Course)"})}),e(_.Body,{children:e(AddCourseForm,{streams:l,onCreated:E=>{c($=>[E,...$]),y($=>({...$,courseId:String(E.id)})),P.success("Module created and selected"),setTimeout(()=>{var $;return($=a.current)==null?void 0:$.scrollIntoView({behavior:"smooth",block:"start"})},0)}})})]}),r(_,{children:[e(_.Header,{children:e("strong",{children:"Assign Course to Lecturer"})}),e(_.Body,{ref:a,children:r(g,{onSubmit:Q,children:[r(z,{className:"g-3",children:[e(k,{md:6,children:r(g.Group,{children:[e(g.Label,{children:"Stream (optional)"}),r(g.Select,{value:d,onChange:E=>u(E.target.value),children:[e("option",{value:"",children:"All streams"}),l.map(E=>r("option",{value:E.id,children:[E.stream_name," ",E.stream_code?`(${E.stream_code})`:""]},E.id))]})]})}),e(k,{md:6,children:r(g.Group,{children:[e(g.Label,{children:"Lecturer"}),e(g.Control,{placeholder:"Search lecturer...",className:"mb-2",value:h,onChange:E=>C(E.target.value)}),r(g.Select,{value:N.lecturerId,onChange:E=>y({...N,lecturerId:E.target.value}),children:[e("option",{value:"",children:"Select lecturer"}),x.map(E=>r("option",{value:E.id,children:[E.firstName||E.first_name||""," ",E.lastName||E.last_name||"","  ",E.email]},E.id))]})]})}),e(k,{md:6,children:r(g.Group,{children:[e(g.Label,{children:"Course"}),e(g.Control,{placeholder:"Search course...",className:"mb-2",value:w,onChange:E=>m(E.target.value)}),r(g.Select,{value:N.courseId,onChange:E=>y({...N,courseId:E.target.value}),children:[e("option",{value:"",children:"Select course"}),F.map(E=>r("option",{value:E.id,children:[E.course_name," ",E.course_code?`(${E.course_code})`:""]},E.id))]})]})})]}),r(z,{className:"g-3 mt-1",children:[e(k,{md:6,children:r(g.Group,{children:[e(g.Label,{children:"Academic Year"}),e(g.Control,{value:N.academicYear,onChange:E=>y({...N,academicYear:E.target.value})})]})}),e(k,{md:6,children:r(g.Group,{children:[e(g.Label,{children:"Semester"}),e(g.Select,{value:N.semester,onChange:E=>y({...N,semester:E.target.value}),children:[1,2,3,4,5,6,7,8].map(E=>e("option",{value:E,children:E},E))})]})})]}),e("div",{className:"mt-3 d-flex justify-content-end",children:e(H,{type:"submit",variant:"primary",children:"Assign"})})]})})]})]})}function Es(){const[t,a]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]);return p.useEffect(()=>{(async()=>{var o,d;try{a(!0);const{data:u}=await T.dashboard.getPersonal();c((u==null?void 0:u.courses)||[])}catch(u){i(((d=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:d.error)||"Failed to load classes")}finally{a(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):r("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"My Classes"}),e(_,{children:e(_.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No assigned courses."}):r(le,{responsive:!0,hover:!0,className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"}),e("th",{children:"Avg Rating"}),e("th",{children:"Actions"})]})}),e("tbody",{children:n.map(l=>r("tr",{children:[e("td",{children:l.course_name}),e("td",{children:l.course_code}),e("td",{children:l.stream_name}),e("td",{children:e(ue,{bg:"secondary",children:l.student_count??0})}),e("td",{children:l.avg_rating?e("span",{title:`${Number(l.avg_rating).toFixed(1)} / 5`,children:[1,2,3,4,5].map(o=>e("i",{className:`bi ${o<=Math.round(l.avg_rating)?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:14,marginRight:2}},o))}):e("span",{className:"text-muted",children:"N/A"})}),e("td",{children:r(M,{to:"/reports/lecturer/new",className:"btn btn-sm btn-outline-primary",children:[e("i",{className:"bi bi-journal-plus me-1"}),"New Report"]})})]},l.id))})]})})})]})}function Is(){const[t,a]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState({}),[l,o]=p.useState([]),[d,u]=p.useState([]);return p.useEffect(()=>{(async()=>{var C,w;try{a(!0);const{data:m}=await T.dashboard.getPersonal();c((m==null?void 0:m.personalStats)||{}),o((m==null?void 0:m.courses)||[]),u((m==null?void 0:m.pendingActions)||[])}catch(m){i(((w=(C=m==null?void 0:m.response)==null?void 0:C.data)==null?void 0:w.error)||"Failed to load monitoring data")}finally{a(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):r("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Lecturer Monitoring"}),r(z,{children:[e(k,{md:4,children:r(_,{className:"mb-3",children:[e(_.Header,{children:e("strong",{children:"My Stats"})}),e(_.Body,{children:r("div",{className:"d-flex flex-column gap-2",children:[r("div",{children:[e("strong",{children:"My Courses:"})," ",n.my_courses??0]}),r("div",{children:[e("strong",{children:"My Reports:"})," ",n.my_reports??0]}),r("div",{children:[e("strong",{children:"Total Students:"})," ",n.total_students??0]}),r("div",{children:[e("strong",{children:"Avg Received Rating:"})," ",Number(n.avg_received_rating||0).toFixed(1)]})]})})]})}),e(k,{md:8,children:r(_,{className:"mb-3",children:[e(_.Header,{children:e("strong",{children:"Pending Student Reports"})}),e(_.Body,{children:d.length===0?e("div",{className:"text-muted",children:"No pending student reports"}):r(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Title"}),e("th",{children:"Student"}),e("th",{children:"Course"}),e("th",{children:"Date"})]})}),e("tbody",{children:d.map(h=>r("tr",{children:[e("td",{children:h.title}),r("td",{children:[h.first_name," ",h.last_name]}),e("td",{children:h.course_name}),e("td",{children:new Date(h.created_at).toLocaleDateString()})]},h.id))})]})})]})})]}),r(_,{children:[e(_.Header,{children:e("strong",{children:"My Courses"})}),e(_.Body,{children:l.length===0?e("div",{className:"text-muted",children:"No courses assigned"}):r(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"}),e("th",{children:"Avg Rating"})]})}),e("tbody",{children:l.map(h=>r("tr",{children:[e("td",{children:h.course_name}),e("td",{children:h.course_code}),e("td",{children:h.stream_name}),e("td",{children:e(ue,{bg:"secondary",children:h.student_count??0})}),e("td",{children:h.avg_rating?Number(h.avg_rating).toFixed(1):"N/A"})]},h.id))})]})})]})]})}function Os(){const[t,a]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState({}),[l,o]=p.useState([]);return p.useEffect(()=>{(async()=>{var u,h;try{a(!0);const{data:C}=await T.dashboard.getPersonal();c((C==null?void 0:C.personalStats)||{}),o((C==null?void 0:C.courses)||[])}catch(C){i(((h=(u=C==null?void 0:C.response)==null?void 0:u.data)==null?void 0:h.error)||"Failed to load rating data")}finally{a(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):r("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"My Ratings"}),r(z,{className:"mb-3",children:[e(k,{md:4,children:r(_,{children:[e(_.Header,{children:e("strong",{children:"Overview"})}),r(_.Body,{children:[r("div",{children:[e("strong",{children:"Avg Received Rating:"})," ",Number(n.avg_received_rating||0).toFixed(1)," / 5"]}),r("div",{children:[e("strong",{children:"Courses:"})," ",l.length]})]})]})}),e(k,{md:8,children:r(_,{children:[e(_.Header,{children:e("strong",{children:"By Course"})}),e(_.Body,{children:l.length===0?e("div",{className:"text-muted",children:"No courses assigned"}):r(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Avg Rating"})]})}),e("tbody",{children:l.map(d=>r("tr",{children:[e("td",{children:d.course_name}),e("td",{children:d.course_code}),e("td",{children:d.avg_rating?e("span",{title:`${Number(d.avg_rating).toFixed(1)} / 5`,children:[1,2,3,4,5].map(u=>e("i",{className:`bi ${u<=Math.round(d.avg_rating)?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:14,marginRight:2}},u))}):e("span",{className:"text-muted",children:"N/A"})})]},d.id))})]})})]})})]})]})}function Ts(){const[t,a]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]);return p.useEffect(()=>{(async()=>{var o,d;try{a(!0);const{data:u}=await T.dashboard.getPersonal();c((u==null?void 0:u.courses)||[])}catch(u){i(((d=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:d.error)||"Failed to load courses")}finally{a(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):r("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Stream Courses & Lectures"}),e(_,{children:e(_.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No courses found under your streams"}):r(le,{responsive:!0,hover:!0,className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"}),e("th",{children:"Avg Rating"})]})}),e("tbody",{children:n.map(l=>r("tr",{children:[e("td",{children:l.course_name}),e("td",{children:l.course_code}),e("td",{children:l.stream_name}),e("td",{children:l.student_count??0}),e("td",{children:l.avg_rating?Number(l.avg_rating).toFixed(1):"N/A"})]},l.id))})]})})})]})}function Ds(){const[t,a]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState({}),[l,o]=p.useState([]),[d,u]=p.useState([]);return p.useEffect(()=>{(async()=>{var C,w;try{a(!0);const{data:m}=await T.dashboard.getPersonal();c((m==null?void 0:m.personalStats)||{}),o((m==null?void 0:m.courses)||[]),u((m==null?void 0:m.pendingActions)||[])}catch(m){i(((w=(C=m==null?void 0:m.response)==null?void 0:C.data)==null?void 0:w.error)||"Failed to load monitoring")}finally{a(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):r("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"PRL Monitoring"}),r(z,{children:[e(k,{md:4,children:r(_,{className:"mb-3",children:[e(_.Header,{children:e("strong",{children:"Overview"})}),e(_.Body,{children:r("div",{className:"d-flex flex-column gap-2",children:[r("div",{children:[e("strong",{children:"Streams:"})," ",n.supervised_streams??n.managed_streams??0]}),r("div",{children:[e("strong",{children:"Reports to Review:"})," ",n.reports_to_review??0]}),r("div",{children:[e("strong",{children:"Staff:"})," ",n.supervised_staff??0]})]})})]})}),e(k,{md:8,children:r(_,{className:"mb-3",children:[e(_.Header,{children:e("strong",{children:"Pending Actions"})}),e(_.Body,{children:d.length===0?e("div",{className:"text-muted",children:"No pending actions"}):r(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Title"}),e("th",{children:"From"}),e("th",{children:"Course"}),e("th",{children:"Date"})]})}),e("tbody",{children:d.map(h=>r("tr",{children:[e("td",{children:h.title}),r("td",{children:[h.first_name," ",h.last_name]}),e("td",{children:h.course_name}),e("td",{children:new Date(h.created_at).toLocaleDateString()})]},h.id))})]})})]})})]}),r(_,{children:[e(_.Header,{children:e("strong",{children:"Courses Under Your Streams"})}),e(_.Body,{children:l.length===0?e("div",{className:"text-muted",children:"No courses"}):r(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"})]})}),e("tbody",{children:l.map(h=>r("tr",{children:[e("td",{children:h.course_name}),e("td",{children:h.course_code}),e("td",{children:h.stream_name}),e("td",{children:e(ue,{bg:"secondary",children:h.student_count??0})})]},h.id))})]})})]})]})}function Ms(){const[t,a]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]);return p.useEffect(()=>{(async()=>{var o,d;try{a(!0);const{data:u}=await T.dashboard.getPersonal();c((u==null?void 0:u.courses)||[])}catch(u){i(((d=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:d.error)||"Failed to load rating")}finally{a(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):r("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"PRL Rating Overview"}),e(_,{children:e(_.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No courses assigned under your streams"}):r(le,{responsive:!0,hover:!0,className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Avg Rating"})]})}),e("tbody",{children:n.map(l=>r("tr",{children:[e("td",{children:l.course_name}),e("td",{children:l.course_code}),e("td",{children:l.avg_rating?e("span",{title:`${Number(l.avg_rating).toFixed(1)} / 5`,children:[1,2,3,4,5].map(o=>e("i",{className:`bi ${o<=Math.round(l.avg_rating)?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:14,marginRight:2}},o))}):e("span",{className:"text-muted",children:"N/A"})})]},l.id))})]})})})]})}function Us(){const[t,a]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]);return p.useEffect(()=>{(async()=>{var o,d;try{a(!0);const{data:u}=await T.dashboard.getPersonal();c((u==null?void 0:u.courses)||[])}catch(u){i(((d=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:d.error)||"Failed to load classes")}finally{a(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):r("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"PRL Classes"}),e(_,{children:e(_.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No classes (courses) under your streams."}):r(le,{responsive:!0,hover:!0,className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"}),e("th",{children:"Avg Rating"}),e("th",{children:"Actions"})]})}),e("tbody",{children:n.map(l=>r("tr",{children:[e("td",{children:l.course_name}),e("td",{children:l.course_code}),e("td",{children:l.stream_name}),e("td",{children:l.student_count??0}),e("td",{children:l.avg_rating?Number(l.avg_rating).toFixed(1):"N/A"}),e("td",{className:"d-flex gap-2",children:e(H,{as:M,size:"sm",variant:"outline-primary",to:`/reports?courseId=${l.id}`,children:"View Reports"})})]},l.id))})]})})})]})}function $s(){const[t,a]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]);return p.useEffect(()=>{(async()=>{var o,d;try{a(!0);const{data:u}=await T.dashboard.getPersonal();c((u==null?void 0:u.courses)||[])}catch(u){i(((d=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:d.error)||"Failed to load courses")}finally{a(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):r("div",{className:"container py-4",children:[r("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e("h2",{className:"mb-0",children:"PL Courses"}),e("div",{className:"d-flex gap-2",children:e(H,{as:M,to:"/admin/assign-modules",variant:"outline-primary",size:"sm",children:"Assign Lecturer Modules"})})]}),e(_,{children:e(_.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No courses available."}):r(le,{responsive:!0,hover:!0,children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"}),e("th",{children:"Avg Rating"}),e("th",{children:"Actions"})]})}),e("tbody",{children:n.map(l=>r("tr",{children:[e("td",{children:l.course_name}),e("td",{children:l.course_code}),e("td",{children:l.stream_name}),e("td",{children:l.student_count??0}),e("td",{children:l.avg_rating?Number(l.avg_rating).toFixed(1):"N/A"}),r("td",{className:"d-flex gap-2",children:[e(H,{as:M,to:`/admin/assign-modules?courseId=${l.id}`,size:"sm",variant:"outline-primary",children:"Assign"}),e(H,{as:M,to:`/admin/assign-modules?mode=add&courseId=${l.id}`,size:"sm",variant:"outline-success",children:"Add Module"})]})]},l.id))})]})})})]})}function js(){const[t,a]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState({}),[l,o]=p.useState([]),[d,u]=p.useState([]);return p.useEffect(()=>{(async()=>{var C,w;try{a(!0);const{data:m}=await T.dashboard.getPersonal();c((m==null?void 0:m.personalStats)||{}),o((m==null?void 0:m.courses)||[]),u((m==null?void 0:m.pendingActions)||[])}catch(m){i(((w=(C=m==null?void 0:m.response)==null?void 0:C.data)==null?void 0:w.error)||"Failed to load monitoring")}finally{a(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):r("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Program Leader Monitoring"}),r(z,{className:"mb-3",children:[e(k,{md:4,children:r(_,{children:[e(_.Header,{children:e("strong",{children:"Overview"})}),e(_.Body,{children:r("div",{className:"d-flex flex-column gap-2",children:[r("div",{children:[e("strong",{children:"Managed Streams:"})," ",n.managed_streams??n.supervised_streams??0]}),r("div",{children:[e("strong",{children:"Reports to Review:"})," ",n.reports_to_review??n.pending_reports??0]}),r("div",{children:[e("strong",{children:"Lecturers:"})," ",n.managed_lecturers??n.supervised_staff??0]})]})})]})}),e(k,{md:8,children:r(_,{children:[e(_.Header,{children:e("strong",{children:"Pending Actions"})}),e(_.Body,{children:d.length===0?e("div",{className:"text-muted",children:"No pending actions"}):r(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Title"}),e("th",{children:"From"}),e("th",{children:"Course"}),e("th",{children:"Date"})]})}),e("tbody",{children:d.map(h=>r("tr",{children:[e("td",{children:h.title}),r("td",{children:[h.first_name," ",h.last_name]}),e("td",{children:h.course_name}),e("td",{children:new Date(h.created_at).toLocaleDateString()})]},h.id))})]})})]})})]}),r(_,{children:[e(_.Header,{children:e("strong",{children:"Courses"})}),e(_.Body,{children:l.length===0?e("div",{className:"text-muted",children:"No courses"}):r(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"})]})}),e("tbody",{children:l.map(h=>r("tr",{children:[e("td",{children:h.course_name}),e("td",{children:h.course_code}),e("td",{children:h.stream_name}),e("td",{children:e(ue,{bg:"secondary",children:h.student_count??0})})]},h.id))})]})})]})]})}function qs(){const[t,a]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]);return p.useEffect(()=>{(async()=>{var o,d;try{a(!0);const{data:u}=await T.dashboard.getPersonal();c((u==null?void 0:u.courses)||[])}catch(u){i(((d=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:d.error)||"Failed to load classes")}finally{a(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):r("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"PL Classes"}),e(_,{children:e(_.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No classes available"}):r(le,{responsive:!0,hover:!0,children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"}),e("th",{children:"Actions"})]})}),e("tbody",{children:n.map(l=>r("tr",{children:[e("td",{children:l.course_name}),e("td",{children:l.course_code}),e("td",{children:l.stream_name}),e("td",{children:l.student_count??0}),r("td",{className:"d-flex gap-2",children:[e(H,{as:M,to:`/admin/assign-modules?courseId=${l.id}`,size:"sm",variant:"outline-primary",children:"Assign Class"}),e(H,{as:M,to:`/reports?courseId=${l.id}`,size:"sm",variant:"outline-secondary",children:"View Reports"})]})]},l.id))})]})})})]})}function Qs(){const[t,a]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]),[l,o]=p.useState([]),[d,u]=p.useState({}),[h,C]=p.useState([]),[w,m]=p.useState(""),[f,S]=p.useState("");return p.useEffect(()=>{(async()=>{var b,N,y;try{a(!0);const[{data:L},{data:x}]=await Promise.all([T.users.getAll({role:"lecturer",limit:200}),T.users.getAvailableCourses()]),F=Array.isArray(L==null?void 0:L.users)?L.users:Array.isArray(L)?L:[],Q=Array.isArray(x==null?void 0:x.courses)?x.courses:Array.isArray(x)?x:[];c(F),o(Q);const E=Array.from(new Map(Q.map(I=>[String(I.stream_id||I.streamId||I.stream_name||""),{id:I.stream_id||I.streamId||String(I.stream_name||""),name:I.stream_name||String(I.stream_id||I.streamId||"Unknown")}])).values());C(E);const $={};for(const I of F)$[I.id]=[];let D=!1;for(const I of Q){const K=I.lecturer_ids||I.assigned_lecturer_ids||((b=I.lecturers)==null?void 0:b.map(V=>V.id))||[];if(K&&K.length){D=!0;for(const V of K)$[V]&&$[V].push(I)}}if(!D)for(const I of Q)try{const{data:K}=await T.users.getLecturersByCourse(I.id),V=(K==null?void 0:K.lecturers)||[];for(const R of V)$[R.id]&&$[R.id].push(I)}catch{}u($)}catch(L){i(((y=(N=L==null?void 0:L.response)==null?void 0:N.data)==null?void 0:y.error)||"Failed to load lecturers")}finally{a(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):r("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Lecturers & Assigned Classes"}),e(_,{className:"mb-3",children:e(_.Body,{children:r("div",{className:"row g-3 align-items-end",children:[e("div",{className:"col-md-4",children:r(g.Group,{children:[e(g.Label,{children:"Filter by Stream"}),r(g.Select,{value:w,onChange:v=>m(v.target.value),children:[e("option",{value:"",children:"All Streams"}),h.map(v=>e("option",{value:v.name,children:v.name},v.id))]})]})}),e("div",{className:"col-md-4",children:r(g.Group,{children:[e(g.Label,{children:"Search Course"}),e(g.Control,{placeholder:"Course name or code",value:f,onChange:v=>S(v.target.value)})]})})]})})}),n.length===0?e(_,{children:e(_.Body,{children:e("div",{className:"text-muted",children:"No lecturers available"})})}):n.map(v=>r(_,{className:"mb-3",children:[r(_.Header,{className:"d-flex justify-content-between align-items-center",children:[r("div",{children:[r("strong",{children:[v.first_name," ",v.last_name]}),e("div",{className:"text-muted small",children:v.email})]}),r(ue,{bg:"secondary",children:[(d[v.id]||[]).length," classes"]})]}),e(_.Body,{children:(d[v.id]||[]).length===0?e("div",{className:"text-muted",children:"No classes assigned"}):(()=>{const b=(d[v.id]||[]).filter(N=>{const y=!w||(N.stream_name||"").toLowerCase()===w.toLowerCase(),L=f.trim().toLowerCase(),x=!L||(N.course_name||"").toLowerCase().includes(L)||(N.course_code||"").toLowerCase().includes(L);return y&&x});return b.length===0?e("div",{className:"text-muted",children:"No classes match current filters"}):r(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"}),e("th",{children:"Year"}),e("th",{children:"Semester"}),e("th",{children:"Actions"})]})}),e("tbody",{children:b.map(N=>r("tr",{children:[e("td",{children:N.course_name}),e("td",{children:N.course_code}),e("td",{children:N.stream_name}),e("td",{children:N.student_count??0}),e("td",{children:N.academic_year||N.year||"-"}),e("td",{children:N.semester||"-"}),r("td",{children:[e(H,{as:M,to:`/admin/assign-modules?courseId=${N.id}`,size:"sm",variant:"outline-primary",children:"Reassign"}),e(H,{as:M,to:`/reports?courseId=${N.id}`,size:"sm",variant:"outline-secondary",className:"ms-2",children:"View Reports"})]})]},N.id))})]})})()})]},v.id))]})}function Bs(){const[t,a]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]);return p.useEffect(()=>{(async()=>{var o,d;try{a(!0);const{data:u}=await T.dashboard.getPersonal();c((u==null?void 0:u.courses)||[])}catch(u){i(((d=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:d.error)||"Failed to load rating overview")}finally{a(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):r("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Program Leader Rating"}),e(_,{children:e(_.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No courses to display"}):r(le,{responsive:!0,hover:!0,children:[e("thead",{className:"table-light",children:r("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Avg Rating"})]})}),e("tbody",{children:n.map(l=>r("tr",{children:[e("td",{children:l.course_name}),e("td",{children:l.course_code}),e("td",{children:l.avg_rating?e("span",{title:`${Number(l.avg_rating).toFixed(1)} / 5`,children:[1,2,3,4,5].map(o=>e("i",{className:`bi ${o<=Math.round(l.avg_rating)?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:14,marginRight:2}},o))}):e("span",{className:"text-muted",children:"N/A"})})]},l.id))})]})})})]})}const Gs=new Wr({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1,staleTime:5*60*1e3}}});function zs(){return r(Xr,{client:Gs,children:[e(Rr,{children:r("div",{className:"App",children:[e(Ka,{}),e(Za,{}),e("main",{className:"main-content",children:r(Ar,{children:[e(Y,{path:"/",element:e(ws,{})}),e(Y,{path:"/login",element:e(ds,{})}),e(Y,{path:"/register",element:e(us,{})}),e(Y,{path:"/reports",element:e(ee,{children:e(hs,{})})}),e(Y,{path:"/reports/create",element:e(ee,{roles:["student","admin","program_leader","principal_lecturer","faculty_manager"],children:e(ms,{})})}),e(Y,{path:"/reports/lecturer/new",element:e(ee,{roles:["lecturer","admin","program_leader","principal_lecturer","faculty_manager"],children:e(vs,{})})}),e(Y,{path:"/reports/:id",element:e(ee,{children:e(ps,{})})}),e(Y,{path:"/profile",element:e(ee,{children:e(bs,{})})}),e(Y,{path:"/analytics",element:e(ee,{roles:["admin","program_leader","principal_lecturer","faculty_manager"],children:e(Cs,{})})}),e(Y,{path:"/admin",element:e(ee,{roles:["admin"],children:e(pr,{})})}),e(Y,{path:"/admin/audit",element:e(ee,{roles:["admin"],children:e(Ns,{})})}),e(Y,{path:"/users",element:e(ee,{roles:["admin","program_leader","principal_lecturer","faculty_manager"],children:e(ys,{})})}),e(Y,{path:"/admin/assign-modules",element:e(ee,{roles:["admin","program_leader","principal_lecturer","faculty_manager"],children:e(Fs,{})})}),e(Y,{path:"/my-progress",element:e(ee,{roles:["student"],children:e(_s,{})})}),e(Y,{path:"/my-classes",element:e(ee,{roles:["student"],children:e(Ps,{})})}),e(Y,{path:"/monitoring",element:e(ee,{roles:["student"],children:e(As,{})})}),e(Y,{path:"/rating",element:e(ee,{roles:["student"],children:e(Ls,{})})}),e(Y,{path:"/notifications",element:e(ee,{children:e(xs,{})})}),e(Y,{path:"/pending",element:e(ee,{children:e(Rs,{})})}),e(Y,{path:"/lecturer/classes",element:e(ee,{roles:["lecturer","admin","program_leader","principal_lecturer","faculty_manager"],children:e(Es,{})})}),e(Y,{path:"/lecturer/monitoring",element:e(ee,{roles:["lecturer","admin","program_leader","principal_lecturer","faculty_manager"],children:e(Is,{})})}),e(Y,{path:"/lecturer/rating",element:e(ee,{roles:["lecturer","admin","program_leader","principal_lecturer","faculty_manager"],children:e(Os,{})})}),e(Y,{path:"/prl/courses",element:e(ee,{roles:["principal_lecturer"],children:e(Ts,{})})}),e(Y,{path:"/prl/monitoring",element:e(ee,{roles:["principal_lecturer"],children:e(Ds,{})})}),e(Y,{path:"/prl/rating",element:e(ee,{roles:["principal_lecturer"],children:e(Ms,{})})}),e(Y,{path:"/prl/classes",element:e(ee,{roles:["principal_lecturer"],children:e(Us,{})})}),e(Y,{path:"/pl/courses",element:e(ee,{roles:["program_leader"],children:e($s,{})})}),e(Y,{path:"/pl/monitoring",element:e(ee,{roles:["program_leader"],children:e(js,{})})}),e(Y,{path:"/pl/classes",element:e(ee,{roles:["program_leader"],children:e(qs,{})})}),e(Y,{path:"/pl/lectures",element:e(ee,{roles:["program_leader"],children:e(Qs,{})})}),e(Y,{path:"/pl/rating",element:e(ee,{roles:["program_leader"],children:e(Bs,{})})}),e(Y,{path:"*",element:e(Ss,{})})]})}),e(Ha,{position:"top-right",reverseOrder:!1,gutter:8,containerClassName:"",containerStyle:{},toastOptions:{className:"",duration:4e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,theme:{primary:"green",secondary:"black"}}}})]})}),!1]})}class Hs extends te.Component{constructor(a){super(a),this.state={hasError:!1,error:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,s){console.error("App render error:",a,s)}render(){return this.state.hasError?e("div",{className:"container py-5",children:r("div",{className:"alert alert-danger",role:"alert",children:[e("h4",{className:"alert-heading",children:"Something went wrong."}),e("p",{children:"We encountered an error while rendering the page."}),e("hr",{}),e("pre",{style:{whiteSpace:"pre-wrap"},children:String(this.state.error)})]})}):this.props.children}}dt.createRoot(document.getElementById("root")).render(e(Ja,{children:e(Hs,{children:e(zs,{})})}));
