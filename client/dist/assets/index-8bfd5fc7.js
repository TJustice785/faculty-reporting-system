import{_ as J,a as Me,j as e,b as a,L as $,c as gr,u as at,d as Fe,B as Qe,C as st,N as fe,F as de,e as ue,f as V,g as Lt,h as $e,i as vr,k as br,P as yr,l as gt,m as vt,n as bt,o as yt,p as Nt,q as Qt,R as z,r as P,A as Z,s as K,t as x,S as se,v as m,I as Ie,w as Nr,D as ge,x as kt,T as le,y as Be,z as Cr,E as Sr,G as Bt,H as wr,J as _r,K as xr,M as Te,O as Rr,Q as Ar,U as Y}from"./vendor-fc4a13e9.js";import{c as Lr,b as kr,a as te,r as p}from"./react-307dba9e.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function s(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(n){if(n.ep)return;n.ep=!0;const c=s(n);fetch(n.href,c)}})();var dt={},Pt=Lr;dt.createRoot=Pt.createRoot,dt.hydrateRoot=Pt.hydrateRoot;var Ue=function(){function t(){this.listeners=[]}var r=t.prototype;return r.subscribe=function(i){var n=this,c=i||function(){};return this.listeners.push(c),this.onSubscribe(),function(){n.listeners=n.listeners.filter(function(l){return l!==c}),n.onUnsubscribe()}},r.hasListeners=function(){return this.listeners.length>0},r.onSubscribe=function(){},r.onUnsubscribe=function(){},t}(),Ye=typeof window>"u";function he(){}function Pr(t,r){return typeof t=="function"?t(r):t}function ut(t){return typeof t=="number"&&t>=0&&t!==1/0}function Je(t){return Array.isArray(t)?t:[t]}function Gt(t,r){return Math.max(t+(r||0)-Date.now(),0)}function ze(t,r,s){return nt(t)?typeof r=="function"?J({},s,{queryKey:t,queryFn:r}):J({},r,{queryKey:t}):t}function Re(t,r,s){return nt(t)?[J({},r,{queryKey:t}),s]:[t||{},r]}function Fr(t,r){if(t===!0&&r===!0||t==null&&r==null)return"all";if(t===!1&&r===!1)return"none";var s=t??!r;return s?"active":"inactive"}function Ft(t,r){var s=t.active,i=t.exact,n=t.fetching,c=t.inactive,l=t.predicate,o=t.queryKey,d=t.stale;if(nt(o)){if(i){if(r.queryHash!==Ct(o,r.options))return!1}else if(!Ze(r.queryKey,o))return!1}var u=Fr(s,c);if(u==="none")return!1;if(u!=="all"){var h=r.isActive();if(u==="active"&&!h||u==="inactive"&&h)return!1}return!(typeof d=="boolean"&&r.isStale()!==d||typeof n=="boolean"&&r.isFetching()!==n||l&&!l(r))}function It(t,r){var s=t.exact,i=t.fetching,n=t.predicate,c=t.mutationKey;if(nt(c)){if(!r.options.mutationKey)return!1;if(s){if(Pe(r.options.mutationKey)!==Pe(c))return!1}else if(!Ze(r.options.mutationKey,c))return!1}return!(typeof i=="boolean"&&r.state.status==="loading"!==i||n&&!n(r))}function Ct(t,r){var s=(r==null?void 0:r.queryKeyHashFn)||Pe;return s(t)}function Pe(t){var r=Je(t);return Ir(r)}function Ir(t){return JSON.stringify(t,function(r,s){return ht(s)?Object.keys(s).sort().reduce(function(i,n){return i[n]=s[n],i},{}):s})}function Ze(t,r){return Ht(Je(t),Je(r))}function Ht(t,r){return t===r?!0:typeof t!=typeof r?!1:t&&r&&typeof t=="object"&&typeof r=="object"?!Object.keys(r).some(function(s){return!Ht(t[s],r[s])}):!1}function Xe(t,r){if(t===r)return t;var s=Array.isArray(t)&&Array.isArray(r);if(s||ht(t)&&ht(r)){for(var i=s?t.length:Object.keys(t).length,n=s?r:Object.keys(r),c=n.length,l=s?[]:{},o=0,d=0;d<c;d++){var u=s?d:n[d];l[u]=Xe(t[u],r[u]),l[u]===t[u]&&o++}return i===c&&o===i?t:l}return r}function Er(t,r){if(t&&!r||r&&!t)return!1;for(var s in t)if(t[s]!==r[s])return!1;return!0}function ht(t){if(!Et(t))return!1;var r=t.constructor;if(typeof r>"u")return!0;var s=r.prototype;return!(!Et(s)||!s.hasOwnProperty("isPrototypeOf"))}function Et(t){return Object.prototype.toString.call(t)==="[object Object]"}function nt(t){return typeof t=="string"||Array.isArray(t)}function Or(t){return new Promise(function(r){setTimeout(r,t)})}function Ot(t){Promise.resolve().then(t).catch(function(r){return setTimeout(function(){throw r})})}function zt(){if(typeof AbortController=="function")return new AbortController}var Tr=function(t){Me(r,t);function r(){var i;return i=t.call(this)||this,i.setup=function(n){var c;if(!Ye&&((c=window)!=null&&c.addEventListener)){var l=function(){return n()};return window.addEventListener("visibilitychange",l,!1),window.addEventListener("focus",l,!1),function(){window.removeEventListener("visibilitychange",l),window.removeEventListener("focus",l)}}},i}var s=r.prototype;return s.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},s.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},s.setEventListener=function(n){var c,l=this;this.setup=n,(c=this.cleanup)==null||c.call(this),this.cleanup=n(function(o){typeof o=="boolean"?l.setFocused(o):l.onFocus()})},s.setFocused=function(n){this.focused=n,n&&this.onFocus()},s.onFocus=function(){this.listeners.forEach(function(n){n()})},s.isFocused=function(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)},r}(Ue),De=new Tr,Dr=function(t){Me(r,t);function r(){var i;return i=t.call(this)||this,i.setup=function(n){var c;if(!Ye&&((c=window)!=null&&c.addEventListener)){var l=function(){return n()};return window.addEventListener("online",l,!1),window.addEventListener("offline",l,!1),function(){window.removeEventListener("online",l),window.removeEventListener("offline",l)}}},i}var s=r.prototype;return s.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},s.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},s.setEventListener=function(n){var c,l=this;this.setup=n,(c=this.cleanup)==null||c.call(this),this.cleanup=n(function(o){typeof o=="boolean"?l.setOnline(o):l.onOnline()})},s.setOnline=function(n){this.online=n,n&&this.onOnline()},s.onOnline=function(){this.listeners.forEach(function(n){n()})},s.isOnline=function(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine},r}(Ue),Ke=new Dr;function Mr(t){return Math.min(1e3*Math.pow(2,t),3e4)}function et(t){return typeof(t==null?void 0:t.cancel)=="function"}var Kt=function(r){this.revert=r==null?void 0:r.revert,this.silent=r==null?void 0:r.silent};function We(t){return t instanceof Kt}var Wt=function(r){var s=this,i=!1,n,c,l,o;this.abort=r.abort,this.cancel=function(w){return n==null?void 0:n(w)},this.cancelRetry=function(){i=!0},this.continueRetry=function(){i=!1},this.continue=function(){return c==null?void 0:c()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise(function(w,f){l=w,o=f});var d=function(f){s.isResolved||(s.isResolved=!0,r.onSuccess==null||r.onSuccess(f),c==null||c(),l(f))},u=function(f){s.isResolved||(s.isResolved=!0,r.onError==null||r.onError(f),c==null||c(),o(f))},h=function(){return new Promise(function(f){c=f,s.isPaused=!0,r.onPause==null||r.onPause()}).then(function(){c=void 0,s.isPaused=!1,r.onContinue==null||r.onContinue()})},C=function w(){if(!s.isResolved){var f;try{f=r.fn()}catch(g){f=Promise.reject(g)}n=function(S){if(!s.isResolved&&(u(new Kt(S)),s.abort==null||s.abort(),et(f)))try{f.cancel()}catch{}},s.isTransportCancelable=et(f),Promise.resolve(f).then(d).catch(function(g){var S,b;if(!s.isResolved){var v=(S=r.retry)!=null?S:3,y=(b=r.retryDelay)!=null?b:Mr,N=typeof y=="function"?y(s.failureCount,g):y,k=v===!0||typeof v=="number"&&s.failureCount<v||typeof v=="function"&&v(s.failureCount,g);if(i||!k){u(g);return}s.failureCount++,r.onFail==null||r.onFail(s.failureCount,g),Or(N).then(function(){if(!De.isFocused()||!Ke.isOnline())return h()}).then(function(){i?u(g):w()})}})}};C()},$r=function(){function t(){this.queue=[],this.transactions=0,this.notifyFn=function(s){s()},this.batchNotifyFn=function(s){s()}}var r=t.prototype;return r.batch=function(i){var n;this.transactions++;try{n=i()}finally{this.transactions--,this.transactions||this.flush()}return n},r.schedule=function(i){var n=this;this.transactions?this.queue.push(i):Ot(function(){n.notifyFn(i)})},r.batchCalls=function(i){var n=this;return function(){for(var c=arguments.length,l=new Array(c),o=0;o<c;o++)l[o]=arguments[o];n.schedule(function(){i.apply(void 0,l)})}},r.flush=function(){var i=this,n=this.queue;this.queue=[],n.length&&Ot(function(){i.batchNotifyFn(function(){n.forEach(function(c){i.notifyFn(c)})})})},r.setNotifyFunction=function(i){this.notifyFn=i},r.setBatchNotifyFunction=function(i){this.batchNotifyFn=i},t}(),ie=new $r,Vt=console;function tt(){return Vt}function Ur(t){Vt=t}var qr=function(){function t(s){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=s.defaultOptions,this.setOptions(s.options),this.observers=[],this.cache=s.cache,this.queryKey=s.queryKey,this.queryHash=s.queryHash,this.initialState=s.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=s.meta,this.scheduleGc()}var r=t.prototype;return r.setOptions=function(i){var n;this.options=J({},this.defaultOptions,i),this.meta=i==null?void 0:i.meta,this.cacheTime=Math.max(this.cacheTime||0,(n=this.options.cacheTime)!=null?n:5*60*1e3)},r.setDefaultOptions=function(i){this.defaultOptions=i},r.scheduleGc=function(){var i=this;this.clearGcTimeout(),ut(this.cacheTime)&&(this.gcTimeout=setTimeout(function(){i.optionalRemove()},this.cacheTime))},r.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},r.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},r.setData=function(i,n){var c,l,o=this.state.data,d=Pr(i,o);return(c=(l=this.options).isDataEqual)!=null&&c.call(l,o,d)?d=o:this.options.structuralSharing!==!1&&(d=Xe(o,d)),this.dispatch({data:d,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt}),d},r.setState=function(i,n){this.dispatch({type:"setState",state:i,setStateOptions:n})},r.cancel=function(i){var n,c=this.promise;return(n=this.retryer)==null||n.cancel(i),c?c.then(he).catch(he):Promise.resolve()},r.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},r.reset=function(){this.destroy(),this.setState(this.initialState)},r.isActive=function(){return this.observers.some(function(i){return i.options.enabled!==!1})},r.isFetching=function(){return this.state.isFetching},r.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(function(i){return i.getCurrentResult().isStale})},r.isStaleByTime=function(i){return i===void 0&&(i=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!Gt(this.state.dataUpdatedAt,i)},r.onFocus=function(){var i,n=this.observers.find(function(c){return c.shouldFetchOnWindowFocus()});n&&n.refetch(),(i=this.retryer)==null||i.continue()},r.onOnline=function(){var i,n=this.observers.find(function(c){return c.shouldFetchOnReconnect()});n&&n.refetch(),(i=this.retryer)==null||i.continue()},r.addObserver=function(i){this.observers.indexOf(i)===-1&&(this.observers.push(i),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:i}))},r.removeObserver=function(i){this.observers.indexOf(i)!==-1&&(this.observers=this.observers.filter(function(n){return n!==i}),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:i}))},r.getObserversCount=function(){return this.observers.length},r.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},r.fetch=function(i,n){var c=this,l,o,d;if(this.state.isFetching){if(this.state.dataUpdatedAt&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(this.promise){var u;return(u=this.retryer)==null||u.continueRetry(),this.promise}}if(i&&this.setOptions(i),!this.options.queryFn){var h=this.observers.find(function(y){return y.options.queryFn});h&&this.setOptions(h.options)}var C=Je(this.queryKey),w=zt(),f={queryKey:C,pageParam:void 0,meta:this.meta};Object.defineProperty(f,"signal",{enumerable:!0,get:function(){if(w)return c.abortSignalConsumed=!0,w.signal}});var g=function(){return c.options.queryFn?(c.abortSignalConsumed=!1,c.options.queryFn(f)):Promise.reject("Missing queryFn")},S={fetchOptions:n,options:this.options,queryKey:C,state:this.state,fetchFn:g,meta:this.meta};if((l=this.options.behavior)!=null&&l.onFetch){var b;(b=this.options.behavior)==null||b.onFetch(S)}if(this.revertState=this.state,!this.state.isFetching||this.state.fetchMeta!==((o=S.fetchOptions)==null?void 0:o.meta)){var v;this.dispatch({type:"fetch",meta:(v=S.fetchOptions)==null?void 0:v.meta})}return this.retryer=new Wt({fn:S.fetchFn,abort:w==null||(d=w.abort)==null?void 0:d.bind(w),onSuccess:function(N){c.setData(N),c.cache.config.onSuccess==null||c.cache.config.onSuccess(N,c),c.cacheTime===0&&c.optionalRemove()},onError:function(N){We(N)&&N.silent||c.dispatch({type:"error",error:N}),We(N)||(c.cache.config.onError==null||c.cache.config.onError(N,c),tt().error(N)),c.cacheTime===0&&c.optionalRemove()},onFail:function(){c.dispatch({type:"failed"})},onPause:function(){c.dispatch({type:"pause"})},onContinue:function(){c.dispatch({type:"continue"})},retry:S.options.retry,retryDelay:S.options.retryDelay}),this.promise=this.retryer.promise,this.promise},r.dispatch=function(i){var n=this;this.state=this.reducer(this.state,i),ie.batch(function(){n.observers.forEach(function(c){c.onQueryUpdate(i)}),n.cache.notify({query:n,type:"queryUpdated",action:i})})},r.getDefaultState=function(i){var n=typeof i.initialData=="function"?i.initialData():i.initialData,c=typeof i.initialData<"u",l=c?typeof i.initialDataUpdatedAt=="function"?i.initialDataUpdatedAt():i.initialDataUpdatedAt:0,o=typeof n<"u";return{data:n,dataUpdateCount:0,dataUpdatedAt:o?l??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:o?"success":"idle"}},r.reducer=function(i,n){var c,l;switch(n.type){case"failed":return J({},i,{fetchFailureCount:i.fetchFailureCount+1});case"pause":return J({},i,{isPaused:!0});case"continue":return J({},i,{isPaused:!1});case"fetch":return J({},i,{fetchFailureCount:0,fetchMeta:(c=n.meta)!=null?c:null,isFetching:!0,isPaused:!1},!i.dataUpdatedAt&&{error:null,status:"loading"});case"success":return J({},i,{data:n.data,dataUpdateCount:i.dataUpdateCount+1,dataUpdatedAt:(l=n.dataUpdatedAt)!=null?l:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var o=n.error;return We(o)&&o.revert&&this.revertState?J({},this.revertState):J({},i,{error:o,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return J({},i,{isInvalidated:!0});case"setState":return J({},i,n.state);default:return i}},t}(),jr=function(t){Me(r,t);function r(i){var n;return n=t.call(this)||this,n.config=i||{},n.queries=[],n.queriesMap={},n}var s=r.prototype;return s.build=function(n,c,l){var o,d=c.queryKey,u=(o=c.queryHash)!=null?o:Ct(d,c),h=this.get(u);return h||(h=new qr({cache:this,queryKey:d,queryHash:u,options:n.defaultQueryOptions(c),state:l,defaultOptions:n.getQueryDefaults(d),meta:c.meta}),this.add(h)),h},s.add=function(n){this.queriesMap[n.queryHash]||(this.queriesMap[n.queryHash]=n,this.queries.push(n),this.notify({type:"queryAdded",query:n}))},s.remove=function(n){var c=this.queriesMap[n.queryHash];c&&(n.destroy(),this.queries=this.queries.filter(function(l){return l!==n}),c===n&&delete this.queriesMap[n.queryHash],this.notify({type:"queryRemoved",query:n}))},s.clear=function(){var n=this;ie.batch(function(){n.queries.forEach(function(c){n.remove(c)})})},s.get=function(n){return this.queriesMap[n]},s.getAll=function(){return this.queries},s.find=function(n,c){var l=Re(n,c),o=l[0];return typeof o.exact>"u"&&(o.exact=!0),this.queries.find(function(d){return Ft(o,d)})},s.findAll=function(n,c){var l=Re(n,c),o=l[0];return Object.keys(o).length>0?this.queries.filter(function(d){return Ft(o,d)}):this.queries},s.notify=function(n){var c=this;ie.batch(function(){c.listeners.forEach(function(l){l(n)})})},s.onFocus=function(){var n=this;ie.batch(function(){n.queries.forEach(function(c){c.onFocus()})})},s.onOnline=function(){var n=this;ie.batch(function(){n.queries.forEach(function(c){c.onOnline()})})},r}(Ue),Qr=function(){function t(s){this.options=J({},s.defaultOptions,s.options),this.mutationId=s.mutationId,this.mutationCache=s.mutationCache,this.observers=[],this.state=s.state||Br(),this.meta=s.meta}var r=t.prototype;return r.setState=function(i){this.dispatch({type:"setState",state:i})},r.addObserver=function(i){this.observers.indexOf(i)===-1&&this.observers.push(i)},r.removeObserver=function(i){this.observers=this.observers.filter(function(n){return n!==i})},r.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(he).catch(he)):Promise.resolve()},r.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},r.execute=function(){var i=this,n,c=this.state.status==="loading",l=Promise.resolve();return c||(this.dispatch({type:"loading",variables:this.options.variables}),l=l.then(function(){i.mutationCache.config.onMutate==null||i.mutationCache.config.onMutate(i.state.variables,i)}).then(function(){return i.options.onMutate==null?void 0:i.options.onMutate(i.state.variables)}).then(function(o){o!==i.state.context&&i.dispatch({type:"loading",context:o,variables:i.state.variables})})),l.then(function(){return i.executeMutation()}).then(function(o){n=o,i.mutationCache.config.onSuccess==null||i.mutationCache.config.onSuccess(n,i.state.variables,i.state.context,i)}).then(function(){return i.options.onSuccess==null?void 0:i.options.onSuccess(n,i.state.variables,i.state.context)}).then(function(){return i.options.onSettled==null?void 0:i.options.onSettled(n,null,i.state.variables,i.state.context)}).then(function(){return i.dispatch({type:"success",data:n}),n}).catch(function(o){return i.mutationCache.config.onError==null||i.mutationCache.config.onError(o,i.state.variables,i.state.context,i),tt().error(o),Promise.resolve().then(function(){return i.options.onError==null?void 0:i.options.onError(o,i.state.variables,i.state.context)}).then(function(){return i.options.onSettled==null?void 0:i.options.onSettled(void 0,o,i.state.variables,i.state.context)}).then(function(){throw i.dispatch({type:"error",error:o}),o})})},r.executeMutation=function(){var i=this,n;return this.retryer=new Wt({fn:function(){return i.options.mutationFn?i.options.mutationFn(i.state.variables):Promise.reject("No mutationFn found")},onFail:function(){i.dispatch({type:"failed"})},onPause:function(){i.dispatch({type:"pause"})},onContinue:function(){i.dispatch({type:"continue"})},retry:(n=this.options.retry)!=null?n:0,retryDelay:this.options.retryDelay}),this.retryer.promise},r.dispatch=function(i){var n=this;this.state=Gr(this.state,i),ie.batch(function(){n.observers.forEach(function(c){c.onMutationUpdate(i)}),n.mutationCache.notify(n)})},t}();function Br(){return{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0}}function Gr(t,r){switch(r.type){case"failed":return J({},t,{failureCount:t.failureCount+1});case"pause":return J({},t,{isPaused:!0});case"continue":return J({},t,{isPaused:!1});case"loading":return J({},t,{context:r.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:r.variables});case"success":return J({},t,{data:r.data,error:null,status:"success",isPaused:!1});case"error":return J({},t,{data:void 0,error:r.error,failureCount:t.failureCount+1,isPaused:!1,status:"error"});case"setState":return J({},t,r.state);default:return t}}var Hr=function(t){Me(r,t);function r(i){var n;return n=t.call(this)||this,n.config=i||{},n.mutations=[],n.mutationId=0,n}var s=r.prototype;return s.build=function(n,c,l){var o=new Qr({mutationCache:this,mutationId:++this.mutationId,options:n.defaultMutationOptions(c),state:l,defaultOptions:c.mutationKey?n.getMutationDefaults(c.mutationKey):void 0,meta:c.meta});return this.add(o),o},s.add=function(n){this.mutations.push(n),this.notify(n)},s.remove=function(n){this.mutations=this.mutations.filter(function(c){return c!==n}),n.cancel(),this.notify(n)},s.clear=function(){var n=this;ie.batch(function(){n.mutations.forEach(function(c){n.remove(c)})})},s.getAll=function(){return this.mutations},s.find=function(n){return typeof n.exact>"u"&&(n.exact=!0),this.mutations.find(function(c){return It(n,c)})},s.findAll=function(n){return this.mutations.filter(function(c){return It(n,c)})},s.notify=function(n){var c=this;ie.batch(function(){c.listeners.forEach(function(l){l(n)})})},s.onFocus=function(){this.resumePausedMutations()},s.onOnline=function(){this.resumePausedMutations()},s.resumePausedMutations=function(){var n=this.mutations.filter(function(c){return c.state.isPaused});return ie.batch(function(){return n.reduce(function(c,l){return c.then(function(){return l.continue().catch(he)})},Promise.resolve())})},r}(Ue);function zr(){return{onFetch:function(r){r.fetchFn=function(){var s,i,n,c,l,o,d=(s=r.fetchOptions)==null||(i=s.meta)==null?void 0:i.refetchPage,u=(n=r.fetchOptions)==null||(c=n.meta)==null?void 0:c.fetchMore,h=u==null?void 0:u.pageParam,C=(u==null?void 0:u.direction)==="forward",w=(u==null?void 0:u.direction)==="backward",f=((l=r.state.data)==null?void 0:l.pages)||[],g=((o=r.state.data)==null?void 0:o.pageParams)||[],S=zt(),b=S==null?void 0:S.signal,v=g,y=!1,N=r.options.queryFn||function(){return Promise.reject("Missing queryFn")},k=function(R,G,H,X){return v=X?[G].concat(v):[].concat(v,[G]),X?[H].concat(R):[].concat(R,[H])},_=function(R,G,H,X){if(y)return Promise.reject("Cancelled");if(typeof H>"u"&&!G&&R.length)return Promise.resolve(R);var ne={queryKey:r.queryKey,signal:b,pageParam:H,meta:r.meta},ae=N(ne),me=Promise.resolve(ae).then(function(Oe){return k(R,H,Oe,X)});if(et(ae)){var ke=me;ke.cancel=ae.cancel}return me},T;if(!f.length)T=_([]);else if(C){var B=typeof h<"u",E=B?h:Tt(r.options,f);T=_(f,B,E)}else if(w){var L=typeof h<"u",D=L?h:Kr(r.options,f);T=_(f,L,D,!0)}else(function(){v=[];var W=typeof r.options.getNextPageParam>"u",R=d&&f[0]?d(f[0],0,f):!0;T=R?_([],W,g[0]):Promise.resolve(k([],g[0],f[0]));for(var G=function(ne){T=T.then(function(ae){var me=d&&f[ne]?d(f[ne],ne,f):!0;if(me){var ke=W?g[ne]:Tt(r.options,ae);return _(ae,W,ke)}return Promise.resolve(k(ae,g[ne],f[ne]))})},H=1;H<f.length;H++)G(H)})();var I=T.then(function(W){return{pages:W,pageParams:v}}),j=I;return j.cancel=function(){y=!0,S==null||S.abort(),et(T)&&T.cancel()},I}}}}function Tt(t,r){return t.getNextPageParam==null?void 0:t.getNextPageParam(r[r.length-1],r)}function Kr(t,r){return t.getPreviousPageParam==null?void 0:t.getPreviousPageParam(r[0],r)}var Wr=function(){function t(s){s===void 0&&(s={}),this.queryCache=s.queryCache||new jr,this.mutationCache=s.mutationCache||new Hr,this.defaultOptions=s.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var r=t.prototype;return r.mount=function(){var i=this;this.unsubscribeFocus=De.subscribe(function(){De.isFocused()&&Ke.isOnline()&&(i.mutationCache.onFocus(),i.queryCache.onFocus())}),this.unsubscribeOnline=Ke.subscribe(function(){De.isFocused()&&Ke.isOnline()&&(i.mutationCache.onOnline(),i.queryCache.onOnline())})},r.unmount=function(){var i,n;(i=this.unsubscribeFocus)==null||i.call(this),(n=this.unsubscribeOnline)==null||n.call(this)},r.isFetching=function(i,n){var c=Re(i,n),l=c[0];return l.fetching=!0,this.queryCache.findAll(l).length},r.isMutating=function(i){return this.mutationCache.findAll(J({},i,{fetching:!0})).length},r.getQueryData=function(i,n){var c;return(c=this.queryCache.find(i,n))==null?void 0:c.state.data},r.getQueriesData=function(i){return this.getQueryCache().findAll(i).map(function(n){var c=n.queryKey,l=n.state,o=l.data;return[c,o]})},r.setQueryData=function(i,n,c){var l=ze(i),o=this.defaultQueryOptions(l);return this.queryCache.build(this,o).setData(n,c)},r.setQueriesData=function(i,n,c){var l=this;return ie.batch(function(){return l.getQueryCache().findAll(i).map(function(o){var d=o.queryKey;return[d,l.setQueryData(d,n,c)]})})},r.getQueryState=function(i,n){var c;return(c=this.queryCache.find(i,n))==null?void 0:c.state},r.removeQueries=function(i,n){var c=Re(i,n),l=c[0],o=this.queryCache;ie.batch(function(){o.findAll(l).forEach(function(d){o.remove(d)})})},r.resetQueries=function(i,n,c){var l=this,o=Re(i,n,c),d=o[0],u=o[1],h=this.queryCache,C=J({},d,{active:!0});return ie.batch(function(){return h.findAll(d).forEach(function(w){w.reset()}),l.refetchQueries(C,u)})},r.cancelQueries=function(i,n,c){var l=this,o=Re(i,n,c),d=o[0],u=o[1],h=u===void 0?{}:u;typeof h.revert>"u"&&(h.revert=!0);var C=ie.batch(function(){return l.queryCache.findAll(d).map(function(w){return w.cancel(h)})});return Promise.all(C).then(he).catch(he)},r.invalidateQueries=function(i,n,c){var l,o,d,u=this,h=Re(i,n,c),C=h[0],w=h[1],f=J({},C,{active:(l=(o=C.refetchActive)!=null?o:C.active)!=null?l:!0,inactive:(d=C.refetchInactive)!=null?d:!1});return ie.batch(function(){return u.queryCache.findAll(C).forEach(function(g){g.invalidate()}),u.refetchQueries(f,w)})},r.refetchQueries=function(i,n,c){var l=this,o=Re(i,n,c),d=o[0],u=o[1],h=ie.batch(function(){return l.queryCache.findAll(d).map(function(w){return w.fetch(void 0,J({},u,{meta:{refetchPage:d==null?void 0:d.refetchPage}}))})}),C=Promise.all(h).then(he);return u!=null&&u.throwOnError||(C=C.catch(he)),C},r.fetchQuery=function(i,n,c){var l=ze(i,n,c),o=this.defaultQueryOptions(l);typeof o.retry>"u"&&(o.retry=!1);var d=this.queryCache.build(this,o);return d.isStaleByTime(o.staleTime)?d.fetch(o):Promise.resolve(d.state.data)},r.prefetchQuery=function(i,n,c){return this.fetchQuery(i,n,c).then(he).catch(he)},r.fetchInfiniteQuery=function(i,n,c){var l=ze(i,n,c);return l.behavior=zr(),this.fetchQuery(l)},r.prefetchInfiniteQuery=function(i,n,c){return this.fetchInfiniteQuery(i,n,c).then(he).catch(he)},r.cancelMutations=function(){var i=this,n=ie.batch(function(){return i.mutationCache.getAll().map(function(c){return c.cancel()})});return Promise.all(n).then(he).catch(he)},r.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},r.executeMutation=function(i){return this.mutationCache.build(this,i).execute()},r.getQueryCache=function(){return this.queryCache},r.getMutationCache=function(){return this.mutationCache},r.getDefaultOptions=function(){return this.defaultOptions},r.setDefaultOptions=function(i){this.defaultOptions=i},r.setQueryDefaults=function(i,n){var c=this.queryDefaults.find(function(l){return Pe(i)===Pe(l.queryKey)});c?c.defaultOptions=n:this.queryDefaults.push({queryKey:i,defaultOptions:n})},r.getQueryDefaults=function(i){var n;return i?(n=this.queryDefaults.find(function(c){return Ze(i,c.queryKey)}))==null?void 0:n.defaultOptions:void 0},r.setMutationDefaults=function(i,n){var c=this.mutationDefaults.find(function(l){return Pe(i)===Pe(l.mutationKey)});c?c.defaultOptions=n:this.mutationDefaults.push({mutationKey:i,defaultOptions:n})},r.getMutationDefaults=function(i){var n;return i?(n=this.mutationDefaults.find(function(c){return Ze(i,c.mutationKey)}))==null?void 0:n.defaultOptions:void 0},r.defaultQueryOptions=function(i){if(i!=null&&i._defaulted)return i;var n=J({},this.defaultOptions.queries,this.getQueryDefaults(i==null?void 0:i.queryKey),i,{_defaulted:!0});return!n.queryHash&&n.queryKey&&(n.queryHash=Ct(n.queryKey,n)),n},r.defaultQueryObserverOptions=function(i){return this.defaultQueryOptions(i)},r.defaultMutationOptions=function(i){return i!=null&&i._defaulted?i:J({},this.defaultOptions.mutations,this.getMutationDefaults(i==null?void 0:i.mutationKey),i,{_defaulted:!0})},r.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},t}(),Vr=function(t){Me(r,t);function r(i,n){var c;return c=t.call(this)||this,c.client=i,c.options=n,c.trackedProps=[],c.selectError=null,c.bindMethods(),c.setOptions(n),c}var s=r.prototype;return s.bindMethods=function(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)},s.onSubscribe=function(){this.listeners.length===1&&(this.currentQuery.addObserver(this),Dt(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())},s.onUnsubscribe=function(){this.listeners.length||this.destroy()},s.shouldFetchOnReconnect=function(){return mt(this.currentQuery,this.options,this.options.refetchOnReconnect)},s.shouldFetchOnWindowFocus=function(){return mt(this.currentQuery,this.options,this.options.refetchOnWindowFocus)},s.destroy=function(){this.listeners=[],this.clearTimers(),this.currentQuery.removeObserver(this)},s.setOptions=function(n,c){var l=this.options,o=this.currentQuery;if(this.options=this.client.defaultQueryObserverOptions(n),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=l.queryKey),this.updateQuery();var d=this.hasListeners();d&&Mt(this.currentQuery,o,this.options,l)&&this.executeFetch(),this.updateResult(c),d&&(this.currentQuery!==o||this.options.enabled!==l.enabled||this.options.staleTime!==l.staleTime)&&this.updateStaleTimeout();var u=this.computeRefetchInterval();d&&(this.currentQuery!==o||this.options.enabled!==l.enabled||u!==this.currentRefetchInterval)&&this.updateRefetchInterval(u)},s.getOptimisticResult=function(n){var c=this.client.defaultQueryObserverOptions(n),l=this.client.getQueryCache().build(this.client,c);return this.createResult(l,c)},s.getCurrentResult=function(){return this.currentResult},s.trackResult=function(n,c){var l=this,o={},d=function(h){l.trackedProps.includes(h)||l.trackedProps.push(h)};return Object.keys(n).forEach(function(u){Object.defineProperty(o,u,{configurable:!1,enumerable:!0,get:function(){return d(u),n[u]}})}),(c.useErrorBoundary||c.suspense)&&d("error"),o},s.getNextResult=function(n){var c=this;return new Promise(function(l,o){var d=c.subscribe(function(u){u.isFetching||(d(),u.isError&&(n!=null&&n.throwOnError)?o(u.error):l(u))})})},s.getCurrentQuery=function(){return this.currentQuery},s.remove=function(){this.client.getQueryCache().remove(this.currentQuery)},s.refetch=function(n){return this.fetch(J({},n,{meta:{refetchPage:n==null?void 0:n.refetchPage}}))},s.fetchOptimistic=function(n){var c=this,l=this.client.defaultQueryObserverOptions(n),o=this.client.getQueryCache().build(this.client,l);return o.fetch().then(function(){return c.createResult(o,l)})},s.fetch=function(n){var c=this;return this.executeFetch(n).then(function(){return c.updateResult(),c.currentResult})},s.executeFetch=function(n){this.updateQuery();var c=this.currentQuery.fetch(this.options,n);return n!=null&&n.throwOnError||(c=c.catch(he)),c},s.updateStaleTimeout=function(){var n=this;if(this.clearStaleTimeout(),!(Ye||this.currentResult.isStale||!ut(this.options.staleTime))){var c=Gt(this.currentResult.dataUpdatedAt,this.options.staleTime),l=c+1;this.staleTimeoutId=setTimeout(function(){n.currentResult.isStale||n.updateResult()},l)}},s.computeRefetchInterval=function(){var n;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(n=this.options.refetchInterval)!=null?n:!1},s.updateRefetchInterval=function(n){var c=this;this.clearRefetchInterval(),this.currentRefetchInterval=n,!(Ye||this.options.enabled===!1||!ut(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(function(){(c.options.refetchIntervalInBackground||De.isFocused())&&c.executeFetch()},this.currentRefetchInterval))},s.updateTimers=function(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())},s.clearTimers=function(){this.clearStaleTimeout(),this.clearRefetchInterval()},s.clearStaleTimeout=function(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)},s.clearRefetchInterval=function(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)},s.createResult=function(n,c){var l=this.currentQuery,o=this.options,d=this.currentResult,u=this.currentResultState,h=this.currentResultOptions,C=n!==l,w=C?n.state:this.currentQueryInitialState,f=C?this.currentResult:this.previousQueryResult,g=n.state,S=g.dataUpdatedAt,b=g.error,v=g.errorUpdatedAt,y=g.isFetching,N=g.status,k=!1,_=!1,T;if(c.optimisticResults){var B=this.hasListeners(),E=!B&&Dt(n,c),L=B&&Mt(n,l,c,o);(E||L)&&(y=!0,S||(N="loading"))}if(c.keepPreviousData&&!g.dataUpdateCount&&(f!=null&&f.isSuccess)&&N!=="error")T=f.data,S=f.dataUpdatedAt,N=f.status,k=!0;else if(c.select&&typeof g.data<"u")if(d&&g.data===(u==null?void 0:u.data)&&c.select===this.selectFn)T=this.selectResult;else try{this.selectFn=c.select,T=c.select(g.data),c.structuralSharing!==!1&&(T=Xe(d==null?void 0:d.data,T)),this.selectResult=T,this.selectError=null}catch(j){tt().error(j),this.selectError=j}else T=g.data;if(typeof c.placeholderData<"u"&&typeof T>"u"&&(N==="loading"||N==="idle")){var D;if(d!=null&&d.isPlaceholderData&&c.placeholderData===(h==null?void 0:h.placeholderData))D=d.data;else if(D=typeof c.placeholderData=="function"?c.placeholderData():c.placeholderData,c.select&&typeof D<"u")try{D=c.select(D),c.structuralSharing!==!1&&(D=Xe(d==null?void 0:d.data,D)),this.selectError=null}catch(j){tt().error(j),this.selectError=j}typeof D<"u"&&(N="success",T=D,_=!0)}this.selectError&&(b=this.selectError,T=this.selectResult,v=Date.now(),N="error");var I={status:N,isLoading:N==="loading",isSuccess:N==="success",isError:N==="error",isIdle:N==="idle",data:T,dataUpdatedAt:S,error:b,errorUpdatedAt:v,failureCount:g.fetchFailureCount,errorUpdateCount:g.errorUpdateCount,isFetched:g.dataUpdateCount>0||g.errorUpdateCount>0,isFetchedAfterMount:g.dataUpdateCount>w.dataUpdateCount||g.errorUpdateCount>w.errorUpdateCount,isFetching:y,isRefetching:y&&N!=="loading",isLoadingError:N==="error"&&g.dataUpdatedAt===0,isPlaceholderData:_,isPreviousData:k,isRefetchError:N==="error"&&g.dataUpdatedAt!==0,isStale:St(n,c),refetch:this.refetch,remove:this.remove};return I},s.shouldNotifyListeners=function(n,c){if(!c)return!0;var l=this.options,o=l.notifyOnChangeProps,d=l.notifyOnChangePropsExclusions;if(!o&&!d||o==="tracked"&&!this.trackedProps.length)return!0;var u=o==="tracked"?this.trackedProps:o;return Object.keys(n).some(function(h){var C=h,w=n[C]!==c[C],f=u==null?void 0:u.some(function(S){return S===h}),g=d==null?void 0:d.some(function(S){return S===h});return w&&!g&&(!u||f)})},s.updateResult=function(n){var c=this.currentResult;if(this.currentResult=this.createResult(this.currentQuery,this.options),this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,!Er(this.currentResult,c)){var l={cache:!0};(n==null?void 0:n.listeners)!==!1&&this.shouldNotifyListeners(this.currentResult,c)&&(l.listeners=!0),this.notify(J({},l,n))}},s.updateQuery=function(){var n=this.client.getQueryCache().build(this.client,this.options);if(n!==this.currentQuery){var c=this.currentQuery;this.currentQuery=n,this.currentQueryInitialState=n.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(c==null||c.removeObserver(this),n.addObserver(this))}},s.onQueryUpdate=function(n){var c={};n.type==="success"?c.onSuccess=!0:n.type==="error"&&!We(n.error)&&(c.onError=!0),this.updateResult(c),this.hasListeners()&&this.updateTimers()},s.notify=function(n){var c=this;ie.batch(function(){n.onSuccess?(c.options.onSuccess==null||c.options.onSuccess(c.currentResult.data),c.options.onSettled==null||c.options.onSettled(c.currentResult.data,null)):n.onError&&(c.options.onError==null||c.options.onError(c.currentResult.error),c.options.onSettled==null||c.options.onSettled(void 0,c.currentResult.error)),n.listeners&&c.listeners.forEach(function(l){l(c.currentResult)}),n.cache&&c.client.getQueryCache().notify({query:c.currentQuery,type:"observerResultsUpdated"})})},r}(Ue);function Yr(t,r){return r.enabled!==!1&&!t.state.dataUpdatedAt&&!(t.state.status==="error"&&r.retryOnMount===!1)}function Dt(t,r){return Yr(t,r)||t.state.dataUpdatedAt>0&&mt(t,r,r.refetchOnMount)}function mt(t,r,s){if(r.enabled!==!1){var i=typeof s=="function"?s(t):s;return i==="always"||i!==!1&&St(t,r)}return!1}function Mt(t,r,s,i){return s.enabled!==!1&&(t!==r||i.enabled===!1)&&(!s.suspense||t.state.status!=="error")&&St(t,s)}function St(t,r){return t.isStaleByTime(r.staleTime)}var Jr=kr.unstable_batchedUpdates;ie.setBatchNotifyFunction(Jr);var Zr=console;Ur(Zr);var $t=te.createContext(void 0),Yt=te.createContext(!1);function Jt(t){return t&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=$t),window.ReactQueryClientContext):$t}var Zt=function(){var r=te.useContext(Jt(te.useContext(Yt)));if(!r)throw new Error("No QueryClient set, use QueryClientProvider to set one");return r},Xr=function(r){var s=r.client,i=r.contextSharing,n=i===void 0?!1:i,c=r.children;te.useEffect(function(){return s.mount(),function(){s.unmount()}},[s]);var l=Jt(n);return te.createElement(Yt.Provider,{value:n},te.createElement(l.Provider,{value:s},c))};function ea(){var t=!1;return{clearReset:function(){t=!1},reset:function(){t=!0},isReset:function(){return t}}}var ta=te.createContext(ea()),ra=function(){return te.useContext(ta)};function aa(t,r,s){return typeof r=="function"?r.apply(void 0,s):typeof r=="boolean"?r:!!t}function sa(t,r){var s=te.useRef(!1),i=te.useState(0),n=i[1],c=Zt(),l=ra(),o=c.defaultQueryObserverOptions(t);o.optimisticResults=!0,o.onError&&(o.onError=ie.batchCalls(o.onError)),o.onSuccess&&(o.onSuccess=ie.batchCalls(o.onSuccess)),o.onSettled&&(o.onSettled=ie.batchCalls(o.onSettled)),o.suspense&&(typeof o.staleTime!="number"&&(o.staleTime=1e3),o.cacheTime===0&&(o.cacheTime=1)),(o.suspense||o.useErrorBoundary)&&(l.isReset()||(o.retryOnMount=!1));var d=te.useState(function(){return new r(c,o)}),u=d[0],h=u.getOptimisticResult(o);if(te.useEffect(function(){s.current=!0,l.clearReset();var C=u.subscribe(ie.batchCalls(function(){s.current&&n(function(w){return w+1})}));return u.updateResult(),function(){s.current=!1,C()}},[l,u]),te.useEffect(function(){u.setOptions(o,{listeners:!1})},[o,u]),o.suspense&&h.isLoading)throw u.fetchOptimistic(o).then(function(C){var w=C.data;o.onSuccess==null||o.onSuccess(w),o.onSettled==null||o.onSettled(w,null)}).catch(function(C){l.clearReset(),o.onError==null||o.onError(C),o.onSettled==null||o.onSettled(void 0,C)});if(h.isError&&!l.isReset()&&!h.isFetching&&aa(o.suspense,o.useErrorBoundary,[h.error,u.getCurrentQuery()]))throw h.error;return o.notifyOnChangeProps==="tracked"&&(h=u.trackResult(h,o)),h}function be(t,r,s){var i=ze(t,r,s);return sa(i,Vr)}let na={data:""},ia=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||na,la=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,ca=/\/\*[^]*?\*\/|  +/g,Ut=/\n+/g,Ae=(t,r)=>{let s="",i="",n="";for(let c in t){let l=t[c];c[0]=="@"?c[1]=="i"?s=c+" "+l+";":i+=c[1]=="f"?Ae(l,c):c+"{"+Ae(l,c[1]=="k"?"":r)+"}":typeof l=="object"?i+=Ae(l,r?r.replace(/([^,])+/g,o=>c.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,o):o?o+" "+d:d)):c):l!=null&&(c=/^--/.test(c)?c:c.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=Ae.p?Ae.p(c,l):c+":"+l+";")}return s+(r&&n?r+"{"+n+"}":n)+i},_e={},Xt=t=>{if(typeof t=="object"){let r="";for(let s in t)r+=s+Xt(t[s]);return r}return t},oa=(t,r,s,i,n)=>{let c=Xt(t),l=_e[c]||(_e[c]=(d=>{let u=0,h=11;for(;u<d.length;)h=101*h+d.charCodeAt(u++)>>>0;return"go"+h})(c));if(!_e[l]){let d=c!==t?t:(u=>{let h,C,w=[{}];for(;h=la.exec(u.replace(ca,""));)h[4]?w.shift():h[3]?(C=h[3].replace(Ut," ").trim(),w.unshift(w[0][C]=w[0][C]||{})):w[0][h[1]]=h[2].replace(Ut," ").trim();return w[0]})(t);_e[l]=Ae(n?{["@keyframes "+l]:d}:d,s?"":"."+l)}let o=s&&_e.g?_e.g:null;return s&&(_e.g=_e[l]),((d,u,h,C)=>{C?u.data=u.data.replace(C,d):u.data.indexOf(d)===-1&&(u.data=h?d+u.data:u.data+d)})(_e[l],r,i,o),l},da=(t,r,s)=>t.reduce((i,n,c)=>{let l=r[c];if(l&&l.call){let o=l(s),d=o&&o.props&&o.props.className||/^go/.test(o)&&o;l=d?"."+d:o&&typeof o=="object"?o.props?"":Ae(o,""):o===!1?"":o}return i+n+(l??"")},"");function it(t){let r=this||{},s=t.call?t(r.p):t;return oa(s.unshift?s.raw?da(s,[].slice.call(arguments,1),r.p):s.reduce((i,n)=>Object.assign(i,n&&n.call?n(r.p):n),{}):s,ia(r.target),r.g,r.o,r.k)}let er,pt,ft;it.bind({g:1});let xe=it.bind({k:1});function ua(t,r,s,i){Ae.p=r,er=t,pt=s,ft=i}function Le(t,r){let s=this||{};return function(){let i=arguments;function n(c,l){let o=Object.assign({},c),d=o.className||n.className;s.p=Object.assign({theme:pt&&pt()},o),s.o=/ *go\d+/.test(d),o.className=it.apply(s,i)+(d?" "+d:""),r&&(o.ref=l);let u=t;return t[0]&&(u=o.as||t,delete o.as),ft&&u[0]&&ft(o),er(u,o)}return r?r(n):n}}var ha=t=>typeof t=="function",rt=(t,r)=>ha(t)?t(r):t,ma=(()=>{let t=0;return()=>(++t).toString()})(),tr=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let r=matchMedia("(prefers-reduced-motion: reduce)");t=!r||r.matches}return t}})(),pa=20,wt="default",rr=(t,r)=>{let{toastLimit:s}=t.settings;switch(r.type){case 0:return{...t,toasts:[r.toast,...t.toasts].slice(0,s)};case 1:return{...t,toasts:t.toasts.map(l=>l.id===r.toast.id?{...l,...r.toast}:l)};case 2:let{toast:i}=r;return rr(t,{type:t.toasts.find(l=>l.id===i.id)?1:0,toast:i});case 3:let{toastId:n}=r;return{...t,toasts:t.toasts.map(l=>l.id===n||n===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return r.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(l=>l.id!==r.toastId)};case 5:return{...t,pausedAt:r.time};case 6:let c=r.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+c}))}}},Ve=[],ar={toasts:[],pausedAt:void 0,settings:{toastLimit:pa}},Se={},sr=(t,r=wt)=>{Se[r]=rr(Se[r]||ar,t),Ve.forEach(([s,i])=>{s===r&&i(Se[r])})},nr=t=>Object.keys(Se).forEach(r=>sr(t,r)),fa=t=>Object.keys(Se).find(r=>Se[r].toasts.some(s=>s.id===t)),lt=(t=wt)=>r=>{sr(r,t)},ga={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},va=(t={},r=wt)=>{let[s,i]=p.useState(Se[r]||ar),n=p.useRef(Se[r]);p.useEffect(()=>(n.current!==Se[r]&&i(Se[r]),Ve.push([r,i]),()=>{let l=Ve.findIndex(([o])=>o===r);l>-1&&Ve.splice(l,1)}),[r]);let c=s.toasts.map(l=>{var o,d,u;return{...t,...t[l.type],...l,removeDelay:l.removeDelay||((o=t[l.type])==null?void 0:o.removeDelay)||(t==null?void 0:t.removeDelay),duration:l.duration||((d=t[l.type])==null?void 0:d.duration)||(t==null?void 0:t.duration)||ga[l.type],style:{...t.style,...(u=t[l.type])==null?void 0:u.style,...l.style}}});return{...s,toasts:c}},ba=(t,r="blank",s)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:r,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...s,id:(s==null?void 0:s.id)||ma()}),qe=t=>(r,s)=>{let i=ba(r,t,s);return lt(i.toasterId||fa(i.id))({type:2,toast:i}),i.id},ce=(t,r)=>qe("blank")(t,r);ce.error=qe("error");ce.success=qe("success");ce.loading=qe("loading");ce.custom=qe("custom");ce.dismiss=(t,r)=>{let s={type:3,toastId:t};r?lt(r)(s):nr(s)};ce.dismissAll=t=>ce.dismiss(void 0,t);ce.remove=(t,r)=>{let s={type:4,toastId:t};r?lt(r)(s):nr(s)};ce.removeAll=t=>ce.remove(void 0,t);ce.promise=(t,r,s)=>{let i=ce.loading(r.loading,{...s,...s==null?void 0:s.loading});return typeof t=="function"&&(t=t()),t.then(n=>{let c=r.success?rt(r.success,n):void 0;return c?ce.success(c,{id:i,...s,...s==null?void 0:s.success}):ce.dismiss(i),n}).catch(n=>{let c=r.error?rt(r.error,n):void 0;c?ce.error(c,{id:i,...s,...s==null?void 0:s.error}):ce.dismiss(i)}),t};var ya=1e3,Na=(t,r="default")=>{let{toasts:s,pausedAt:i}=va(t,r),n=p.useRef(new Map).current,c=p.useCallback((C,w=ya)=>{if(n.has(C))return;let f=setTimeout(()=>{n.delete(C),l({type:4,toastId:C})},w);n.set(C,f)},[]);p.useEffect(()=>{if(i)return;let C=Date.now(),w=s.map(f=>{if(f.duration===1/0)return;let g=(f.duration||0)+f.pauseDuration-(C-f.createdAt);if(g<0){f.visible&&ce.dismiss(f.id);return}return setTimeout(()=>ce.dismiss(f.id,r),g)});return()=>{w.forEach(f=>f&&clearTimeout(f))}},[s,i,r]);let l=p.useCallback(lt(r),[r]),o=p.useCallback(()=>{l({type:5,time:Date.now()})},[l]),d=p.useCallback((C,w)=>{l({type:1,toast:{id:C,height:w}})},[l]),u=p.useCallback(()=>{i&&l({type:6,time:Date.now()})},[i,l]),h=p.useCallback((C,w)=>{let{reverseOrder:f=!1,gutter:g=8,defaultPosition:S}=w||{},b=s.filter(N=>(N.position||S)===(C.position||S)&&N.height),v=b.findIndex(N=>N.id===C.id),y=b.filter((N,k)=>k<v&&N.visible).length;return b.filter(N=>N.visible).slice(...f?[y+1]:[0,y]).reduce((N,k)=>N+(k.height||0)+g,0)},[s]);return p.useEffect(()=>{s.forEach(C=>{if(C.dismissed)c(C.id,C.removeDelay);else{let w=n.get(C.id);w&&(clearTimeout(w),n.delete(C.id))}})},[s,c]),{toasts:s,handlers:{updateHeight:d,startPause:o,endPause:u,calculateOffset:h}}},Ca=xe`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Sa=xe`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,wa=xe`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,_a=Le("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Ca} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Sa} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${wa} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,xa=xe`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Ra=Le("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${xa} 1s linear infinite;
`,Aa=xe`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,La=xe`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,ka=Le("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Aa} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${La} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Pa=Le("div")`
  position: absolute;
`,Fa=Le("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Ia=xe`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Ea=Le("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Ia} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Oa=({toast:t})=>{let{icon:r,type:s,iconTheme:i}=t;return r!==void 0?typeof r=="string"?p.createElement(Ea,null,r):r:s==="blank"?null:p.createElement(Fa,null,p.createElement(Ra,{...i}),s!=="loading"&&p.createElement(Pa,null,s==="error"?p.createElement(_a,{...i}):p.createElement(ka,{...i})))},Ta=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Da=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,Ma="0%{opacity:0;} 100%{opacity:1;}",$a="0%{opacity:1;} 100%{opacity:0;}",Ua=Le("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,qa=Le("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,ja=(t,r)=>{let s=t.includes("top")?1:-1,[i,n]=tr()?[Ma,$a]:[Ta(s),Da(s)];return{animation:r?`${xe(i)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${xe(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Qa=p.memo(({toast:t,position:r,style:s,children:i})=>{let n=t.height?ja(t.position||r||"top-center",t.visible):{opacity:0},c=p.createElement(Oa,{toast:t}),l=p.createElement(qa,{...t.ariaProps},rt(t.message,t));return p.createElement(Ua,{className:t.className,style:{...n,...s,...t.style}},typeof i=="function"?i({icon:c,message:l}):p.createElement(p.Fragment,null,c,l))});ua(p.createElement);var Ba=({id:t,className:r,style:s,onHeightUpdate:i,children:n})=>{let c=p.useCallback(l=>{if(l){let o=()=>{let d=l.getBoundingClientRect().height;i(t,d)};o(),new MutationObserver(o).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[t,i]);return p.createElement("div",{ref:c,className:r,style:s},n)},Ga=(t,r)=>{let s=t.includes("top"),i=s?{top:0}:{bottom:0},n=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:tr()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${r*(s?1:-1)}px)`,...i,...n}},Ha=it`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ge=16,za=({reverseOrder:t,position:r="top-center",toastOptions:s,gutter:i,children:n,toasterId:c,containerStyle:l,containerClassName:o})=>{let{toasts:d,handlers:u}=Na(s,c);return p.createElement("div",{"data-rht-toaster":c||"",style:{position:"fixed",zIndex:9999,top:Ge,left:Ge,right:Ge,bottom:Ge,pointerEvents:"none",...l},className:o,onMouseEnter:u.startPause,onMouseLeave:u.endPause},d.map(h=>{let C=h.position||r,w=u.calculateOffset(h,{reverseOrder:t,gutter:i,defaultPosition:r}),f=Ga(C,w);return p.createElement(Ba,{id:h.id,key:h.id,onHeightUpdate:u.updateHeight,className:h.visible?Ha:"",style:f},h.type==="custom"?rt(h.message,h):n?n(h):p.createElement(Qa,{toast:h,position:C}))}))},F=ce;const _t="/assets/logo-3b0ed7d8.jpg";function Ka(){return p.useEffect(()=>(["icon","shortcut icon"].forEach(r=>{let s=document.querySelector(`link[rel="${r}"]`);s||(s=document.createElement("link"),s.setAttribute("rel",r),document.head.appendChild(s)),s.setAttribute("href",_t),s.setAttribute("type","image/jpeg")}),()=>{}),[]),null}const Wa=()=>{const t=new Date().getFullYear();return e("footer",{className:"app-footer",role:"contentinfo",children:a("div",{className:"footer-inner",children:[e("div",{className:"footer-brandline",children:a($,{to:"/",className:"brand-wrap","aria-label":"Go to home",children:[e("img",{src:_t,alt:"Faculty Reporting System logo",className:"brand-logo"}),e("span",{className:"brand-name",children:"Faculty Reporting System"})]})}),a("div",{className:"footer-grid",children:[a("div",{className:"footer-col",children:[e("div",{className:"footer-col-title",children:"Product"}),e($,{to:"/",className:"footer-link",children:"Home"}),e($,{to:"/reports",className:"footer-link",children:"Reports"}),e($,{to:"/analytics",className:"footer-link",children:"Analytics"})]}),a("div",{className:"footer-col",children:[e("div",{className:"footer-col-title",children:"Account"}),e($,{to:"/profile",className:"footer-link",children:"Profile"}),e($,{to:"/login",className:"footer-link",children:"Login"}),e($,{to:"/register",className:"footer-link",children:"Register"})]}),a("div",{className:"footer-col",children:[e("div",{className:"footer-col-title",children:"Resources"}),e("a",{href:"#",className:"footer-link",children:"Help Center"}),e("a",{href:"#",className:"footer-link",children:"Privacy"}),e("a",{href:"#",className:"footer-link",children:"Terms"})]})]}),a("div",{className:"footer-bottom",children:[a("span",{className:"footer-copy",children:[" ",t," Faculty Reporting System"]}),a("div",{className:"footer-bottom-links",children:[e("a",{href:"#",className:"footer-link",children:"Privacy"}),e("a",{href:"#",className:"footer-link",children:"Terms"}),e("a",{href:"#",className:"footer-link",children:"Status"})]})]})]})})},Va=typeof import.meta<"u"&&{VITE_API_URL:"http://localhost:5003/api",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&!1,U=gr.create({baseURL:Va?"/api":typeof import.meta<"u"&&{VITE_API_URL:"http://localhost:5003/api",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"http://localhost:5003/api"||typeof process<"u"&&process.env&&{}.REACT_APP_API_URL||"/api",timeout:3e4,headers:{"Content-Type":"application/json"}});U.interceptors.request.use(t=>{const r=localStorage.getItem("token");return r&&(t.headers.Authorization=`Bearer ${r}`),t},t=>Promise.reject(t));U.interceptors.response.use(t=>t,t=>{var l,o,d,u,h;const{response:r}=t,s=((l=r==null?void 0:r.config)==null?void 0:l.url)||((o=t==null?void 0:t.config)==null?void 0:o.url)||"",i=typeof s=="string"&&s.startsWith("/dashboard"),c=(((d=r==null?void 0:r.config)==null?void 0:d.method)||((u=t==null?void 0:t.config)==null?void 0:u.method)||"get").toLowerCase()==="get";if(r)switch(r.status){case 401:localStorage.removeItem("token"),delete U.defaults.headers.common.Authorization,window.location.pathname!=="/login"&&(window.location.href="/login");break;case 403:F.error("Access denied. You do not have permission for this action.");break;case 404:c||F.error("Resource not found.");break;case 429:c||F.error("Too many requests. Please try again later.");break;case 500:!i&&!c&&F.error("Server error. Please try again later.");break;default:!i&&!c&&((h=r.data)!=null&&h.error?F.error(r.data.error):F.error("An unexpected error occurred."))}else c||(t.code==="NETWORK_ERROR"?F.error("Network error. Please check your connection."):t.code==="TIMEOUT"?F.error("Request timeout. Please try again."):F.error("An unexpected error occurred."));return Promise.reject(t)});const M={auth:{login:t=>U.post("/auth/login",t),register:t=>U.post("/auth/register",t),getMe:()=>U.get("/auth/me"),changePassword:t=>U.post("/auth/change-password",t),logout:()=>U.post("/auth/logout"),verifyToken:()=>U.get("/auth/verify-token")},dashboard:{getPublic:()=>U.get("/dashboard/public"),getPersonal:()=>U.get("/dashboard/personal"),getAnalytics:(t=30)=>U.get("/dashboard/analytics",{params:{days:t}}),getNotifications:t=>U.get("/dashboard/notifications",{params:t}),getPending:t=>U.get("/dashboard/pending",{params:t}),getPendingCount:()=>U.get("/dashboard/pending/count"),getNotificationsCount:()=>U.get("/dashboard/notifications/count"),markNotificationRead:(t,r)=>U.post("/dashboard/notifications/mark-read",{type:t,id:r}),markAllNotificationsRead:()=>U.post("/dashboard/notifications/mark-all-read")},reports:{getAll:t=>U.get("/reports",{params:t}),getById:t=>U.get(`/reports/${t}`),create:t=>U.post("/reports",t),update:(t,r)=>U.put(`/reports/${t}`,r),moderate:(t,r)=>U.put(`/reports/${t}/moderate`,r),submit:t=>U.post(`/reports/${t}/submit`),delete:t=>U.delete(`/reports/${t}`),uploadAttachments:(t,r)=>U.post(`/reports/${t}/attachments`,r,{headers:{"Content-Type":"multipart/form-data"}}),listAttachments:t=>U.get(`/reports/${t}/attachments`),addFeedback:(t,r)=>U.post(`/reports/${t}/feedback`,r),getStats:()=>U.get("/reports/stats/summary")},users:{getMe:()=>U.get("/users/me"),updateMe:t=>U.put("/users/me",t),uploadAvatar:t=>{const r=new FormData;return r.append("avatar",t),U.post("/users/me/avatar",r,{headers:{"Content-Type":"multipart/form-data"}})},getAll:t=>U.get("/users",{params:t}),getById:t=>U.get(`/users/${t}`),create:t=>U.post("/users",t),update:(t,r)=>U.put(`/users/${t}`,r),delete:t=>U.delete(`/users/${t}`),deactivate:t=>U.post(`/users/${t}/deactivate`),reactivate:t=>U.post(`/users/${t}/reactivate`),resetPassword:t=>U.post(`/users/${t}/reset-password`),enroll:(t,r)=>U.post(`/users/${t}/enroll`,r),assignCourse:(t,r)=>U.post(`/users/${t}/assign-course`,r),getAvailableCourses:t=>U.get("/users/courses/available",{params:t}),getStreams:()=>U.get("/users/streams/list"),getPublicStreams:()=>U.get("/users/public/streams"),getPublicCourses:t=>U.get("/users/public/courses",{params:t}),getLecturersByCourse:t=>U.get("/users/lecturers/by-course",{params:{courseId:t}}),rateClass:t=>U.post("/users/rate-class",t)},export:{reportsExcel:t=>U.get("/export/reports/excel",{params:t,responseType:"blob"}),reportsPdf:t=>U.get("/export/reports/pdf",{params:t}),analyticsExcel:t=>U.get("/export/analytics/excel",{params:t,responseType:"blob"}),usersExcel:t=>U.get("/export/users/excel",{params:t,responseType:"blob"})},admin:{getOverview:t=>t?U.get("/admin/overview",{params:{days:t}}):U.get("/admin/overview"),bulkUsers:t=>U.post("/admin/users/bulk",t),getAudit:t=>U.get("/admin/audit",{params:t})}},Ee=(t,r)=>{const s=window.URL.createObjectURL(t),i=document.createElement("a");i.setAttribute("href",s),i.setAttribute("download",r),document.body.appendChild(i),i.click(),i.remove(),window.URL.revokeObjectURL(s)},Ya={user:null,token:localStorage.getItem("token"),isAuthenticated:!1,isLoading:!0},oe={LOGIN_START:"LOGIN_START",LOGIN_SUCCESS:"LOGIN_SUCCESS",LOGIN_FAILURE:"LOGIN_FAILURE",LOGOUT:"LOGOUT",LOAD_USER_START:"LOAD_USER_START",LOAD_USER_SUCCESS:"LOAD_USER_SUCCESS",LOAD_USER_FAILURE:"LOAD_USER_FAILURE",UPDATE_USER:"UPDATE_USER"},Ja=(t,r)=>{switch(r.type){case oe.LOGIN_START:case oe.LOAD_USER_START:return{...t,isLoading:!0};case oe.LOGIN_SUCCESS:return{...t,user:r.payload.user,token:r.payload.token,isAuthenticated:!0,isLoading:!1};case oe.LOAD_USER_SUCCESS:return{...t,user:r.payload.user,isAuthenticated:!0,isLoading:!1};case oe.LOGIN_FAILURE:case oe.LOAD_USER_FAILURE:case oe.LOGOUT:return{...t,user:null,token:null,isAuthenticated:!1,isLoading:!1};case oe.UPDATE_USER:return{...t,user:{...t.user,...r.payload}};default:return t}},ir=p.createContext(),ye=()=>{const t=p.useContext(ir);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},Za=({children:t})=>{const[r,s]=p.useReducer(Ja,Ya),i=f=>{f?(localStorage.setItem("token",f),U.defaults.headers.common.Authorization=`Bearer ${f}`):(localStorage.removeItem("token"),delete U.defaults.headers.common.Authorization)},n=async()=>{var g;const f=localStorage.getItem("token");if(!f){s({type:oe.LOAD_USER_FAILURE});return}try{s({type:oe.LOAD_USER_START}),i(f);let b=(await U.get("/auth/me")).data.user;try{const v=await U.get("/users/me");(g=v==null?void 0:v.data)!=null&&g.avatarUrl&&(b={...b,avatarUrl:v.data.avatarUrl})}catch{}s({type:oe.LOAD_USER_SUCCESS,payload:{user:b}})}catch(S){console.error("Load user error:",S),s({type:oe.LOAD_USER_FAILURE}),i(null)}},c=async f=>{var g,S,b;try{s({type:oe.LOGIN_START});const v=await U.post("/auth/login",f),{user:y,token:N}=v.data;i(N);let k=y;try{const _=await U.get("/users/me");(g=_==null?void 0:_.data)!=null&&g.avatarUrl&&(k={...k,avatarUrl:_.data.avatarUrl})}catch{}return s({type:oe.LOGIN_SUCCESS,payload:{user:k,token:N}}),F.success(`Welcome back, ${y.firstName}!`),{success:!0}}catch(v){const y=((b=(S=v.response)==null?void 0:S.data)==null?void 0:b.error)||"Login failed";return s({type:oe.LOGIN_FAILURE}),F.error(y),{success:!1,error:y}}},l=async f=>{var g,S;try{const b=await U.post("/auth/register",f),{user:v,token:y}=b.data;return i(y),s({type:oe.LOGIN_SUCCESS,payload:{user:v,token:y}}),F.success(`Welcome to Faculty Reporting, ${v.firstName}!`),{success:!0}}catch(b){const v=((S=(g=b.response)==null?void 0:g.data)==null?void 0:S.error)||"Registration failed";return F.error(v),{success:!1,error:v}}},o=async()=>{try{await U.post("/auth/logout")}catch(f){console.error("Logout API error:",f)}i(null),s({type:oe.LOGOUT}),F.success("Logged out successfully")},d=async f=>{var g,S;try{const b=await U.post("/auth/change-password",f);return F.success(b.data.message),{success:!0}}catch(b){const v=((S=(g=b.response)==null?void 0:g.data)==null?void 0:S.error)||"Password change failed";return F.error(v),{success:!1,error:v}}},u=async f=>{var g,S;try{const b=await U.put(`/users/${r.user.id}`,f);return s({type:oe.UPDATE_USER,payload:b.data.user}),F.success("Profile updated successfully"),{success:!0}}catch(b){const v=((S=(g=b.response)==null?void 0:g.data)==null?void 0:S.error)||"Profile update failed";return F.error(v),{success:!1,error:v}}},h=f=>r.user?Array.isArray(f)?f.includes(r.user.role):r.user.role===f:!1,C=f=>{if(!r.user)return!1;const g={student:1,lecturer:2,program_leader:3,principal_lecturer:4,faculty_manager:5},S=g[r.user.role]||0,b=g[f]||0;return S>=b};p.useEffect(()=>{n()},[]);const w={user:r.user,token:r.token,isAuthenticated:r.isAuthenticated,isLoading:r.isLoading,login:c,register:l,logout:o,loadUser:n,changePassword:d,updateProfile:u,hasRole:h,hasPermission:C};return e(ir.Provider,{value:w,children:t})};const lr=({size:t=64,rounded:r=!0,alt:s="App Logo",className:i=""})=>{const n=typeof t=="number"?`${t}px`:t;return e("img",{src:_t,alt:s,width:n,height:n,className:`${r?"rounded-circle":""} ${i}`.trim(),style:{objectFit:"cover"}})},Xa=()=>{const{user:t,isAuthenticated:r,logout:s}=ye(),i=at(),n=Fe(),[c,l]=p.useState(!1),[o,d]=p.useState(""),u=Zt();p.useEffect(()=>{let y=localStorage.getItem("theme");y||(y=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),d(y),document.documentElement.setAttribute("data-theme",y)},[]);const h=()=>{const v=o==="dark"?"light":"dark";d(v),document.documentElement.setAttribute("data-theme",v),localStorage.setItem("theme",v)},{data:C}=be("notifications-count",async()=>{const v=await M.dashboard.getNotificationsCount();return(v==null?void 0:v.data)??v},{enabled:r,refetchInterval:3e4}),{data:w}=be("pending-count",async()=>{const v=await M.dashboard.getPendingCount();return(v==null?void 0:v.data)??v},{enabled:r&&(t==null?void 0:t.role)!=="student",refetchInterval:3e4}),f=async()=>{await s(),n("/"),l(!1)},g=()=>{l(!1)},S=v=>i.pathname===v||i.pathname.startsWith(v+"/"),b=(C==null?void 0:C.unread)||0;return p.useEffect(()=>{if(!r)return;let v;try{v=new EventSource("/api/notifications/stream"),v.addEventListener("message",()=>{u.invalidateQueries("notifications-count"),u.invalidateQueries("notifications-page")})}catch{}return()=>{try{v&&v.close()}catch{}}},[r,u]),a(Qe,{bg:"dark",variant:"dark",expand:"lg",sticky:"top",expanded:c,onToggle:l,className:"custom-navbar",children:[a(st,{children:[a(Qe.Brand,{as:$,to:"/",onClick:g,className:"d-flex align-items-center gap-2",children:[e(lr,{size:28,rounded:!0,alt:"LUCT Logo",className:"navbar-logo"}),a("span",{className:"brand-text",children:[e("strong",{children:"LUCT"})," Faculty Reporting"]})]}),e(Qe.Toggle,{"aria-controls":"basic-navbar-nav"}),a(Qe.Collapse,{id:"basic-navbar-nav",children:[a(fe,{className:"me-auto d-lg-flex justify-content-lg-between",children:[e(fe.Link,{as:$,to:"/",onClick:g,className:`${S("/")&&i.pathname==="/"?"active":""} my-1 my-lg-0`,children:"Dashboard"}),r&&a(de,{children:[(t==null?void 0:t.role)!=="student"&&a(fe.Link,{as:$,to:"/pending",onClick:g,className:`${S("/pending")?"active":""} my-1 my-lg-0`,children:["Pending",((w==null?void 0:w.count)||0)>0&&e(ue,{bg:"warning",text:"dark",className:"ms-1",children:w.count})]}),a(fe.Link,{as:$,to:"/notifications",onClick:g,className:`${S("/notifications")?"active":""} my-1 my-lg-0`,children:["Notifications",b>0&&e(ue,{bg:"danger",className:"ms-1",children:b})]}),a(fe.Link,{as:$,to:"/reports",onClick:g,className:`${S("/reports")?"active":""} my-1 my-lg-0`,children:["Reports",(t==null?void 0:t.role)==="student"&&b>0&&e(ue,{bg:"primary",className:"ms-1",children:b})]}),(t==null?void 0:t.role)==="student"&&e(fe.Link,{as:$,to:"/my-progress",onClick:g,className:S("/my-progress")?"active":"",children:"My Progress"}),(t==null?void 0:t.role)==="student"&&e(fe.Link,{as:$,to:"/my-classes",onClick:g,className:S("/my-classes")?"active":"",children:"My Classes"}),(t==null?void 0:t.role)==="student"&&e(fe.Link,{as:$,to:"/monitoring",onClick:g,className:S("/monitoring")?"active":"",children:"Monitoring"}),(t==null?void 0:t.role)==="student"&&e(fe.Link,{as:$,to:"/rating",onClick:g,className:S("/rating")?"active":"",children:"Rating"}),(t==null?void 0:t.role)==="lecturer"&&a(V,{title:"Lecturer",id:"lecturer-dropdown",children:[e(V.Item,{as:$,to:"/reports",onClick:g,active:S("/reports"),children:"Reports"}),e(V.Item,{as:$,to:"/lecturer/classes",onClick:g,active:S("/lecturer/classes"),children:"Classes"}),e(V.Item,{as:$,to:"/lecturer/monitoring",onClick:g,active:S("/lecturer/monitoring"),children:"Monitoring"}),e(V.Item,{as:$,to:"/lecturer/rating",onClick:g,active:S("/lecturer/rating"),children:"Rating"}),e(V.Item,{as:$,to:"/reports/lecturer/new",onClick:g,children:"New Lecturer Report"}),e(V.Item,{as:$,to:"/analytics",onClick:g,active:S("/analytics"),children:"Analytics"})]}),(t==null?void 0:t.role)==="principal_lecturer"&&a(V,{title:"PRL",id:"prl-dropdown",children:[e(V.Item,{as:$,to:"/prl/courses",onClick:g,active:S("/prl/courses"),children:"Courses"}),e(V.Item,{as:$,to:"/reports",onClick:g,active:S("/reports"),children:"Reports"}),e(V.Item,{as:$,to:"/prl/monitoring",onClick:g,active:S("/prl/monitoring"),children:"Monitoring"}),e(V.Item,{as:$,to:"/prl/rating",onClick:g,active:S("/prl/rating"),children:"Rating"}),e(V.Item,{as:$,to:"/prl/classes",onClick:g,active:S("/prl/classes"),children:"Classes"})]}),(t==null?void 0:t.role)==="program_leader"&&a(V,{title:"PL",id:"pl-dropdown",children:[e(V.Item,{as:$,to:"/pl/courses",onClick:g,active:S("/pl/courses"),children:"Courses"}),e(V.Item,{as:$,to:"/admin/assign-modules",onClick:g,active:S("/admin/assign-modules"),children:"Assign Modules"}),e(V.Item,{as:$,to:"/reports",onClick:g,active:S("/reports"),children:"Reports"}),e(V.Item,{as:$,to:"/pl/monitoring",onClick:g,active:S("/pl/monitoring"),children:"Monitoring"}),e(V.Item,{as:$,to:"/pl/classes",onClick:g,active:S("/pl/classes"),children:"Classes"}),e(V.Item,{as:$,to:"/admin/assign-modules",onClick:g,active:S("/admin/assign-modules"),children:"Assign Classes"}),e(V.Item,{as:$,to:"/pl/lectures",onClick:g,active:S("/pl/lectures"),children:"Lectures"}),e(V.Item,{as:$,to:"/pl/rating",onClick:g,active:S("/pl/rating"),children:"Rating"})]}),(t==null?void 0:t.role)==="faculty_manager"&&a(V,{title:"Manager",id:"fm-dropdown",children:[e(V.Item,{as:$,to:"/reports",onClick:g,active:S("/reports"),children:"Reports"}),e(V.Item,{as:$,to:"/analytics",onClick:g,active:S("/analytics"),children:"Analytics"}),e(V.Item,{as:$,to:"/users",onClick:g,active:S("/users"),children:"Users"})]}),((t==null?void 0:t.role)==="program_leader"||(t==null?void 0:t.role)==="principal_lecturer"||(t==null?void 0:t.role)==="faculty_manager"||(t==null?void 0:t.role)==="admin")&&a(V,{title:"Admin Tools",id:"admintools-dropdown",children:[e(V.Item,{as:$,to:"/analytics",onClick:g,active:S("/analytics"),children:"Analytics"}),e(V.Item,{as:$,to:"/users",onClick:g,active:S("/users"),children:"User Management"}),(t==null?void 0:t.role)==="admin"&&e(V.Item,{as:$,to:"/admin/audit",onClick:g,active:S("/admin/audit"),children:"Audit Logs"})]})]})]}),e(fe,{className:"ms-auto",children:r?a(V,{title:a("span",{className:"d-inline-flex align-items-center",children:[t!=null&&t.avatarUrl?e("img",{src:t.avatarUrl,alt:"Avatar",className:"rounded-circle me-2",style:{width:24,height:24,objectFit:"cover"},onError:v=>{v.currentTarget.onerror=null,v.currentTarget.src="/default-avatar.svg"}}):e("span",{className:"me-1","aria-hidden":"true",children:""}),t==null?void 0:t.firstName," ",t==null?void 0:t.lastName,(t==null?void 0:t.role)&&e("span",{className:"badge bg-secondary text-uppercase ms-2",style:{fontSize:"0.6rem"},children:String(t.role).replace("_"," ")}),b>0&&e(ue,{bg:"danger",className:"ms-2",children:b})]}),id:"user-dropdown",align:"end",children:[e(V.Item,{as:$,to:"/profile",onClick:g,children:"Profile"}),e(V.Item,{onClick:()=>{n("/reports/create"),g()},children:"Create Report"}),b>0&&a(de,{children:[e(V.Divider,{}),a(V.Item,{disabled:!0,children:[b," New Notification",b>1?"s":""]})]}),e(V.Divider,{}),e(V.Item,{onClick:f,children:"Logout"})]}):a(de,{children:[e(fe.Link,{as:$,to:"/login",onClick:g,className:S("/login")?"active":"",children:"Login"}),e(fe.Link,{as:$,to:"/register",onClick:g,className:S("/register")?"active":"",children:"Register"})]})})]}),e("div",{className:"d-lg-none ms-auto me-2 my-2",children:e("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:h,"aria-label":"Toggle theme",children:e("i",{className:`bi ${o==="dark"?"bi-sun":"bi-moon"}`})})})]}),e("div",{className:"d-none d-lg-block me-3",children:e("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:h,"aria-label":"Toggle theme",children:e("i",{className:`bi ${o==="dark"?"bi-sun":"bi-moon"}`})})})]})},ee=({children:t,roles:r})=>{const{isAuthenticated:s,user:i}=ye(),n=at();return s?r&&i&&!r.includes(i.role)?e(Lt,{to:"/",replace:!0}):t:e(Lt,{to:"/login",replace:!0,state:{from:n}})},xt=()=>e("div",{className:"spinner-wrap",children:e("div",{className:"spinner-border text-primary",role:"status",children:e("span",{className:"visually-hidden",children:"Loading..."})})}),ve=({title:t,value:r,subtitle:s="",icon:i="",color:n="primary",variant:c="default"})=>{const l=c==="hero";return e("div",{className:`card mb-3 ${l?"card-modern":""}`,children:e("div",{className:"card-body",children:a("div",{className:"d-flex align-items-center",children:[i&&e("i",{className:`bi ${i} me-3 text-${n}`,style:{fontSize:l?28:18}}),a("div",{children:[e("div",{className:"small text-muted",children:t}),e("div",{className:l?"display-6 fw-bold mb-0":"fs-4",children:r}),s&&e("div",{className:"text-muted small mt-1",children:s})]})]})})})},es=t=>{switch((t||"").toLowerCase()){case"approved":return"success";case"rejected":return"danger";case"submitted":return"warning";default:return"secondary"}},ts=({reports:t=[]})=>a("div",{className:"card mb-3",children:[a("div",{className:"card-header d-flex align-items-center",children:[e("i",{className:"bi bi-clock-history me-2"}),"Recent Reports"]}),e("div",{className:"card-body",children:!Array.isArray(t)||t.length===0?e("div",{className:"text-muted",children:"No recent reports"}):t.map(r=>a("div",{className:"d-flex align-items-center py-2 border-bottom",children:[e("div",{className:"me-3",children:e("div",{className:"avatar-circle bg-primary text-white d-inline-flex align-items-center justify-content-center",children:e("i",{className:"bi bi-file-earmark-text"})})}),a("div",{className:"flex-grow-1",children:[a("div",{className:"fw-semibold d-flex align-items-center gap-2",children:[e($,{to:`/reports/${r.id}`,className:"text-decoration-none",children:r.title||"Untitled report"}),(r.status||"").toLowerCase()==="draft"&&e("span",{className:"badge bg-secondary",children:"Draft"}),(r.status||"").toLowerCase()==="reviewed"&&e("span",{className:"badge bg-info text-dark",children:"Reviewed"}),(r.status||"").toLowerCase()==="submitted"&&e("span",{className:"badge bg-warning text-dark",children:"Submitted"}),(r.status||"").toLowerCase()==="approved"&&e("span",{className:"badge bg-success",children:"Approved"}),(r.status||"").toLowerCase()==="rejected"&&e("span",{className:"badge bg-danger",children:"Rejected"})]}),e("div",{className:"text-muted small",children:r.course_name?r.course_name:"General"})]}),a("div",{className:"d-flex align-items-center gap-3",children:[r.status&&(r.status||"").toLowerCase()!=="draft"&&e("span",{className:`badge bg-${es(r.status)}`,children:r.status}),r.created_at&&e("small",{className:"text-muted",children:new Date(r.created_at).toLocaleDateString()})]})]},r.id))})]}),rs=({userRole:t})=>a("div",{className:"card mb-3",children:[e("div",{className:"card-header",children:"Quick Actions"}),e("div",{className:"card-body",children:a("div",{className:"quick-tiles",children:[t!=="student"?a($,{to:"/reports/lecturer/new",className:"tile tile-primary",children:[e("i",{className:"bi bi-journal-plus"}),a("div",{children:[e("div",{className:"tile-title",children:"New Lecturer Report"}),e("div",{className:"tile-sub",children:"Submit your lecture details"})]})]}):a($,{to:"/reports/create",className:"tile tile-primary",children:[e("i",{className:"bi bi-plus-circle"}),a("div",{children:[e("div",{className:"tile-title",children:"Create Report"}),e("div",{className:"tile-sub",children:"Start a new submission"})]})]}),a($,{to:"/reports",className:"tile tile-secondary",children:[e("i",{className:"bi bi-file-text"}),a("div",{children:[e("div",{className:"tile-title",children:"My Reports"}),e("div",{className:"tile-sub",children:"View and manage"})]})]}),t==="student"&&a($,{to:"/my-progress",className:"tile tile-success",children:[e("i",{className:"bi bi-graph-up-arrow"}),a("div",{children:[e("div",{className:"tile-title",children:"My Progress"}),e("div",{className:"tile-sub",children:"Performance insights"})]})]})]})})]}),as=()=>{var d,u;const{data:t,isLoading:r,error:s,refetch:i,isFetching:n}=be("dashboard-notifications",async()=>{const h=await M.dashboard.getNotifications();return(h==null?void 0:h.data)??h},{refetchInterval:3e4}),c=(t==null?void 0:t.notifications)||[],l=c.filter(h=>!h.read).length,o=async()=>{var h,C;try{await M.dashboard.markAllNotificationsRead(),await i(),F.success("All notifications marked as read")}catch(w){F.error(((C=(h=w==null?void 0:w.response)==null?void 0:h.data)==null?void 0:C.error)||"Failed to mark all as read")}};return a("div",{className:"card",children:[a("div",{className:"card-header d-flex align-items-center justify-content-between",children:[a("div",{className:"d-flex align-items-center gap-2",children:[e("span",{children:"Notifications"}),l>0&&e("span",{className:"badge bg-danger",title:"Unread",children:l})]}),a("div",{className:"d-flex align-items-center gap-2",children:[e("span",{className:"badge bg-secondary",title:"Total shown",children:c.length}),e("button",{className:"btn btn-sm btn-outline-success",onClick:o,disabled:r||n||l===0,children:e("i",{className:"bi bi-check2-all"})}),e($,{to:"/notifications",className:"btn btn-sm btn-outline-primary",children:"View all"})]})]}),a("div",{className:"card-body",children:[r&&e("div",{className:"text-muted",children:"Loading notifications..."}),s&&e("div",{className:"alert alert-danger",children:((u=(d=s==null?void 0:s.response)==null?void 0:d.data)==null?void 0:u.error)||"Failed to load notifications"}),!r&&!s&&c.length===0&&e("div",{className:"text-muted",children:"No notifications."}),!r&&!s&&c.length>0&&e("div",{className:"list-group list-group-flush",children:c.map(h=>a("div",{className:`list-group-item d-flex align-items-start gap-3 ${h.read?"":"bg-light"}`,children:[e("div",{className:"text-primary",children:h.type==="feedback"?e("i",{className:"bi bi-chat-left-text"}):e("i",{className:"bi bi-file-earmark-text"})}),a("div",{className:"flex-grow-1",children:[e("div",{className:"fw-semibold",children:h.title||"Notification"}),e("div",{className:"text-muted small",children:h.message})]}),e("div",{className:"text-nowrap small text-muted",children:h.created_at?new Date(h.created_at).toLocaleString():""})]},`${h.type}-${h.id}`))})]})]})},cr="label";function qt(t,r){typeof t=="function"?t(r):t&&(t.current=r)}function ss(t,r){const s=t.options;s&&r&&Object.assign(s,r)}function or(t,r){t.labels=r}function dr(t,r){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:cr;const i=[];t.datasets=r.map(n=>{const c=t.datasets.find(l=>l[s]===n[s]);return!c||!n.data||i.includes(c)?{...n}:(i.push(c),Object.assign(c,n),c)})}function ns(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cr;const s={labels:[],datasets:[]};return or(s,t.labels),dr(s,t.datasets,r),s}function is(t,r){const{height:s=150,width:i=300,redraw:n=!1,datasetIdKey:c,type:l,data:o,options:d,plugins:u=[],fallbackContent:h,updateMode:C,...w}=t,f=p.useRef(null),g=p.useRef(null),S=()=>{f.current&&(g.current=new $e(f.current,{type:l,data:ns(o,c),options:d&&{...d},plugins:u}),qt(r,g.current))},b=()=>{qt(r,null),g.current&&(g.current.destroy(),g.current=null)};return p.useEffect(()=>{!n&&g.current&&d&&ss(g.current,d)},[n,d]),p.useEffect(()=>{!n&&g.current&&or(g.current.config.data,o.labels)},[n,o.labels]),p.useEffect(()=>{!n&&g.current&&o.datasets&&dr(g.current.config.data,o.datasets,c)},[n,o.datasets]),p.useEffect(()=>{g.current&&(n?(b(),setTimeout(S)):g.current.update(C))},[n,d,o.labels,o.datasets,C]),p.useEffect(()=>{g.current&&(b(),setTimeout(S))},[l]),p.useEffect(()=>(S(),()=>b()),[]),te.createElement("canvas",{ref:f,role:"img",height:s,width:i,...w},h)}const ls=p.forwardRef(is);function Rt(t,r){return $e.register(r),p.forwardRef((s,i)=>te.createElement(ls,{...s,ref:i,type:t}))}const At=Rt("line",vr),ot=Rt("bar",br),cs=Rt("pie",yr);$e.register(gt,vt,bt,yt,Nt,Qt);const os={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!0,backgroundColor:"rgba(15, 23, 42, 0.9)",borderColor:"rgba(255,255,255,0.12)",borderWidth:1,titleColor:"#fff",bodyColor:"#e5e7eb",displayColors:!1,callbacks:{label:t=>` ${t.parsed.y}`}}},elements:{point:{radius:0,hitRadius:6,hoverRadius:4},line:{tension:.35}},scales:{x:{grid:{display:!1},ticks:{display:!1}},y:{grid:{display:!1},ticks:{display:!1}}}};function jt({label:t="Activity",series:r=[]}){let s="rgba(13,110,253,1)",i="rgba(13,110,253,0.20)";try{const o=(getComputedStyle(document.documentElement).getPropertyValue("--brand")||"").trim();o&&(s=o,i=o.startsWith("#")?`${o}33`:"rgba(13,110,253,0.20)")}catch{}const c={labels:r.map((l,o)=>`${o+1}`),datasets:[{data:r,borderColor:s,backgroundColor:i,fill:!0,borderWidth:2}]};return e("div",{style:{height:140},children:e(At,{data:c,options:os,"aria-label":t,role:"img"})})}const ds=()=>{const{isAuthenticated:t,user:r}=ye(),{data:s,isLoading:i,error:n}=be("dashboard-public",M.dashboard.getPublic,{refetchInterval:6e4,select:C=>(C==null?void 0:C.data)??C,onError:()=>{}}),{data:c}=be(["reports-drafts",r==null?void 0:r.id],async()=>{const C=await M.reports.getAll({status:"draft",limit:5,page:1});return(C==null?void 0:C.data)??C},{enabled:t&&(r==null?void 0:r.role)==="student"}),{data:l,isLoading:o,error:d}=be("dashboard-personal",M.dashboard.getPersonal,{enabled:t,refetchInterval:3e4,select:C=>(C==null?void 0:C.data)??C,onError:()=>{}});return i||t&&o?e(xt,{}):a(st,{fluid:!0,className:"dashboard-container",children:[a("div",{className:"dashboard-header mb-4",children:[e("h2",{children:t?"Personal Dashboard":"Faculty Reporting Dashboard"}),e("p",{className:"text-muted",children:t?"Welcome back! Here's your personalized overview.":"Monitor academic reporting and faculty activities."})]}),t?(()=>{var C,w,f,g,S,b,v,y,N,k,_,T,B,E,L;return a(de,{children:[d&&e(z,{className:"mb-3",children:e(P,{children:e(Z,{variant:"danger",children:((w=(C=d==null?void 0:d.response)==null?void 0:C.data)==null?void 0:w.error)||"Failed to load personal dashboard"})})}),e(z,{className:"mb-4",children:e(P,{children:e(Z,{variant:"success",className:"d-flex align-items-center",children:a("div",{children:[a("h5",{className:"mb-0",children:["Welcome back, ",r==null?void 0:r.firstName," ",r==null?void 0:r.lastName,"!"]}),a("small",{children:["Role: ",(f=r==null?void 0:r.role)==null?void 0:f.replace("_"," ").toUpperCase()]})]})})})}),e(z,{className:"mb-4",children:(r==null?void 0:r.role)==="student"?a(de,{children:[e(P,{md:3,children:e(ve,{title:"My Reports",value:((g=l==null?void 0:l.personalStats)==null?void 0:g.my_reports)||0,color:"primary",variant:"hero"})}),e(P,{md:3,children:e(ve,{title:"Pending Reports",value:((S=l==null?void 0:l.personalStats)==null?void 0:S.pending_reports)||0,color:"warning",variant:"hero"})}),e(P,{md:3,children:e(ve,{title:"Enrolled Courses",value:((b=l==null?void 0:l.personalStats)==null?void 0:b.enrolled_courses)||0,color:"info",variant:"hero"})}),e(P,{md:3,children:e(ve,{title:"Avg Rating Given",value:(v=l==null?void 0:l.personalStats)!=null&&v.avg_class_rating?parseFloat(l.personalStats.avg_class_rating).toFixed(1):"N/A",color:"success",variant:"hero"})})]}):a(de,{children:[e(P,{md:3,children:e(ve,{title:"My Courses",value:((y=l==null?void 0:l.personalStats)==null?void 0:y.my_courses)||0,color:"primary",variant:"hero"})}),e(P,{md:3,children:e(ve,{title:"My Reports",value:((N=l==null?void 0:l.personalStats)==null?void 0:N.my_reports)||0,color:"info",variant:"hero"})}),e(P,{md:3,children:e(ve,{title:"Total Students",value:((k=l==null?void 0:l.personalStats)==null?void 0:k.total_students)||0,color:"success",variant:"hero"})}),e(P,{md:3,children:e(ve,{title:"Avg Rating Received",value:(_=l==null?void 0:l.personalStats)!=null&&_.avg_received_rating?parseFloat(l.personalStats.avg_received_rating).toFixed(1):"N/A",color:"warning",variant:"hero"})})]})}),e(z,{className:"mb-4",children:e(P,{md:12,children:a(x,{children:[e(x.Header,{children:e("h6",{className:"mb-0",children:"My Activity (Recent)"})}),e(x.Body,{children:e(jt,{label:"My reports trend",series:(((T=l==null?void 0:l.trends)==null?void 0:T.my_reports_recent)??((B=l==null?void 0:l.trends)==null?void 0:B.reports)??[]).slice(0,12)})})]})})}),a(z,{children:[a(P,{lg:8,children:[e(ts,{reports:(l==null?void 0:l.recentReports)||[]}),e(rs,{userRole:r==null?void 0:r.role})]}),a(P,{lg:4,children:[e(as,{}),(r==null?void 0:r.role)==="student"&&a(x,{className:"mt-3",children:[e(x.Header,{children:e("h6",{className:"mb-0",children:"My Drafts"})}),a(x.Body,{children:[Array.isArray(c==null?void 0:c.reports)&&c.reports.length>0?e("div",{className:"list-group list-group-flush",children:c.reports.map(D=>a("div",{className:"list-group-item d-flex align-items-center justify-content-between",children:[a("div",{className:"me-2",children:[e("div",{className:"fw-semibold",children:D.title||"Untitled draft"}),e("small",{className:"text-muted",children:new Date(D.created_at).toLocaleDateString()})]}),e($,{to:`/reports/${D.id}`,className:"btn btn-sm btn-outline-secondary",children:"Open"})]},D.id))}):e("div",{className:"text-muted",children:"No drafts"}),e("div",{className:"mt-2 text-end",children:e($,{to:"/reports?status=draft",className:"btn btn-sm btn-outline-primary",children:"View all drafts"})})]})]}),((E=l==null?void 0:l.pendingActions)==null?void 0:E.length)>0&&a(x,{className:"mt-3",children:[e(x.Header,{children:e("h6",{children:"Pending Actions"})}),e(x.Body,{children:l.pendingActions.map((D,I)=>a("div",{className:"d-flex align-items-center mb-2 p-2 bg-light rounded",children:[a("div",{className:"flex-grow-1",children:[e("div",{className:"fw-bold",children:D.title}),a("small",{className:"text-muted",children:["From: ",D.first_name," ",D.last_name,D.course_name&&`  ${D.course_name}`]})]}),e(K,{size:"sm",variant:"outline-primary",as:$,to:`/reports/${D.id}`,children:"Review"})]},I))})]}),((L=l==null?void 0:l.courses)==null?void 0:L.length)>0&&a(x,{className:"mt-3",children:[e(x.Header,{children:e("h6",{children:"My Courses"})}),e(x.Body,{children:l.courses.map((D,I)=>a("div",{className:"course-item mb-2 p-2 border rounded",children:[e("div",{className:"fw-bold",children:D.course_name}),a("div",{className:"text-muted small",children:[D.course_code,"  ",D.stream_name,D.student_count&&`  ${D.student_count} students`,D.avg_rating&&`  ${parseFloat(D.avg_rating).toFixed(1)} `]})]},I))})]})]})]})]})})():(()=>{var C,w,f,g,S,b,v,y;return a(de,{children:[n&&e(z,{className:"mb-3",children:e(P,{children:e(Z,{variant:"danger",children:((w=(C=n==null?void 0:n.response)==null?void 0:C.data)==null?void 0:w.error)||"Failed to load public dashboard"})})}),e(z,{className:"mb-4",children:e(P,{children:a(Z,{variant:"info",className:"text-center",children:[e("h4",{children:"Welcome to LUCT Faculty Reporting System"}),e("p",{children:"A centralized platform for students, lecturers, and faculty management to submit reports, provide feedback, and monitor academic progress."}),!t&&a("div",{className:"mt-3",children:[e(K,{as:$,to:"/login",variant:"primary",className:"me-2",children:"Login"}),e(K,{as:$,to:"/register",variant:"outline-primary",children:"Register"})]})]})})}),a(z,{className:"mb-4",children:[e(P,{md:3,className:"mb-3 mb-md-0",children:e(ve,{title:"Total Users",value:(((f=s==null?void 0:s.generalStats)==null?void 0:f.total_users)??(s==null?void 0:s.total_users))||0,color:"primary",variant:"hero"})}),e(P,{md:3,className:"mb-3 mb-md-0",children:e(ve,{title:"Students",value:(((g=s==null?void 0:s.generalStats)==null?void 0:g.total_students)??(s==null?void 0:s.total_students))||0,color:"success",variant:"hero"})}),e(P,{md:3,className:"mb-3 mb-md-0",children:e(ve,{title:"Lecturers",value:(((S=s==null?void 0:s.generalStats)==null?void 0:S.total_lecturers)??(s==null?void 0:s.total_lecturers))||0,color:"info",variant:"hero"})}),e(P,{md:3,children:e(ve,{title:"Courses",value:(((b=s==null?void 0:s.generalStats)==null?void 0:b.total_courses)??(s==null?void 0:s.total_courses))||0,color:"warning",variant:"hero"})})]}),e(z,{className:"mb-4",children:e(P,{md:12,children:a(x,{children:[e(x.Header,{children:e("h6",{className:"mb-0",children:"Overall Activity"})}),e(x.Body,{children:e(jt,{label:"Reports trend",series:(((v=s==null?void 0:s.trends)==null?void 0:v.reports_weekly)??((y=s==null?void 0:s.trends)==null?void 0:y.reports)??[]).slice(0,12)})})]})})}),e(z,{className:"mb-4",children:e(P,{children:a(x,{children:[e(x.Header,{children:e("h5",{children:"Academic Streams"})}),e(x.Body,{children:e(z,{children:Array.isArray(s==null?void 0:s.courseStats)&&s.courseStats.length>0?s.courseStats.map((N,k)=>e(P,{md:4,className:"mb-3",children:e(x,{className:"h-100 border-left-accent",children:a(x.Body,{children:[e("h6",{children:N.stream_name}),a("div",{className:"text-muted small",children:[a("div",{children:["Courses: ",N.course_count]}),a("div",{children:["Students: ",N.enrolled_students]})]})]})})},k)):e(P,{children:e("div",{className:"text-muted",children:"No stream statistics available"})})})})]})})}),e(z,{children:e(P,{children:a(x,{children:[e(x.Header,{children:e("h5",{children:"Recent Activity"})}),e(x.Body,{children:Array.isArray(s==null?void 0:s.recentActivity)&&s.recentActivity.length>0?e("div",{className:"activity-list",children:s.recentActivity.map((N,k)=>a("div",{className:"activity-item d-flex align-items-center mb-2",children:[e("div",{className:"me-3","aria-hidden":"true",children:""}),a("div",{className:"flex-grow-1",children:[a("div",{children:["New report from ",N.user_role,N.course_name&&` in ${N.course_name}`]}),e("small",{className:"text-muted",children:new Date(N.created_at).toLocaleDateString()})]})]},k))}):e("p",{className:"text-muted",children:"No recent activity"})})]})})}),a(z,{className:"mt-4",children:[e(P,{md:6,className:"mb-3 mb-md-0",children:a(x,{children:[e(x.Header,{children:e("h6",{className:"mb-0",children:"Latest Users"})}),e(x.Body,{children:Array.isArray(s==null?void 0:s.latest_users)&&s.latest_users.length>0?e("div",{className:"list-group list-group-flush",children:s.latest_users.map((N,k)=>a("div",{className:"list-group-item d-flex align-items-center justify-content-between",children:[a("div",{className:"d-flex align-items-center gap-3",children:[e("div",{className:"avatar-circle bg-secondary text-white d-inline-flex align-items-center justify-content-center",children:(N.username||"?").charAt(0).toUpperCase()}),a("div",{children:[e("div",{className:"fw-semibold",children:N.username}),e("div",{className:"text-muted small",children:N.email})]})]}),a("div",{className:"d-flex align-items-center gap-3",children:[N.role&&e("span",{className:"badge bg-secondary text-uppercase",children:N.role}),e("small",{className:"text-muted",children:N.created_at?new Date(N.created_at).toLocaleDateString():""})]})]},k))}):e("div",{className:"text-muted",children:"No recent users"})})]})}),e(P,{md:6,children:a(x,{children:[e(x.Header,{children:e("h6",{className:"mb-0",children:"Latest Reports"})}),e(x.Body,{children:Array.isArray(s==null?void 0:s.latest_reports)&&s.latest_reports.length>0?e("div",{className:"list-group list-group-flush",children:s.latest_reports.map((N,k)=>a("div",{className:"list-group-item d-flex align-items-center justify-content-between",children:[a("div",{className:"d-flex align-items-center gap-3",children:[e("div",{className:"avatar-circle bg-primary text-white d-inline-flex align-items-center justify-content-center",children:(N.title||"R").charAt(0).toUpperCase()}),a("div",{children:[a("div",{className:"fw-semibold d-flex align-items-center gap-2",children:[N.title||"Untitled report",(N.status||"").toLowerCase()==="draft"&&e("span",{className:"badge bg-secondary",children:"Draft"}),(N.status||"").toLowerCase()==="reviewed"&&e("span",{className:"badge bg-info text-dark",children:"Reviewed"}),(N.status||"").toLowerCase()==="submitted"&&e("span",{className:"badge bg-warning text-dark",children:"Submitted"}),(N.status||"").toLowerCase()==="approved"&&e("span",{className:"badge bg-success",children:"Approved"}),(N.status||"").toLowerCase()==="rejected"&&e("span",{className:"badge bg-danger",children:"Rejected"})]}),e("div",{className:"text-muted small",children:N.course_name||"General"})]})]}),a("div",{className:"d-flex align-items-center gap-3",children:[N.status&&(N.status||"").toLowerCase()!=="draft"&&e("span",{className:`badge bg-${(N.status||"").toLowerCase()==="approved"?"success":(N.status||"").toLowerCase()==="rejected"?"danger":(N.status||"").toLowerCase()==="submitted"?"warning":"secondary"}`,children:N.status}),e("small",{className:"text-muted",children:N.created_at?new Date(N.created_at).toLocaleDateString():""})]})]},k))}):e("div",{className:"text-muted",children:"No recent reports"})})]})})]})]})})()]})},ur=({title:t,subtitle:r,children:s,footer:i})=>e(st,{className:"auth-container",children:e(z,{className:"justify-content-center w-100 mx-0",children:e(P,{md:6,lg:5,xl:4,className:"px-2",children:e(x,{className:"auth-card shadow-lg border-0",children:a(x.Body,{className:"p-5",children:[(t||r)&&a("div",{className:"text-center mb-4",children:[e(lr,{size:64,className:"auth-logo mb-3"}),t&&e("h2",{className:"auth-title mb-1",children:t}),r&&e("p",{className:"text-muted mb-0",children:r})]}),s,i&&e("div",{className:"mt-4 text-center",children:i})]})})})})});const us=()=>{const{login:t,isAuthenticated:r,isLoading:s}=ye(),i=Fe(),n=at(),[c,l]=p.useState({username:"",password:""}),[o,d]=p.useState({}),[u,h]=p.useState(!1),[C,w]=p.useState(!1),[f,g]=p.useState(!1);p.useEffect(()=>{var y,N;if(r&&!s){const k=((N=(y=n.state)==null?void 0:y.from)==null?void 0:N.pathname)||"/";i(k,{replace:!0})}},[r,s,i,n]),p.useEffect(()=>{const y=localStorage.getItem("remember_username");y&&!c.username&&(l(N=>({...N,username:y})),g(!0))},[]);const S=y=>{const{name:N,value:k}=y.target;l(_=>({..._,[N]:k})),o[N]&&d(_=>({..._,[N]:""}))},b=()=>{const y={};return c.username.trim()||(y.username="Username or email is required"),c.password||(y.password="Password is required"),d(y),Object.keys(y).length===0},v=async y=>{var N,k,_,T;if(y.preventDefault(),!!b()){h(!0);try{const B=await t(c);if(B.success){f?localStorage.setItem("remember_username",c.username):localStorage.removeItem("remember_username");const E=((k=(N=n.state)==null?void 0:N.from)==null?void 0:k.pathname)||"/";i(E,{replace:!0})}else B.message&&d(E=>({...E,form:B.message}))}catch(B){const E=((T=(_=B==null?void 0:B.response)==null?void 0:_.data)==null?void 0:T.error)||"Failed to sign in. Please check your credentials and try again.";d(L=>({...L,form:E}))}finally{h(!1)}}};return s?e("div",{className:"auth-container d-flex justify-content-center align-items-center",children:e(se,{animation:"border",variant:"primary"})}):a(ur,{title:"Welcome Back",subtitle:"Sign in to your account",footer:a("p",{className:"mb-0",children:["Don't have an account?"," ",e($,{to:"/register",className:"text-decoration-none",children:"Sign up here"})]}),children:[o.form&&e(Z,{variant:"danger",className:"py-2",role:"alert",children:o.form}),a(m,{onSubmit:v,noValidate:!0,children:[a(m.Group,{className:"mb-3",children:[a(m.Label,{children:[e("i",{className:"bi bi-person me-2"}),"Username or Email"]}),e(m.Control,{type:"text",name:"username",value:c.username,onChange:S,placeholder:"Enter your username or email",isInvalid:!!o.username,disabled:u,autoComplete:"username",inputMode:"email"}),e(m.Control.Feedback,{type:"invalid",children:o.username})]}),a(m.Group,{className:"mb-3",children:[a(m.Label,{children:[e("i",{className:"bi bi-lock me-2"}),"Password"]}),a(Ie,{children:[e(m.Control,{type:C?"text":"password",name:"password",value:c.password,onChange:S,placeholder:"Enter your password",isInvalid:!!o.password,disabled:u,autoComplete:"current-password"}),e(K,{variant:"outline-secondary",onClick:()=>w(y=>!y),tabIndex:-1,children:e("i",{className:`bi ${C?"bi-eye-slash":"bi-eye"}`})})]}),e(m.Control.Feedback,{type:"invalid",children:o.password})]}),a("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e(m.Check,{type:"checkbox",id:"rememberMe",label:"Remember me",checked:f,onChange:y=>g(y.target.checked),disabled:u}),e("span",{className:"small text-muted",children:"Use your assigned credentials"})]}),e(K,{variant:"primary",type:"submit",className:"w-100 mb-3",disabled:u,children:u?a(de,{children:[e(se,{size:"sm",className:"me-2"}),"Signing In..."]}):a(de,{children:[e("i",{className:"bi bi-box-arrow-in-right me-2"}),"Sign In"]})})]}),a(Z,{variant:"info",className:"small",children:[e("strong",{children:"Demo Accounts (Password: Password123):"}),e("br",{}),a("div",{className:"mt-2",children:[a("div",{children:[e("strong",{children:"Admin:"})," admin1 or admin1@example.com"]}),a("div",{children:[e("strong",{children:"Faculty Manager:"})," fm1 or fm1@example.com"]}),a("div",{children:[e("strong",{children:"Program Leader:"})," pl1 or pl1@example.com"]}),a("div",{children:[e("strong",{children:"Lecturer:"})," lecturer1 or lecturer1@example.com"]}),a("div",{children:[e("strong",{children:"Student:"})," student1 or student1@example.com"]})]})]})]})},hs=()=>{const{register:t,isAuthenticated:r,isLoading:s}=ye(),i=Fe(),[n,c]=p.useState({username:"",email:"",password:"",confirmPassword:"",firstName:"",lastName:"",phone:"",role:"student",streamId:"",courseId:""}),[l,o]=p.useState({}),[d,u]=p.useState(!1),[h,C]=p.useState(!1),[w,f]=p.useState(!1),[g,S]=p.useState(""),[b,v]=p.useState([]),[y,N]=p.useState([]);p.useEffect(()=>{r&&!s&&i("/",{replace:!0})},[r,s,i]);const k=async()=>{try{const{data:L}=await M.users.getPublicStreams();v((L==null?void 0:L.streams)||[])}catch{v([])}},_=async L=>{try{const{data:D}=await M.users.getPublicCourses({stream_id:L});N((D==null?void 0:D.courses)||[])}catch{N([])}};p.useEffect(()=>{k()},[]),p.useEffect(()=>{n.streamId&&_(n.streamId)},[n.streamId]);const T=L=>{const{name:D,value:I}=L.target;c(j=>({...j,[D]:I})),D==="streamId"&&(c(j=>({...j,courseId:""})),I?_(I).catch(()=>{}):N([])),l[D]&&o(j=>({...j,[D]:""}))},B=()=>{const L={};return n.username.trim()?n.username.length<3?L.username="Username must be at least 3 characters":/^[a-zA-Z0-9_]+$/.test(n.username)||(L.username="Username can only contain letters, numbers, and underscores"):L.username="Username is required",n.email.trim()?/\S+@\S+\.\S+/.test(n.email)||(L.email="Please enter a valid email address"):L.email="Email is required",n.password?n.password.length<6?L.password="Password must be at least 6 characters":/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(n.password)||(L.password="Password must contain at least one lowercase letter, one uppercase letter, and one number"):L.password="Password is required",n.confirmPassword?n.password!==n.confirmPassword&&(L.confirmPassword="Passwords do not match"):L.confirmPassword="Please confirm your password",n.firstName.trim()||(L.firstName="First name is required"),n.lastName.trim()||(L.lastName="Last name is required"),n.role||(L.role="Please select a role"),(n.role==="student"||n.role==="lecturer")&&(String(n.streamId||"").trim()||(L.streamId="Please select your faculty"),String(n.courseId||"").trim()||(L.courseId="Please select your course")),o(L),Object.keys(L).length===0},E=async L=>{var D,I;if(L.preventDefault(),!!B()){u(!0);try{const j={...n,streamId:n.streamId?Number(n.streamId):void 0,courseId:n.courseId?Number(n.courseId):void 0},W=await t(j);W.success?i("/",{replace:!0}):W.message&&S(W.message)}catch(j){const W=((I=(D=j==null?void 0:j.response)==null?void 0:D.data)==null?void 0:I.error)||"Registration failed. Please review your details and try again.";S(W)}finally{u(!1)}}};return s?e("div",{className:"auth-container d-flex justify-content-center align-items-center",style:{minHeight:"80vh"},children:e(se,{animation:"border",variant:"primary"})}):a(ur,{title:"Create Account",subtitle:"Join the Faculty Reporting System",footer:a("p",{className:"mb-0",children:["Already have an account?"," ",e($,{to:"/login",className:"text-decoration-none",children:"Sign in here"})]}),children:[g&&e(Z,{variant:"danger",className:"py-2",role:"alert",children:g}),a(m,{onSubmit:E,children:[a(z,{children:[e(P,{md:6,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"First Name *"}),e(m.Control,{type:"text",name:"firstName",value:n.firstName,onChange:T,placeholder:"Enter first name",isInvalid:!!l.firstName,disabled:d,autoComplete:"given-name"}),e(m.Control.Feedback,{type:"invalid",children:l.firstName})]})}),e(P,{md:6,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Last Name *"}),e(m.Control,{type:"text",name:"lastName",value:n.lastName,onChange:T,placeholder:"Enter last name",isInvalid:!!l.lastName,disabled:d,autoComplete:"family-name"}),e(m.Control.Feedback,{type:"invalid",children:l.lastName})]})})]}),a(m.Group,{className:"mb-3",children:[a(m.Label,{children:[e("i",{className:"bi bi-person me-2"}),"Username *"]}),e(m.Control,{type:"text",name:"username",value:n.username,onChange:T,placeholder:"Choose a username",isInvalid:!!l.username,disabled:d,autoComplete:"username"}),e(m.Control.Feedback,{type:"invalid",children:l.username}),e(m.Text,{className:"text-muted",children:"Only letters, numbers, and underscores allowed"})]}),a(m.Group,{className:"mb-3",children:[a(m.Label,{children:[e("i",{className:"bi bi-envelope me-2"}),"Email Address *"]}),e(m.Control,{type:"email",name:"email",value:n.email,onChange:T,placeholder:"Enter email address",isInvalid:!!l.email,disabled:d,autoComplete:"email"}),e(m.Control.Feedback,{type:"invalid",children:l.email})]}),a(m.Group,{className:"mb-3",children:[a(m.Label,{children:[e("i",{className:"bi bi-telephone me-2"}),"Phone Number (Optional)"]}),e(m.Control,{type:"tel",name:"phone",value:n.phone,onChange:T,placeholder:"Enter phone number",disabled:d,autoComplete:"tel"})]}),a(m.Group,{className:"mb-3",children:[a(m.Label,{children:[e("i",{className:"bi bi-person-badge me-2"}),"Role *"]}),a(m.Select,{name:"role",value:n.role,onChange:T,isInvalid:!!l.role,disabled:d,children:[e("option",{value:"",children:"Select your role"}),e("option",{value:"student",children:"Student"}),e("option",{value:"lecturer",children:"Lecturer"}),e("option",{value:"program_leader",children:"Program Leader"}),e("option",{value:"principal_lecturer",children:"Principal Lecturer"}),e("option",{value:"faculty_manager",children:"Faculty Manager"})]}),e(m.Control.Feedback,{type:"invalid",children:l.role})]}),(n.role==="student"||n.role==="lecturer")&&a(z,{children:[e(P,{md:6,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Faculty *"}),a(m.Select,{name:"streamId",value:n.streamId||"",onChange:T,isInvalid:!!l.streamId,disabled:d,children:[e("option",{value:"",children:"Select faculty"}),b.map(L=>e("option",{value:L.id,children:L.stream_name},L.id))]}),e(m.Control.Feedback,{type:"invalid",children:l.streamId})]})}),e(P,{md:6,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Course *"}),a(m.Select,{name:"courseId",value:n.courseId||"",onChange:T,isInvalid:!!l.courseId,disabled:d||!n.streamId,children:[e("option",{value:"",children:"Select course"}),y.map(L=>a("option",{value:L.id,children:[L.course_name," (",L.course_code,")"]},L.id))]}),e(m.Control.Feedback,{type:"invalid",children:l.courseId})]})})]}),a(z,{children:[e(P,{md:6,children:a(m.Group,{className:"mb-3",children:[a(m.Label,{children:[e("i",{className:"bi bi-lock me-2"}),"Password *"]}),a(Ie,{children:[e(m.Control,{type:h?"text":"password",name:"password",value:n.password,onChange:T,placeholder:"Create password",isInvalid:!!l.password,disabled:d,autoComplete:"new-password"}),e(K,{variant:"outline-secondary",onClick:()=>C(L=>!L),tabIndex:-1,children:e("i",{className:`bi ${h?"bi-eye-slash":"bi-eye"}`})})]}),e(m.Control.Feedback,{type:"invalid",children:l.password})]})}),e(P,{md:6,children:a(m.Group,{className:"mb-4",children:[a(m.Label,{children:[e("i",{className:"bi bi-lock-fill me-2"}),"Confirm Password *"]}),a(Ie,{children:[e(m.Control,{type:w?"text":"password",name:"confirmPassword",value:n.confirmPassword,onChange:T,placeholder:"Confirm password",isInvalid:!!l.confirmPassword,disabled:d,autoComplete:"new-password"}),e(K,{variant:"outline-secondary",onClick:()=>f(L=>!L),tabIndex:-1,children:e("i",{className:`bi ${w?"bi-eye-slash":"bi-eye"}`})})]}),e(m.Control.Feedback,{type:"invalid",children:l.confirmPassword})]})})]}),e(K,{variant:"primary",type:"submit",className:"w-100 mb-3",disabled:d,size:"lg",children:d?a(de,{children:[e(se,{size:"sm",className:"me-2"}),"Creating Account..."]}):a(de,{children:[e("i",{className:"bi bi-person-plus me-2"}),"Create Account"]})})]})]})};const ms=()=>{var j,W;const{user:t}=ye(),r=Fe(),[s,i]=Nr(),[n,c]=p.useState(()=>{const R=(G,H)=>{const X=parseInt(s.get(G));return Number.isFinite(X)&&X>0?X:H};return{page:R("page",1),limit:R("limit",10),status:s.get("status")||"",reportType:s.get("reportType")||"",search:s.get("search")||"",courseId:s.get("courseId")||"",streamId:s.get("streamId")||s.get("stream_id")||""}});p.useEffect(()=>{const R=new URLSearchParams;n.page&&n.page!==1&&R.set("page",String(n.page)),n.limit&&n.limit!==10&&R.set("limit",String(n.limit)),n.status&&R.set("status",n.status),n.reportType&&R.set("reportType",n.reportType),n.search&&R.set("search",n.search),n.courseId&&R.set("courseId",String(n.courseId)),n.streamId&&R.set("streamId",String(n.streamId)),i(R)},[n,i]);const[l,o]=p.useState([]),[d,u]=p.useState(!1),[h,C]=p.useState([]),[w,f]=p.useState(!1);p.useEffect(()=>{(async()=>{try{f(!0);const{data:G}=await M.users.getStreams(),H=Array.isArray(G==null?void 0:G.streams)?G.streams:[];C(H)}catch{}finally{f(!1)}})()},[]),p.useEffect(()=>{(async()=>{try{u(!0);const G=n.streamId?{stream_id:n.streamId}:void 0,{data:H}=await M.users.getAvailableCourses(G),X=Array.isArray(H==null?void 0:H.courses)?H.courses:Array.isArray(H)?H:[];o(X)}catch{}finally{u(!1)}})()},[n.streamId]);const{data:g,isLoading:S,refetch:b}=be(["reports",n],()=>M.reports.getAll(n),{keepPreviousData:!0,refetchOnWindowFocus:!1,select:R=>(R==null?void 0:R.data)??R}),v=["admin","faculty_manager","principal_lecturer","program_leader"].includes(t==null?void 0:t.role),y=async(R,G)=>{var H,X;try{await M.reports.moderate(R,G),F.success("Report updated"),b()}catch(ne){const ae=((X=(H=ne==null?void 0:ne.response)==null?void 0:H.data)==null?void 0:X.error)||"Failed to update report";F.error(ae)}},N=(R,G)=>{c(H=>({...H,[R]:G,page:1}))},k=R=>{c(G=>({...G,page:R}))},_=async()=>{try{const R={...n};R.streamId&&(R.stream_id=R.streamId,delete R.streamId);const G=await M.export.reportsExcel(R),H=`reports_${new Date().toISOString().split("T")[0]}.xlsx`;Ee(G.data,H),F.success("Reports exported to Excel successfully!")}catch{F.error("Failed to export reports")}},T=async()=>{try{const R={...n};R.streamId&&(R.stream_id=R.streamId,delete R.streamId);const G=await M.export.reportsPdf(R),H=`reports_${new Date().toISOString().split("T")[0]}.pdf`;Ee(G.data,H),F.success("Reports exported to PDF successfully!")}catch{F.error("Failed to export reports")}},B=R=>{switch(R){case"submitted":return"primary";case"reviewed":return"info";case"approved":return"success";case"rejected":return"danger";case"draft":return"secondary";default:return"secondary"}},E=R=>R.replace("_"," ").split(" ").map(G=>G.charAt(0).toUpperCase()+G.slice(1)).join(" "),L=()=>{if(!(g!=null&&g.pagination))return null;const{page:R,pages:G}=g.pagination,H=[];H.push(e(Be.Prev,{onClick:()=>k(R-1),disabled:R===1},"prev"));for(let X=Math.max(1,R-2);X<=Math.min(G,R+2);X++)H.push(e(Be.Item,{active:X===R,onClick:()=>k(X),children:X},X));return H.push(e(Be.Next,{onClick:()=>k(R+1),disabled:R===G},"next")),e(Be,{className:"justify-content-center",children:H})};if(S&&!g)return e(xt,{});const D=(g==null?void 0:g.reports)||[],I=(g==null?void 0:g.pagination)||{};return a(st,{fluid:!0,className:"reports-container",children:[e(z,{className:"mb-4",children:e(P,{children:a("div",{className:"d-flex justify-content-between align-items-center",children:[a("div",{children:[a("h2",{children:[e("i",{className:"bi bi-file-text me-2"}),"Reports Management"]}),a("p",{className:"text-muted mb-0",children:[I.total||0," total reports"]}),a("div",{className:"mt-2 small d-flex gap-2 flex-wrap align-items-center",children:[e("span",{className:"text-muted me-1",children:"Legend:"}),e("span",{className:"badge bg-secondary",children:"Draft"}),e("span",{className:"badge bg-warning text-dark",children:"Submitted"}),e("span",{className:"badge bg-info text-dark",children:"Reviewed"}),e("span",{className:"badge bg-success",children:"Approved"}),e("span",{className:"badge bg-danger",children:"Rejected"})]}),(n.courseId||n.streamId)&&a("div",{className:"mt-2 d-flex gap-2 flex-wrap",children:[n.streamId&&a(ue,{bg:"secondary",children:["Stream: ",((j=h.find(R=>String(R.id)===String(n.streamId)))==null?void 0:j.stream_name)||n.streamId]}),n.courseId&&a(ue,{bg:"info",children:["Course: ",((W=l.find(R=>String(R.id)===String(n.courseId)))==null?void 0:W.course_name)||n.courseId]})]})]}),a("div",{children:[(t==null?void 0:t.role)==="lecturer"&&(n.reportType==="lecturer_report"?a(K,{variant:"outline-secondary",className:"me-2",onClick:()=>N("reportType",""),children:[e("i",{className:"bi bi-x-circle me-2"}),"Clear My Lecturer Reports"]}):a(K,{variant:"outline-info",className:"me-2",onClick:()=>N("reportType","lecturer_report"),children:[e("i",{className:"bi bi-funnel me-2"}),"My Lecturer Reports"]})),(t==null?void 0:t.role)!=="lecturer"&&a(K,{variant:"primary",as:$,to:"/reports/create",className:"me-2",children:[e("i",{className:"bi bi-plus-circle me-2"}),"Create Report"]}),(t==null?void 0:t.role)==="lecturer"&&a(K,{variant:"outline-primary",as:$,to:"/reports/lecturer/new",className:"me-2",children:[e("i",{className:"bi bi-journal-plus me-2"}),"New Lecturer Report"]}),a(ge,{as:kt,children:[a(K,{variant:"outline-success",children:[e("i",{className:"bi bi-download me-2"}),"Export"]}),e(ge.Toggle,{split:!0,variant:"outline-success"}),a(ge.Menu,{align:"end",children:[a(ge.Item,{onClick:_,children:[e("i",{className:"bi bi-file-excel me-2"}),"Export to Excel"]}),a(ge.Item,{onClick:T,children:[e("i",{className:"bi bi-file-pdf me-2"}),"Export to PDF"]})]})]})]})]})})}),e(x,{className:"mb-4",children:a(x.Body,{children:[a(z,{className:"align-items-center",children:[e(P,{md:4,children:a(Ie,{children:[e(Ie.Text,{children:e("i",{className:"bi bi-search"})}),e(m.Control,{type:"text",placeholder:"Search reports...",value:n.search,onChange:R=>N("search",R.target.value)})]})}),e(P,{md:3,children:a(m.Select,{value:n.status,onChange:R=>N("status",R.target.value),children:[e("option",{value:"",children:"All Status"}),e("option",{value:"submitted",children:"Submitted"}),e("option",{value:"reviewed",children:"Reviewed"}),e("option",{value:"approved",children:"Approved"}),e("option",{value:"rejected",children:"Rejected"}),e("option",{value:"draft",children:"Draft"})]})}),e(P,{md:3,children:a(m.Select,{value:n.reportType,onChange:R=>N("reportType",R.target.value),children:[e("option",{value:"",children:"All Types"}),e("option",{value:"student_report",children:"Student Report"}),e("option",{value:"lecturer_report",children:"Lecturer Report"}),e("option",{value:"progress_report",children:"Progress Report"}),e("option",{value:"feedback_report",children:"Feedback Report"})]})}),e(P,{md:3,children:a(m.Select,{value:n.courseId,onChange:R=>N("courseId",R.target.value),disabled:d,children:[e("option",{value:"",children:"All Courses"}),l.map(R=>a("option",{value:R.id,children:[R.course_name||R.name," ",R.course_code?`(${R.course_code})`:""]},R.id))]})}),e(P,{md:2,children:a(m.Select,{value:n.limit,onChange:R=>N("limit",parseInt(R.target.value)),children:[e("option",{value:5,children:"5 per page"}),e("option",{value:10,children:"10 per page"}),e("option",{value:20,children:"20 per page"}),e("option",{value:50,children:"50 per page"})]})})]}),a(z,{className:"align-items-center mt-3",children:[e(P,{md:6,className:"mb-2 mb-md-0",children:a(m.Select,{value:n.streamId,onChange:R=>N("streamId",R.target.value),disabled:w,children:[e("option",{value:"",children:"All Streams"}),h.map(R=>a("option",{value:R.id,children:[R.stream_name," ",R.stream_code?`(${R.stream_code})`:""]},R.id))]})}),e(P,{md:6,children:a(m.Select,{value:n.courseId,onChange:R=>N("courseId",R.target.value),disabled:d,children:[e("option",{value:"",children:"All Courses"}),l.map(R=>a("option",{value:R.id,children:[R.course_name||R.name," ",R.course_code?`(${R.course_code})`:""]},R.id))]})})]}),e("div",{className:"mt-3 d-flex justify-content-end",children:e(K,{variant:"outline-secondary",size:"sm",onClick:()=>c({page:1,limit:10,status:"",reportType:"",search:"",courseId:"",streamId:""}),children:"Reset Filters"})})]})}),e(x,{children:e(x.Body,{className:"p-0",children:D.length===0?a("div",{className:"text-center py-5",children:[e("i",{className:"bi bi-file-text display-1 text-muted"}),e("h4",{className:"mt-3",children:"No Reports Found"}),e("p",{className:"text-muted",children:n.search||n.status||n.reportType?"Try adjusting your filters":"Create your first report to get started"}),!n.search&&!n.status&&!n.reportType&&a("div",{className:"d-flex justify-content-center gap-2",children:[(t==null?void 0:t.role)!=="lecturer"&&a(K,{variant:"primary",as:$,to:"/reports/create",children:[e("i",{className:"bi bi-plus-circle me-2"}),"Create Report"]}),(t==null?void 0:t.role)==="lecturer"&&a(K,{variant:"primary",as:$,to:"/reports/lecturer/new",children:[e("i",{className:"bi bi-journal-plus me-2"}),"New Lecturer Report"]})]})]}):a(de,{children:[a(le,{responsive:!0,hover:!0,className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Title"}),e("th",{children:"Type"}),e("th",{children:"Status"}),e("th",{children:"Reporter"}),e("th",{children:"Course"}),e("th",{children:"Rating"}),e("th",{children:"Created"}),e("th",{children:"Actions"})]})}),e("tbody",{children:D.map(R=>a("tr",{children:[a("td",{children:[a("div",{className:"fw-bold d-flex align-items-center gap-2",children:[R.title,(R.status||"").toLowerCase()==="draft"&&e("span",{className:"badge bg-secondary",children:"Draft"}),(R.status||"").toLowerCase()==="submitted"&&e("span",{className:"badge bg-warning text-dark",children:"Submitted"}),(R.status||"").toLowerCase()==="reviewed"&&e("span",{className:"badge bg-info text-dark",children:"Reviewed"}),(R.status||"").toLowerCase()==="approved"&&e("span",{className:"badge bg-success",children:"Approved"}),(R.status||"").toLowerCase()==="rejected"&&e("span",{className:"badge bg-danger",children:"Rejected"})]}),a("small",{className:"text-muted",children:[R.content.substring(0,80),R.content.length>80?"...":""]})]}),e("td",{children:e(ue,{bg:"info",children:E(R.report_type)})}),e("td",{children:e(ue,{bg:B(R.status),children:R.status.toUpperCase()})}),a("td",{children:[a("div",{children:[R.first_name," ",R.last_name]}),e("small",{className:"text-muted",children:E(R.reporter_role)})]}),e("td",{children:R.course_name?a("div",{children:[e("div",{className:"fw-bold",children:R.course_name}),e("small",{className:"text-muted",children:R.course_code})]}):e("span",{className:"text-muted",children:"N/A"})}),e("td",{children:R.rating?e("div",{className:"d-flex align-items-center",title:`${R.rating} / 5`,children:[1,2,3,4,5].map(G=>e("i",{className:`bi ${G<=R.rating?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:14,marginRight:2}},G))}):e("span",{className:"text-muted",children:"N/A"})}),a("td",{children:[e("div",{children:new Date(R.created_at).toLocaleDateString()}),e("small",{className:"text-muted",children:new Date(R.created_at).toLocaleTimeString()})]}),e("td",{children:a("div",{className:"d-flex gap-1",children:[e(K,{size:"sm",variant:"outline-primary",as:$,to:`/reports/${R.id}`,title:"View Details",children:e("i",{className:"bi bi-eye"})}),R.reporter_id===(t==null?void 0:t.id)&&R.status==="draft"&&e(K,{size:"sm",variant:"outline-secondary",onClick:()=>r(`/reports/${R.id}/edit`),title:"Edit Report",children:e("i",{className:"bi bi-pencil"})}),R.reporter_id===(t==null?void 0:t.id)&&R.status==="draft"&&e(K,{size:"sm",variant:"outline-primary",onClick:()=>handleSubmitDraft(R.id),title:"Submit Draft",children:e("i",{className:"bi bi-send"})}),v&&a(ge,{as:kt,size:"sm",children:[e(K,{variant:"outline-success",onClick:()=>y(R.id,{status:"approved"}),title:"Approve",children:e("i",{className:"bi bi-check2-circle"})}),e(ge.Toggle,{split:!0,variant:"outline-success"}),a(ge.Menu,{align:"end",children:[a(ge.Item,{onClick:()=>y(R.id,{status:"reviewed"}),children:[e("i",{className:"bi bi-eye me-2"}),"Mark Reviewed"]}),a(ge.Item,{onClick:()=>y(R.id,{status:"rejected"}),children:[e("i",{className:"bi bi-x-circle me-2"}),"Reject"]}),e(ge.Divider,{}),a(ge.Item,{onClick:()=>{const G=window.prompt("Enter rating 1-5"),H=Number(G);Number.isInteger(H)&&H>=1&&H<=5?y(R.id,{rating:H}):G!==null&&F.error("Invalid rating")},children:[e("i",{className:"bi bi-star-half me-2"}),"Set Rating"]})]})]})]})})]},R.id))})]}),I.pages>1&&e("div",{className:"p-3 border-top",children:a(z,{className:"align-items-center",children:[e(P,{md:6,children:a("small",{className:"text-muted",children:["Showing ",(I.page-1)*I.limit+1," to"," ",Math.min(I.page*I.limit,I.total)," of"," ",I.total," results"]})}),e(P,{md:6,children:L()})]})})]})})})]})};function ps(){const t=Fe(),{user:r}=ye(),[s,i]=p.useState(""),[n,c]=p.useState(""),[l,o]=p.useState(""),[d,u]=p.useState(""),[h,C]=p.useState([]),[w,f]=p.useState(!1),[g,S]=p.useState([]),[b,v]=p.useState(!1),[y,N]=p.useState("");p.useEffect(()=>{(async()=>{try{f(!0);const{data:B}=await M.users.getAvailableCourses(),E=Array.isArray(B)?B:(B==null?void 0:B.courses)||[];C(Array.isArray(E)?E:[])}catch{}finally{f(!1)}})()},[]);const k=T=>{const B=Array.from(T.target.files||[]),E=5*1024*1024,L=["image/png","image/jpeg","application/pdf","text/plain"];if(B.find(I=>I.size>E||!L.includes(I.type))){F.error("Files must be PNG/JPEG/PDF/TXT and <= 5MB each");return}S(B)},_=async T=>{var B,E,L;if(T.preventDefault(),N(""),!s.trim()||!n.trim()){N("Title and description are required");return}if((r==null?void 0:r.role)!=="student"&&!d){N("Please select a course for this report");return}try{v(!0);const D={title:s.trim(),description:n.trim(),reportType:l||void 0,courseId:d?Number(d):void 0},{data:I}=await M.reports.create(D);F.success("Report created successfully");const j=(B=I==null?void 0:I.report)==null?void 0:B.id;if(j&&g.length>0)try{const W=new FormData;g.forEach(R=>W.append("files",R)),await M.reports.uploadAttachments(j,W),F.success("Attachments uploaded")}catch{F("Report saved. Attachments upload will be enabled once storage is configured.",{icon:""})}t(j?`/reports/${j}`:"/reports")}catch(D){const I=((L=(E=D==null?void 0:D.response)==null?void 0:E.data)==null?void 0:L.error)||"Failed to create report";N(I),F.error(I)}finally{v(!1)}};return a("div",{className:"container py-4",children:[e("h1",{className:"mb-3",children:"Create Report"}),e(x,{children:a(x.Body,{children:[y&&e(Z,{variant:"danger",children:y}),a(m,{onSubmit:_,children:[a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Title"}),e(m.Control,{type:"text",placeholder:"Enter a concise title",value:s,onChange:T=>i(T.target.value),disabled:b,required:!0})]}),a(m.Group,{className:"mb-4",children:[e(m.Label,{children:"Description"}),e(m.Control,{as:"textarea",rows:6,placeholder:"Describe your report details",value:n,onChange:T=>c(T.target.value),disabled:b,required:!0})]}),a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Report Type (optional)"}),a(m.Select,{value:l,onChange:T=>o(T.target.value),disabled:b,children:[e("option",{value:"",children:"Auto (based on role)"}),e("option",{value:"student_report",children:"Student Report"}),e("option",{value:"lecturer_report",children:"Lecturer Report"}),e("option",{value:"progress_report",children:"Progress Report"}),e("option",{value:"feedback_report",children:"Feedback Report"})]})]}),a(m.Group,{className:"mb-4",children:[a(m.Label,{children:["Course",(r==null?void 0:r.role)!=="student"?" (required)":" (optional)"]}),a("div",{className:"d-flex align-items-center gap-2",children:[a(m.Select,{value:d,onChange:T=>u(T.target.value),disabled:b||w,required:(r==null?void 0:r.role)!=="student",children:[e("option",{value:"",children:w?"Loading courses...":"Select a course"}),h.map(T=>e("option",{value:T.id,children:T.course_name||T.name},T.id))]}),w&&e(se,{size:"sm"})]}),(r==null?void 0:r.role)==="student"&&e(m.Text,{className:"text-muted",children:"If applicable, associate this report with a course"})]}),a(m.Group,{className:"mb-4",children:[e(m.Label,{children:"Attachments (PNG, JPEG, PDF, TXT up to 5MB each)"}),e(m.Control,{type:"file",multiple:!0,onChange:k,disabled:b}),g.length>0&&a(m.Text,{className:"text-muted",children:[g.length," file(s) selected"]})]}),a("div",{className:"d-flex gap-2",children:[e(K,{type:"submit",variant:"primary",disabled:b,children:b?"Submitting...":"Submit Report"}),e(K,{variant:"outline-secondary",onClick:()=>t(-1),disabled:b,children:"Cancel"})]})]})]})})]})}function fs(){var O;const{id:t}=Cr(),{user:r}=ye(),[s,i]=p.useState(null),[n,c]=p.useState([]),[l,o]=p.useState([]),[d,u]=p.useState(!0),[h,C]=p.useState(!1),[w,f]=p.useState(""),[g,S]=p.useState(!1),[b,v]=p.useState("suggestion"),[y,N]=p.useState(""),[k,_]=p.useState([]),[T,B]=p.useState(!1),[E,L]=p.useState(5),[D,I]=p.useState(""),[j,W]=p.useState(""),[R,G]=p.useState(""),[H,X]=p.useState(!1),[ne,ae]=p.useState(!1),me=()=>{if(!r||!s)return!1;const A=["admin","faculty_manager","principal_lecturer","program_leader"];return s.reporter_id===r.id||A.includes(r.role)},ke=()=>!r||!s?!1:["admin","faculty_manager","principal_lecturer","program_leader","lecturer"].includes(r.role)&&s.reporter_id!==r.id,Oe=async A=>{var q,Q;if(A.preventDefault(),!y.trim()){F.error("Feedback content is required");return}try{S(!0),await M.reports.addFeedback(t,{content:y.trim(),feedbackType:b}),F.success("Feedback submitted"),N(""),await pe()}catch(re){F.error(((Q=(q=re==null?void 0:re.response)==null?void 0:q.data)==null?void 0:Q.error)||"Failed to submit feedback")}finally{S(!1)}},pe=async()=>{var A,q,Q,re,Ne;try{u(!0);const[Ce,je]=await Promise.all([M.reports.getById(t),M.reports.listAttachments(t)]);i(((A=Ce.data)==null?void 0:A.report)||Ce.data),c(((q=Ce.data)==null?void 0:q.feedback)||[]),o(((Q=je.data)==null?void 0:Q.files)||[])}catch(Ce){f(((Ne=(re=Ce==null?void 0:Ce.response)==null?void 0:re.data)==null?void 0:Ne.error)||"Failed to load report")}finally{u(!1)}};p.useEffect(()=>{pe()},[t]),p.useEffect(()=>{(async()=>{try{if(s!=null&&s.course_id){const{data:q}=await M.users.getLecturersByCourse(s.course_id);_((q==null?void 0:q.lecturers)||[])}else _([])}catch{_([])}})()},[s==null?void 0:s.course_id]),p.useEffect(()=>{(s==null?void 0:s.rating)!=null&&G(String(s.rating))},[s==null?void 0:s.rating]);const ct=async A=>{var Ce,je;const q=Array.from(A.target.files||[]);if(q.length===0)return;const Q=5*1024*1024,re=["image/png","image/jpeg","application/pdf","text/plain"];if(q.find(we=>we.size>Q||!re.includes(we.type))){F.error("Files must be PNG/JPEG/PDF/TXT and <= 5MB each");return}try{C(!0);const we=new FormData;q.forEach(fr=>we.append("files",fr)),await M.reports.uploadAttachments(t,we),F.success("Attachments uploaded"),await pe()}catch(we){F.error(((je=(Ce=we==null?void 0:we.response)==null?void 0:Ce.data)==null?void 0:je.error)||"Failed to upload attachments")}finally{C(!1),A.target.value=""}};return d?e("div",{className:"container py-4",children:e(se,{})}):w?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:w})}):s?a("div",{className:"container py-4",children:[a(z,{className:"mb-3",children:[a(P,{children:[e("h2",{className:"mb-1",children:s.title}),a("div",{className:"text-muted small",children:["Created ",new Date(s.created_at).toLocaleString()]})]}),a(P,{className:"text-md-end",children:[a("div",{className:"d-flex gap-2 justify-content-md-end",children:[e(ue,{bg:"secondary",children:s.course_name||"No course"}),e(ue,{bg:s.status==="approved"?"success":s.status==="rejected"?"danger":s.status==="submitted"?"primary":"secondary",children:(O=s.status)==null?void 0:O.toUpperCase()})]}),s.reporter_id===(r==null?void 0:r.id)&&s.status==="draft"&&a("div",{className:"mt-2 d-flex justify-content-md-end",children:[a("div",{className:"me-2 text-muted small d-flex align-items-center",children:["Will be submitted to ",(r==null?void 0:r.role)==="student"?"LECTURER":"PROGRAM_LEADER"]}),a(K,{size:"sm",variant:"primary",disabled:ne,onClick:async()=>{var Q,re;const A=(r==null?void 0:r.role)==="student"?"LECTURER":"PROGRAM_LEADER";if(window.confirm(`Submit this draft for review to ${A}?`))try{ae(!0),await M.reports.submit(t),F.success(`Report submitted to ${A}`),await pe()}catch(Ne){F.error(((re=(Q=Ne==null?void 0:Ne.response)==null?void 0:Q.data)==null?void 0:re.error)||"Failed to submit report")}finally{ae(!1)}},children:[e("i",{className:"bi bi-send-fill me-1"}),"Submit"]})]}),s.rating?e("div",{className:"mt-2 d-flex justify-content-md-end align-items-center",title:`${s.rating} / 5`,children:[1,2,3,4,5].map(A=>e("i",{className:`bi ${A<=s.rating?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:16,marginLeft:2}},A))}):null,["admin","faculty_manager","principal_lecturer","program_leader"].includes(r==null?void 0:r.role)&&s.reporter_id!==(r==null?void 0:r.id)&&!["approved","rejected"].includes(s.status)&&a("div",{className:"mt-2 d-flex gap-2 justify-content-md-end",children:[a(K,{size:"sm",variant:"success",disabled:ne,onClick:async()=>{var A,q;try{ae(!0),await M.reports.moderate(t,{status:"approved"}),F.success("Report approved"),await pe()}catch(Q){F.error(((q=(A=Q==null?void 0:Q.response)==null?void 0:A.data)==null?void 0:q.error)||"Failed to approve")}finally{ae(!1)}},children:[e("i",{className:"bi bi-check2-circle me-1"}),"Approve"]}),a(K,{size:"sm",variant:"outline-secondary",disabled:ne,onClick:async()=>{var A,q;try{ae(!0),await M.reports.moderate(t,{status:"reviewed"}),F.success("Report marked as reviewed"),await pe()}catch(Q){F.error(((q=(A=Q==null?void 0:Q.response)==null?void 0:A.data)==null?void 0:q.error)||"Failed to mark reviewed")}finally{ae(!1)}},children:[e("i",{className:"bi bi-eye me-1"}),"Mark Reviewed"]}),a(K,{size:"sm",variant:"outline-danger",disabled:ne,onClick:async()=>{var A,q;try{ae(!0),await M.reports.moderate(t,{status:"rejected"}),F.success("Report rejected"),await pe()}catch(Q){F.error(((q=(A=Q==null?void 0:Q.response)==null?void 0:A.data)==null?void 0:q.error)||"Failed to reject")}finally{ae(!1)}},children:[e("i",{className:"bi bi-x-circle me-1"}),"Reject"]}),a(K,{size:"sm",variant:"outline-warning",disabled:ne,onClick:async()=>{var Q,re;const A=window.prompt("Set rating (1-5)"),q=Number(A);if(A!==null){if(!Number.isInteger(q)||q<1||q>5){F.error("Invalid rating");return}try{ae(!0),await M.reports.moderate(t,{rating:q}),F.success("Rating updated"),await pe()}catch(Ne){F.error(((re=(Q=Ne==null?void 0:Ne.response)==null?void 0:Q.data)==null?void 0:re.error)||"Failed to set rating")}finally{ae(!1)}}},children:[e("i",{className:"bi bi-star-half me-1"}),"Set Rating"]})]})]})]}),a(z,{children:[a(P,{md:8,className:"mb-3",children:[a(x,{children:[e(x.Header,{children:e("strong",{children:"Content"})}),e(x.Body,{style:{whiteSpace:"pre-wrap"},children:s.content})]}),["admin","faculty_manager","principal_lecturer","program_leader"].includes(r==null?void 0:r.role)&&a(x,{className:"mb-3 mt-3",children:[e(x.Header,{children:e("strong",{children:"Manual Rating"})}),e(x.Body,{children:a(m,{onSubmit:async A=>{var q,Q;A.preventDefault();try{X(!0),await M.reports.moderate(t,{rating:Number(R||0)}),F.success("Rating updated"),await pe()}catch(re){F.error(((Q=(q=re==null?void 0:re.response)==null?void 0:q.data)==null?void 0:Q.error)||"Failed to update rating")}finally{X(!1)}},children:[a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Set Rating (1-5)"}),a(m.Select,{value:R,onChange:A=>G(A.target.value),disabled:H,children:[e("option",{value:"",children:"Select"}),[5,4,3,2,1].map(A=>e("option",{value:A,children:A},A))]})]}),e("div",{className:"d-flex justify-content-end",children:e(K,{type:"submit",variant:"warning",disabled:H||!R,children:H?"Saving...":"Save Rating"})})]})})]}),a(x,{className:"mt-3",children:[e(x.Header,{children:e("strong",{children:"Feedback"})}),a(x.Body,{children:[Array.isArray(n)&&n.length>0?e("ul",{className:"list-unstyled",children:n.map(A=>a("li",{className:"mb-3",children:[a("div",{className:"d-flex justify-content-between",children:[a("div",{children:[e(ue,{bg:"secondary",className:"me-2",children:A.feedback_type}),a("strong",{children:[A.from_first_name," ",A.from_last_name]}),a("span",{className:"text-muted ms-2 small",children:["to ",A.to_first_name," ",A.to_last_name]})]}),e("small",{className:"text-muted",children:new Date(A.created_at).toLocaleString()})]}),e("div",{className:"mt-1",style:{whiteSpace:"pre-wrap"},children:A.feedback_content})]},A.id))}):e("div",{className:"text-muted",children:"No feedback yet"}),ke()&&a(m,{onSubmit:Oe,className:"mt-3",children:[a(z,{className:"g-2 align-items-end",children:[a(P,{md:3,children:[e(m.Label,{children:"Type"}),a(m.Select,{value:b,onChange:A=>v(A.target.value),disabled:g,children:[e("option",{value:"approval",children:"Approval"}),e("option",{value:"rejection",children:"Rejection"}),e("option",{value:"suggestion",children:"Suggestion"}),e("option",{value:"clarification",children:"Clarification"})]})]}),a(P,{md:9,children:[e(m.Label,{children:"Feedback"}),e(m.Control,{as:"textarea",rows:3,value:y,onChange:A=>N(A.target.value),disabled:g,placeholder:"Write your feedback..."})]})]}),e("div",{className:"mt-2 d-flex justify-content-end",children:e(K,{type:"submit",variant:"primary",disabled:g,children:g?"Submitting...":"Submit Feedback"})})]})]})]})]}),a(P,{md:4,children:[a(x,{className:"mb-3",children:[e(x.Header,{children:e("strong",{children:"Attachments"})}),a(x.Body,{children:[l.length===0?e("div",{className:"text-muted",children:"No attachments"}):e("ul",{className:"list-unstyled mb-0",children:l.map((A,q)=>a("li",{className:"d-flex justify-content-between align-items-center mb-2",children:[a("a",{href:A.url,target:"_blank",rel:"noreferrer",className:"text-decoration-none",children:[e("i",{className:"bi bi-paperclip me-1"}),A.filename]}),a("small",{className:"text-muted",children:[Math.ceil(A.size/1024)," KB"]})]},q))}),me()&&a(m.Group,{className:"mt-3",children:[e(m.Label,{className:"btn btn-outline-primary",children:h?"Uploading...":"Upload Files"}),e(m.Control,{type:"file",multiple:!0,onChange:ct,hidden:!0,disabled:h})]})]})]}),(r==null?void 0:r.role)==="student"&&(s==null?void 0:s.course_id)&&a(x,{children:[e(x.Header,{children:e("strong",{children:"Rate This Class"})}),e(x.Body,{children:k.length===0?e("div",{className:"text-muted",children:"No lecturers assigned to this course"}):a(m,{onSubmit:async A=>{var q,Q;if(A.preventDefault(),!D){F.error("Please select a lecturer");return}try{B(!0),await M.users.rateClass({courseId:s.course_id,lecturerId:Number(D),rating:Number(E),comments:j,classDate:new Date().toISOString().split("T")[0]}),F.success("Thank you for your rating"),W("")}catch(re){F.error(((Q=(q=re==null?void 0:re.response)==null?void 0:q.data)==null?void 0:Q.error)||"Failed to submit rating")}finally{B(!1)}},children:[a(m.Group,{className:"mb-2",children:[e(m.Label,{children:"Lecturer"}),a(m.Select,{value:D,onChange:A=>I(A.target.value),disabled:T,children:[e("option",{value:"",children:"Select lecturer"}),k.map(A=>a("option",{value:A.id,children:[A.first_name," ",A.last_name]},A.id))]})]}),a(m.Group,{className:"mb-2",children:[e(m.Label,{children:"Rating"}),e(m.Select,{value:E,onChange:A=>L(A.target.value),disabled:T,children:[5,4,3,2,1].map(A=>e("option",{value:A,children:A},A))})]}),a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Comments (optional)"}),e(m.Control,{as:"textarea",rows:3,value:j,onChange:A=>W(A.target.value),disabled:T})]}),e("div",{className:"d-flex justify-content-end",children:e(K,{type:"submit",variant:"success",disabled:T,children:T?"Submitting...":"Submit Rating"})})]})})]})]})]})]}):null}const hr="registered_students_by_course_code_v1",mr=()=>{try{return JSON.parse(localStorage.getItem(hr)||"{}")}catch{return{}}},gs=(t,r)=>{const s=mr();t&&(s[String(t).toUpperCase()]=Number(r)||0,localStorage.setItem(hr,JSON.stringify(s)))},vs=t=>{const r=mr();if(!t)return;const s=String(t).toUpperCase();return r[s]};function bs(){const t=Fe(),{user:r}=ye(),[s,i]=p.useState([]),[n,c]=p.useState(!1),[l,o]=p.useState({facultyName:"",className:"",weekOfReporting:"",dateOfLecture:"",courseId:"",courseName:"",courseCode:"",lecturerName:"",actualStudentsPresent:"",totalRegisteredStudents:"",venue:"",scheduledLectureTime:"",topicTaught:"",learningOutcomes:"",recommendations:""}),[d,u]=p.useState({}),[h,C]=p.useState(!1),[w,f]=p.useState("");p.useEffect(()=>{(r!=null&&r.firstName||r!=null&&r.lastName)&&o(v=>({...v,lecturerName:`${(r==null?void 0:r.firstName)||""} ${(r==null?void 0:r.lastName)||""}`.trim()}))},[r]),p.useEffect(()=>{(async()=>{try{c(!0);const{data:y}=await M.users.getAvailableCourses(),N=Array.isArray(y)?y:(y==null?void 0:y.courses)||[];i(Array.isArray(N)?N:[])}catch{}finally{c(!1)}})()},[]),p.useEffect(()=>{if(l.courseCode){const v=vs(l.courseCode);typeof v=="number"&&v>0&&o(y=>({...y,totalRegisteredStudents:String(v)}))}},[l.courseCode]);const g=v=>{const{name:y,value:N}=v.target;o(k=>({...k,[y]:N})),d[y]&&u(k=>({...k,[y]:""}))},S=()=>{const v={};l.facultyName.trim()||(v.facultyName="Faculty Name is required"),l.className.trim()||(v.className="Class Name is required"),l.weekOfReporting||(v.weekOfReporting="Week of Reporting is required"),l.dateOfLecture||(v.dateOfLecture="Date of Lecture is required"),l.courseId||(v.courseId="Please select a Course"),l.courseName.trim()||(v.courseName="Course Name is required"),l.courseCode.trim()||(v.courseCode="Course Code is required"),l.lecturerName.trim()||(v.lecturerName="Lecturer's Name is required");const y=Number(l.actualStudentsPresent);l.actualStudentsPresent?(!Number.isFinite(y)||y<0)&&(v.actualStudentsPresent="Enter a valid non-negative number"):v.actualStudentsPresent="Actual number present is required";const N=Number(l.totalRegisteredStudents);return l.totalRegisteredStudents===""?v.totalRegisteredStudents="Total Registered Students is required":!Number.isFinite(N)||N<=0?v.totalRegisteredStudents="Enter a valid positive number":Number.isFinite(y)&&y>N&&(v.actualStudentsPresent="Present cannot exceed total registered"),l.venue.trim()||(v.venue="Venue is required"),l.scheduledLectureTime||(v.scheduledLectureTime="Scheduled Lecture Time is required"),l.topicTaught.trim()||(v.topicTaught="Topic Taught is required"),l.learningOutcomes.trim()||(v.learningOutcomes="Learning Outcomes are required"),u(v),Object.keys(v).length===0},b=async v=>{var y,N;if(v.preventDefault(),f(""),!!S())try{C(!0),l.courseCode&&l.totalRegisteredStudents&&gs(l.courseCode,Number(l.totalRegisteredStudents));const k={reportType:"lecturer_report",title:`${l.courseCode}  ${l.topicTaught}`,description:[`Faculty: ${l.facultyName}`,`Class: ${l.className}`,`Week: ${l.weekOfReporting}`,`Date of Lecture: ${l.dateOfLecture}`,`Course: ${l.courseName} (${l.courseCode})`,`Lecturer: ${l.lecturerName}`,`Students Present: ${l.actualStudentsPresent} / ${l.totalRegisteredStudents}`,`Venue: ${l.venue}`,`Scheduled Time: ${l.scheduledLectureTime}`,`Topic Taught: ${l.topicTaught}`,`Learning Outcomes: ${l.learningOutcomes}`,`Recommendations: ${l.recommendations||"N/A"}`].join(`
`),courseId:Number(l.courseId),details:{facultyName:l.facultyName,className:l.className,weekOfReporting:l.weekOfReporting,dateOfLecture:l.dateOfLecture,courseName:l.courseName,courseCode:l.courseCode,lecturerName:l.lecturerName,actualStudentsPresent:Number(l.actualStudentsPresent),totalRegisteredStudents:Number(l.totalRegisteredStudents),venue:l.venue,scheduledLectureTime:l.scheduledLectureTime,topicTaught:l.topicTaught,learningOutcomes:l.learningOutcomes,recommendations:l.recommendations}};await M.reports.create(k),F.success("Lecturer report submitted"),t("/reports")}catch(k){const _=((N=(y=k==null?void 0:k.response)==null?void 0:y.data)==null?void 0:N.error)||"Failed to submit lecturer report";f(_),F.error(_)}finally{C(!1)}};return a("div",{className:"container py-4",children:[e("h1",{className:"mb-3",children:"Data Entry (Lecturer Reporting Form)"}),e(x,{children:a(x.Body,{children:[w&&e(Z,{variant:"danger",children:w}),a(m,{onSubmit:b,children:[e(z,{children:e(P,{md:12,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Course"}),a(m.Select,{name:"courseId",value:l.courseId,onChange:v=>{const y=v.target.value;o(k=>({...k,courseId:y})),d.courseId&&u(k=>({...k,courseId:""}));const N=s.find(k=>String(k.id)===y);N&&o(k=>({...k,courseId:String(N.id),courseName:N.course_name||N.name||k.courseName,courseCode:N.course_code||k.courseCode}))},disabled:n,isInvalid:!!d.courseId,children:[e("option",{value:"",children:n?"Loading courses...":"Select a course"}),s.map(v=>a("option",{value:v.id,children:[v.course_name||v.name,v.course_code?` (${v.course_code})`:""]},v.id))]}),e(m.Control.Feedback,{type:"invalid",children:d.courseId}),!n&&s.length===0&&e(m.Text,{className:"text-warning",children:"No courses available. Please contact your Program Leader."})]})})}),a(z,{children:[e(P,{md:6,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Faculty Name"}),e(m.Control,{name:"facultyName",value:l.facultyName,onChange:g,isInvalid:!!d.facultyName}),e(m.Control.Feedback,{type:"invalid",children:d.facultyName})]})}),e(P,{md:6,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Class Name"}),e(m.Control,{name:"className",value:l.className,onChange:g,isInvalid:!!d.className}),e(m.Control.Feedback,{type:"invalid",children:d.className})]})})]}),a(z,{children:[e(P,{md:6,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Week of Reporting"}),e(m.Control,{type:"week",name:"weekOfReporting",value:l.weekOfReporting,onChange:g,isInvalid:!!d.weekOfReporting}),e(m.Control.Feedback,{type:"invalid",children:d.weekOfReporting})]})}),e(P,{md:6,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Date of Lecture"}),e(m.Control,{type:"date",name:"dateOfLecture",value:l.dateOfLecture,onChange:g,isInvalid:!!d.dateOfLecture}),e(m.Control.Feedback,{type:"invalid",children:d.dateOfLecture})]})})]}),a(z,{children:[e(P,{md:6,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Course Name"}),a(Ie,{children:[e(m.Control,{name:"courseName",value:l.courseName,onChange:g,isInvalid:!!d.courseName}),e(m.Control,{readOnly:!0,value:l.courseId?"Selected from list":"",placeholder:"",style:{maxWidth:180}})]}),e(m.Control.Feedback,{type:"invalid",children:d.courseName})]})}),e(P,{md:6,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Course Code"}),e(m.Control,{name:"courseCode",value:l.courseCode,onChange:g,isInvalid:!!d.courseCode}),e(m.Control.Feedback,{type:"invalid",children:d.courseCode})]})})]}),a(z,{children:[e(P,{md:6,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Lecturers Name"}),e(m.Control,{name:"lecturerName",value:l.lecturerName,onChange:g,isInvalid:!!d.lecturerName}),e(m.Control.Feedback,{type:"invalid",children:d.lecturerName})]})}),e(P,{md:3,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Actual Students Present"}),e(m.Control,{type:"number",min:0,name:"actualStudentsPresent",value:l.actualStudentsPresent,onChange:g,isInvalid:!!d.actualStudentsPresent}),e(m.Control.Feedback,{type:"invalid",children:d.actualStudentsPresent})]})}),e(P,{md:3,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Total Registered Students"}),e(m.Control,{type:"number",min:1,name:"totalRegisteredStudents",value:l.totalRegisteredStudents,onChange:g,isInvalid:!!d.totalRegisteredStudents}),e(m.Text,{className:"text-muted",children:"Auto-filled for known course codes."}),e(m.Control.Feedback,{type:"invalid",children:d.totalRegisteredStudents})]})})]}),a(z,{children:[e(P,{md:6,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Venue of the Class"}),e(m.Control,{name:"venue",value:l.venue,onChange:g,isInvalid:!!d.venue}),e(m.Control.Feedback,{type:"invalid",children:d.venue})]})}),e(P,{md:6,children:a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Scheduled Lecture Time"}),e(m.Control,{type:"time",name:"scheduledLectureTime",value:l.scheduledLectureTime,onChange:g,isInvalid:!!d.scheduledLectureTime}),e(m.Control.Feedback,{type:"invalid",children:d.scheduledLectureTime})]})})]}),a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Topic Taught"}),e(m.Control,{name:"topicTaught",value:l.topicTaught,onChange:g,isInvalid:!!d.topicTaught}),e(m.Control.Feedback,{type:"invalid",children:d.topicTaught})]}),a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Learning Outcomes of the Topic"}),e(m.Control,{as:"textarea",rows:4,name:"learningOutcomes",value:l.learningOutcomes,onChange:g,isInvalid:!!d.learningOutcomes}),e(m.Control.Feedback,{type:"invalid",children:d.learningOutcomes})]}),a(m.Group,{className:"mb-4",children:[e(m.Label,{children:"Lecturers Recommendations"}),e(m.Control,{as:"textarea",rows:3,name:"recommendations",value:l.recommendations,onChange:g})]}),a("div",{className:"d-flex gap-2",children:[e(K,{type:"submit",variant:"primary",disabled:h,children:h?"Submitting...":"Submit Lecturer Report"}),e(K,{variant:"outline-secondary",onClick:()=>t(-1),disabled:h,children:"Cancel"})]})]})]})})]})}function ys(){const{user:t,isLoading:r,loadUser:s}=ye(),[i,n]=p.useState(null),[c,l]=p.useState(!0),[o,d]=p.useState(!1),[u,h]=p.useState(!1),[C,w]=p.useState("");p.useEffect(()=>{(async()=>{var v,y;try{l(!0);const{data:N}=await M.users.getMe();n({id:N.id,username:N.username,email:N.email,role:N.role,firstName:N.first_name||"",lastName:N.last_name||"",phone:N.phone||"",avatarUrl:N.avatarUrl||null,created_at:N.created_at})}catch(N){w(((y=(v=N==null?void 0:N.response)==null?void 0:v.data)==null?void 0:y.error)||"Failed to load profile")}finally{l(!1)}})()},[]);const f=(b,v)=>n(y=>({...y,[b]:v})),g=async b=>{var v,y;b.preventDefault(),w("");try{d(!0),await M.users.updateMe({firstName:i.firstName,lastName:i.lastName,phone:i.phone}),F.success("Profile updated"),await s()}catch(N){const k=((y=(v=N==null?void 0:N.response)==null?void 0:v.data)==null?void 0:y.error)||"Failed to update profile";w(k),F.error(k)}finally{d(!1)}},S=async b=>{var N,k,_;const v=(N=b.target.files)==null?void 0:N[0];if(!v)return;if(!["image/png","image/jpeg","image/jpg","image/webp","image/gif"].includes(v.type)){F.error("Invalid image type");return}if(v.size>3*1024*1024){F.error("Image must be <= 3MB");return}try{h(!0);const{data:T}=await M.users.uploadAvatar(v);n(B=>({...B,avatarUrl:T.url})),F.success("Avatar updated"),await s()}catch(T){F.error(((_=(k=T==null?void 0:T.response)==null?void 0:k.data)==null?void 0:_.error)||"Failed to upload avatar")}finally{h(!1)}};return c||r||!i?e("div",{className:"container py-4",children:e(se,{})}):a("div",{className:"container py-4",children:[a("h2",{className:"mb-3",children:[e("i",{className:"bi bi-person-circle me-2"}),"My Profile"]}),C&&e(Z,{variant:"danger",children:C}),a(z,{children:[e(P,{md:4,className:"mb-3",children:a(x,{className:"h-100",children:[e(x.Header,{children:e("strong",{children:"Avatar"})}),a(x.Body,{className:"text-center",children:[e("div",{className:"mb-3",children:i.avatarUrl?e("img",{src:i.avatarUrl,alt:"Avatar",className:"rounded-circle",style:{width:140,height:140,objectFit:"cover",border:"1px solid #eee"},onError:b=>{b.currentTarget.onerror=null,b.currentTarget.src="/default-avatar.svg"}}):e("div",{className:"rounded-circle bg-light d-flex align-items-center justify-content-center",style:{width:140,height:140,border:"1px solid #eee"},children:e("i",{className:"bi bi-person fs-1 text-muted"})})}),a(m.Group,{controlId:"avatar",children:[e(m.Label,{className:"btn btn-outline-primary",children:u?"Uploading...":"Upload Avatar"}),e(m.Control,{type:"file",accept:"image/*",onChange:S,disabled:u,hidden:!0})]})]})]})}),e(P,{md:8,children:a(x,{children:[e(x.Header,{children:e("strong",{children:"Profile Details"})}),e(x.Body,{children:a(m,{onSubmit:g,children:[a(z,{className:"mb-3",children:[e(P,{md:6,children:a(m.Group,{children:[e(m.Label,{children:"First Name"}),e(m.Control,{value:i.firstName,onChange:b=>f("firstName",b.target.value),disabled:o})]})}),e(P,{md:6,children:a(m.Group,{children:[e(m.Label,{children:"Last Name"}),e(m.Control,{value:i.lastName,onChange:b=>f("lastName",b.target.value),disabled:o})]})})]}),a(z,{className:"mb-3",children:[e(P,{md:6,children:a(m.Group,{children:[e(m.Label,{children:"Username"}),e(m.Control,{value:i.username,disabled:!0,readOnly:!0})]})}),e(P,{md:6,children:a(m.Group,{children:[e(m.Label,{children:"Email"}),e(m.Control,{value:i.email,disabled:!0,readOnly:!0})]})})]}),a(z,{className:"mb-3",children:[e(P,{md:6,children:a(m.Group,{children:[e(m.Label,{children:"Phone"}),e(m.Control,{value:i.phone,onChange:b=>f("phone",b.target.value),disabled:o})]})}),e(P,{md:6,children:a(m.Group,{children:[e(m.Label,{children:"Role"}),e(m.Control,{value:i.role,disabled:!0,readOnly:!0})]})})]}),e("div",{className:"d-flex gap-2",children:e(K,{type:"submit",variant:"primary",disabled:o,children:o?"Saving...":"Save Changes"})})]})})]})})]})]})}function Ns(){const{user:t}=ye(),[r,s]=p.useState([]),[i,n]=p.useState(!0),[c,l]=p.useState(!1),[o,d]=p.useState(!1),[u,h]=p.useState(null),[C,w]=p.useState(!1),[f,g]=p.useState(!1),[S,b]=p.useState([]),[v,y]=p.useState("student"),[N,k]=p.useState(null),[_,T]=p.useState({username:"",email:"",firstName:"",lastName:""}),[B,E]=p.useState(null),[L,D]=p.useState(""),[I,j]=p.useState({username:"",email:"",password:"",firstName:"",lastName:"",role:"student"}),W=p.useMemo(()=>["student","lecturer","program_leader","principal_lecturer","faculty_manager"],[]),R=async()=>{var O,A;try{n(!0),h(null);const{data:q}=await M.users.getAll();s(Array.isArray(q)?q:q.users||[]),b([])}catch(q){const Q=((A=(O=q.response)==null?void 0:O.data)==null?void 0:A.error)||"Failed to fetch users";h(Q),F.error(Q)}finally{n(!1)}},G=async O=>{var A,q;if(confirm("Generate a temporary password for this user? It will be shown once."))try{E(O);const{data:Q}=await M.users.resetPassword(O);D((Q==null?void 0:Q.tempPassword)||"")}catch(Q){F.error(((q=(A=Q.response)==null?void 0:A.data)==null?void 0:q.error)||"Failed to reset password")}finally{E(null)}},H=()=>D(""),X=async()=>{try{await navigator.clipboard.writeText(L),F.success("Copied")}catch{}};p.useEffect(()=>{C&&!f&&(async()=>(await R(),g(!0)))()},[C,f]);const ne=async O=>{var A,q,Q;(A=O==null?void 0:O.preventDefault)==null||A.call(O);try{d(!0),await M.users.create(I),F.success("User created"),j({username:"",email:"",password:"",firstName:"",lastName:"",role:"student"}),l(!1),await R()}catch(re){F.error(((Q=(q=re.response)==null?void 0:q.data)==null?void 0:Q.error)||"Failed to create user")}finally{d(!1)}},ae=async(O,A)=>{var q,Q;try{await M.users.update(O,{role:A}),F.success("Role updated"),await R()}catch(re){F.error(((Q=(q=re.response)==null?void 0:q.data)==null?void 0:Q.error)||"Failed to update role")}},me=async O=>{var A,q;try{O.is_active===!1?(await M.users.reactivate(O.id),F.success("User reactivated")):(await M.users.deactivate(O.id),F.success("User deactivated")),await R()}catch(Q){F.error(((q=(A=Q.response)==null?void 0:A.data)==null?void 0:q.error)||"Failed to toggle active")}},ke=async O=>{var A,q;if(confirm("Are you sure you want to delete this user?"))try{await M.users.delete(O),F.success("User deleted"),await R()}catch(Q){F.error(((q=(A=Q.response)==null?void 0:A.data)==null?void 0:q.error)||"Failed to delete user")}},Oe=O=>{k(O.id),T({username:O.username||"",email:O.email||"",firstName:O.firstName??O.first_name??"",lastName:O.lastName??O.last_name??""})},pe=()=>{k(null),T({username:"",email:"",firstName:"",lastName:""})},ct=async O=>{var A,q;try{let Q;(t==null?void 0:t.role)==="admin"?Q={username:_.username,email:_.email,firstName:_.firstName,lastName:_.lastName,first_name:_.firstName,last_name:_.lastName}:Q={firstName:_.firstName,lastName:_.lastName,first_name:_.firstName,last_name:_.lastName},await M.users.update(O,Q),F.success("User updated"),pe(),await R()}catch(Q){F.error(((q=(A=Q.response)==null?void 0:A.data)==null?void 0:q.error)||"Failed to update user")}};return a("div",{className:"container py-4",children:[a("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e("h1",{className:"m-0",children:"Users Management"}),a("div",{className:"d-flex gap-2",children:[e("button",{className:"btn btn-outline-secondary",onClick:()=>w(O=>!O),children:C?"Hide Users":"Show Users"}),e("button",{className:"btn btn-primary",onClick:()=>l(O=>!O),children:c?"Close":"Add User"})]})]}),C&&(t==null?void 0:t.role)==="admin"&&e("div",{className:"card card-body mb-3",children:a("div",{className:"d-flex flex-wrap align-items-center gap-2",children:[a("span",{className:"me-2",children:["Bulk actions for ",S.length," selected:"]}),e("button",{className:"btn btn-sm btn-outline-success",onClick:()=>doBulk("activate"),disabled:S.length===0,children:"Activate"}),e("button",{className:"btn btn-sm btn-outline-warning",onClick:()=>doBulk("deactivate"),disabled:S.length===0,children:"Deactivate"}),e("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>doBulk("delete"),disabled:S.length===0,children:"Delete"}),a("div",{className:"d-flex align-items-center gap-2 ms-2",children:[a("select",{className:"form-select form-select-sm",value:v,onChange:O=>y(O.target.value),children:[W.map(O=>e("option",{value:O,children:O},O)),e("option",{value:"admin",children:"admin"})]}),e("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>doBulk("setRole"),disabled:S.length===0,children:"Set Role"})]})]})}),c&&a("form",{className:"card card-body mb-4",onSubmit:ne,children:[a("div",{className:"row g-3",children:[a("div",{className:"col-md-4",children:[e("label",{className:"form-label",children:"Username"}),e("input",{className:"form-control",value:I.username,onChange:O=>j({...I,username:O.target.value}),required:!0})]}),a("div",{className:"col-md-4",children:[e("label",{className:"form-label",children:"Email"}),e("input",{type:"email",className:"form-control",value:I.email,onChange:O=>j({...I,email:O.target.value}),required:!0})]}),a("div",{className:"col-md-4",children:[e("label",{className:"form-label",children:"Password"}),e("input",{type:"password",className:"form-control",value:I.password,onChange:O=>j({...I,password:O.target.value}),required:!0})]}),a("div",{className:"col-md-4",children:[e("label",{className:"form-label",children:"First Name"}),e("input",{className:"form-control",value:I.firstName,onChange:O=>j({...I,firstName:O.target.value})})]}),a("div",{className:"col-md-4",children:[e("label",{className:"form-label",children:"Last Name"}),e("input",{className:"form-control",value:I.lastName,onChange:O=>j({...I,lastName:O.target.value})})]}),a("div",{className:"col-md-4",children:[e("label",{className:"form-label",children:"Role"}),e("select",{className:"form-select",value:I.role,onChange:O=>j({...I,role:O.target.value}),children:W.map(O=>e("option",{value:O,children:O},O))})]})]}),e("div",{className:"mt-3",children:e("button",{type:"submit",className:"btn btn-success",disabled:o,children:o?"Creating":"Create User"})})]}),C&&i&&e("div",{className:"py-5 text-center",children:"Loading users"}),C&&u&&e("div",{className:"alert alert-danger",children:u}),C&&!i&&!u&&e("div",{className:"table-responsive",children:a("table",{className:"table table-striped align-middle",children:[e("thead",{children:a("tr",{children:[e("th",{children:e("input",{type:"checkbox","aria-label":"Select all",checked:S.length>0&&S.length===r.length,onChange:O=>toggleAll(O.target.checked)})}),e("th",{children:"ID"}),e("th",{children:"Username"}),e("th",{children:"Email"}),e("th",{children:"Name"}),e("th",{children:"Role"}),e("th",{children:"Status"}),e("th",{style:{width:280},children:"Actions"})]})}),e("tbody",{children:r.map(O=>a("tr",{children:[e("td",{children:e("input",{type:"checkbox","aria-label":`Select user ${O.id}`,checked:S.includes(O.id),onChange:A=>toggleOne(O.id,A.target.checked)})}),e("td",{children:O.id}),e("td",{children:N===O.id&&(t==null?void 0:t.role)==="admin"?e("input",{className:"form-control form-control-sm",value:_.username,onChange:A=>T({..._,username:A.target.value})}):O.username}),e("td",{children:N===O.id&&(t==null?void 0:t.role)==="admin"?e("input",{type:"email",className:"form-control form-control-sm",value:_.email,onChange:A=>T({..._,email:A.target.value})}):O.email}),e("td",{children:N===O.id&&((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="program_leader")?a("div",{className:"d-flex gap-2",children:[e("input",{className:"form-control form-control-sm",placeholder:"First",style:{maxWidth:140},value:_.firstName,onChange:A=>T({..._,firstName:A.target.value})}),e("input",{className:"form-control form-control-sm",placeholder:"Last",style:{maxWidth:140},value:_.lastName,onChange:A=>T({..._,lastName:A.target.value})})]}):[O.firstName||O.first_name,O.lastName||O.last_name].filter(Boolean).join(" ")}),e("td",{children:a("select",{className:"form-select form-select-sm",value:O.role,onChange:A=>ae(O.id,A.target.value),disabled:(t==null?void 0:t.role)==="program_leader"&&O.role!=="student"&&O.role!=="lecturer",children:[W.map(A=>e("option",{value:A,children:A},A)),e("option",{value:"admin",children:"admin"})]})}),e("td",{children:O.is_active===!1?e("span",{className:"badge bg-secondary",children:"Inactive"}):e("span",{className:"badge bg-success",children:"Active"})}),e("td",{children:a("div",{className:"d-flex gap-2",children:[((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="program_leader"&&(O.role==="student"||O.role==="lecturer"))&&(N===O.id?a(de,{children:[e("button",{className:"btn btn-sm btn-success",onClick:()=>ct(O.id),children:"Save"}),e("button",{className:"btn btn-sm btn-secondary",onClick:pe,children:"Cancel"})]}):e("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>Oe(O),children:"Edit"})),(t==null?void 0:t.role)==="admin"&&e("button",{className:"btn btn-sm btn-outline-dark",onClick:()=>G(O.id),disabled:B===O.id,children:B===O.id?"Resetting":"Reset Password"}),e("button",{className:"btn btn-sm btn-outline-warning",onClick:()=>me(O),children:O.is_active===!1?"Reactivate":"Deactivate"}),e("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>ke(O.id),children:"Delete"})]})})]},O.id))})]})}),L&&e("div",{className:"modal fade show",style:{display:"block",background:"rgba(0,0,0,0.5)"},tabIndex:"-1",role:"dialog","aria-modal":"true",children:e("div",{className:"modal-dialog modal-sm modal-dialog-centered",children:a("div",{className:"modal-content",children:[a("div",{className:"modal-header",children:[e("h5",{className:"modal-title",children:"Temporary Password"}),e("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:H})]}),a("div",{className:"modal-body",children:[e("div",{className:"alert alert-warning small",children:"Shown once. Copy and share securely with the user."}),a("div",{className:"input-group",children:[e("input",{className:"form-control",value:L,readOnly:!0}),e("button",{className:"btn btn-outline-secondary",onClick:X,children:"Copy"})]})]}),e("div",{className:"modal-footer",children:e("button",{type:"button",className:"btn btn-primary",onClick:H,children:"Done"})})]})})})]})}$e.register(gt,vt,bt,yt,Sr,Nt,Bt,Qt);function He({title:t,value:r,subtitle:s}){return e("div",{className:"card shadow-sm h-100",children:a("div",{className:"card-body",children:[e("h6",{className:"text-muted mb-1",children:t}),e("div",{className:"display-6 fw-bold",children:r??"-"}),s&&e("div",{className:"text-secondary small mt-1",children:s})]})})}function pr(){const t=Fe(),[r,s]=p.useState(30),{data:i,isLoading:n,isError:c,refetch:l}=be(["admin-overview",r],async()=>{const _=await M.admin.getOverview(r);return(_==null?void 0:_.data)??_},{refetchInterval:6e4});if(n)return e("div",{className:"container py-4",children:"Loading admin overview..."});if(c)return e("div",{className:"container py-4 text-danger",children:"Failed to load admin overview"});const o=(i==null?void 0:i.users)||{},d=(i==null?void 0:i.reports)||{},u=(i==null?void 0:i.streams)||[],h=(i==null?void 0:i.topCourses)||[],C=(i==null?void 0:i.recentUsers)||[],w=(i==null?void 0:i.reportTrend)||[],f=w.map(_=>new Date(_.day).toLocaleDateString()),g=w.map(_=>_.count),S={labels:f,datasets:[{label:"Reports (last 30 days)",data:g,fill:!0,borderColor:"rgba(13,110,253,1)",backgroundColor:"rgba(13,110,253,0.15)",tension:.25,pointRadius:2}]},b={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{display:!1}},y:{beginAtZero:!0}}},v={labels:["Draft","Submitted","Approved","Rejected"],datasets:[{data:[d.drafts||0,d.submitted||0,d.approved||0,d.rejected||0],backgroundColor:["#6c757d","#0d6efd","#198754","#dc3545"],borderWidth:0}]},y={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}};return a("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Admin Dashboard"}),e("p",{className:"text-secondary",children:"System-wide overview for administrators"}),a("div",{className:"d-flex flex-wrap gap-2 mb-3 admin-controls",children:[a("select",{className:"form-select form-select-sm",value:r,onChange:_=>s(Number(_.target.value)),children:[e("option",{value:7,children:"Last 7 days"}),e("option",{value:30,children:"Last 30 days"}),e("option",{value:90,children:"Last 90 days"})]}),e("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>l(),children:"Refresh"}),a("button",{type:"button",className:"btn btn-primary",onClick:()=>t("/users"),children:[e("i",{className:"bi bi-people me-2"}),"Manage Users"]}),a("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>t("/analytics"),children:[e("i",{className:"bi bi-graph-up me-2"}),"View Analytics"]}),a("button",{type:"button",className:"btn btn-outline-success",onClick:async()=>{try{const _=await M.export.reportsExcel({});Ee(_.data,`reports_${new Date().toISOString().slice(0,10)}.xlsx`)}catch{}},children:[e("i",{className:"bi bi-file-earmark-excel me-2"}),"Export Reports (Excel)"]}),a("button",{type:"button",className:"btn btn-outline-success",onClick:async()=>{try{const _=await M.export.usersExcel({});Ee(_.data,`users_${new Date().toISOString().slice(0,10)}.xlsx`)}catch{}},children:[e("i",{className:"bi bi-file-earmark-excel me-2"}),"Export Users (Excel)"]})]}),a("div",{className:"row g-3",children:[e("div",{className:"col-12 col-sm-6 col-lg-3",children:e(He,{title:"Total Users",value:o.total_users,subtitle:`${o.active_users||0} active`})}),e("div",{className:"col-12 col-sm-6 col-lg-3",children:e(He,{title:"Reports",value:d.total_reports,subtitle:`${d.submitted||0} submitted`})}),e("div",{className:"col-12 col-sm-6 col-lg-3",children:e(He,{title:"Lecturers",value:o.lecturers,subtitle:`${o.students||0} students`})}),e("div",{className:"col-12 col-sm-6 col-lg-3",children:e(He,{title:"Streams",value:u.length,subtitle:"Active streams"})})]}),a("div",{className:"row g-3 mt-1",children:[e("div",{className:"col-12 col-lg-8",children:a("div",{className:"card h-100",children:[e("div",{className:"card-header fw-semibold",children:"Reports Trend (30 days)"}),e("div",{className:"card-body",style:{height:280},children:e(At,{data:S,options:b})})]})}),e("div",{className:"col-12 col-lg-4",children:a("div",{className:"card h-100",children:[e("div",{className:"card-header fw-semibold",children:"Report Status"}),e("div",{className:"card-body",style:{height:280},children:e(cs,{data:v,options:y})})]})})]}),a("div",{className:"card mt-4",children:[e("div",{className:"card-header fw-semibold",children:"Streams Overview"}),e("div",{className:"table-responsive",children:a("table",{className:"table table-sm mb-0",children:[e("thead",{children:a("tr",{children:[e("th",{children:"Stream"}),e("th",{children:"Courses"}),e("th",{children:"Students"}),e("th",{children:"Lecturers"})]})}),a("tbody",{children:[u.map(_=>a("tr",{children:[e("td",{children:_.stream_name}),e("td",{children:_.courses}),e("td",{children:_.students}),e("td",{children:_.lecturers})]},_.id)),u.length===0&&e("tr",{children:e("td",{colSpan:4,className:"text-center text-muted",children:"No streams"})})]})]})})]}),a("div",{className:"card mt-4",children:[e("div",{className:"card-header fw-semibold",children:"Top Courses"}),e("div",{className:"table-responsive",children:a("table",{className:"table table-sm mb-0",children:[e("thead",{children:a("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Enrolled"}),e("th",{children:"Reports"}),e("th",{children:"Avg Rating"})]})}),a("tbody",{children:[h.map(_=>a("tr",{children:[e("td",{children:_.course_name}),e("td",{children:_.course_code}),e("td",{children:_.enrolled_students}),e("td",{children:_.report_count}),e("td",{children:_.avg_rating?Number(_.avg_rating).toFixed(1):"-"})]},_.id)),h.length===0&&e("tr",{children:e("td",{colSpan:5,className:"text-center text-muted",children:"No courses"})})]})]})})]}),a("div",{className:"card mt-4",children:[e("div",{className:"card-header fw-semibold",children:"Recent Users"}),e("div",{className:"table-responsive",children:a("table",{className:"table table-sm mb-0",children:[e("thead",{children:a("tr",{children:[e("th",{children:"ID"}),e("th",{children:"Username"}),e("th",{children:"Email"}),e("th",{children:"Role"}),e("th",{children:"Joined"})]})}),a("tbody",{children:[C.map(_=>a("tr",{children:[e("td",{children:_.id}),e("td",{children:_.username}),e("td",{children:_.email}),e("td",{children:e("span",{className:`admin-role-badge badge-role-${_.role}`,children:String(_.role).replace("_"," ")})}),e("td",{children:new Date(_.created_at).toLocaleString()})]},_.id)),C.length===0&&e("tr",{children:e("td",{colSpan:5,className:"text-center text-muted",children:"No users"})})]})]})})]}),a("div",{className:"text-secondary small mt-3",children:["Last updated: ",new Date((i==null?void 0:i.generatedAt)||Date.now()).toLocaleString()]})]})}function Cs(){var N,k;const[t,r]=te.useState(1),[s,i]=te.useState(25),[n,c]=te.useState(""),[l,o]=te.useState(""),[d,u]=te.useState(""),[h,C]=te.useState(""),{data:w,isLoading:f,error:g,refetch:S}=be(["admin-audit",t,s,n,l,d,h],async()=>{const _={page:t,limit:s};n&&(_.action=n),l&&(_.q=l),d&&(_.startDate=d),h&&(_.endDate=h);const T=await M.admin.getAudit(_);return(T==null?void 0:T.data)??T},{keepPreviousData:!0,refetchOnWindowFocus:!1}),b=(w==null?void 0:w.logs)||[],v=(w==null?void 0:w.pagination)||{page:1,pages:1,total:0,limit:s};return a("div",{className:"container py-4",children:[a("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[a("h2",{className:"mb-0",children:[e("i",{className:"bi bi-clipboard-data me-2"}),"Audit Logs"]}),a("div",{className:"d-flex gap-2",children:[e("input",{className:"form-control form-control-sm",style:{maxWidth:220},placeholder:"Search user/email",value:l,onChange:_=>{o(_.target.value),r(1)}}),a("select",{className:"form-select form-select-sm",value:n,onChange:_=>{c(_.target.value),r(1)},children:[e("option",{value:"",children:"All actions"}),e("option",{value:"activate",children:"activate"}),e("option",{value:"deactivate",children:"deactivate"}),e("option",{value:"delete",children:"delete"}),e("option",{value:"setRole",children:"setRole"})]}),e("input",{type:"date",className:"form-control form-control-sm",value:d,onChange:_=>{u(_.target.value),r(1)}}),e("input",{type:"date",className:"form-control form-control-sm",value:h,onChange:_=>{C(_.target.value),r(1)}}),a("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>S(),disabled:f,children:[e("i",{className:"bi bi-arrow-clockwise me-1"})," Refresh"]}),a("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>{const _=["When","User","Email","Action","TargetType","TargetIds","Meta"],T=b.map(I=>[I.created_at,I.username||`User #${I.user_id}`,I.email||"",I.action,I.target_type,Array.isArray(I.target_ids)?I.target_ids.join("|"):String(I.target_ids),I.meta?JSON.stringify(I.meta):"{}"]),B=[_,...T].map(I=>I.map(j=>'"'+String(j).replaceAll('"','""')+'"').join(",")).join(`
`),E=new Blob([B],{type:"text/csv;charset=utf-8;"}),L=window.URL.createObjectURL(E),D=document.createElement("a");D.href=L,D.download=`audit_logs_${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(D),D.click(),D.remove(),window.URL.revokeObjectURL(L)},disabled:f||b.length===0,children:[e("i",{className:"bi bi-download me-1"})," Export CSV"]})]})]}),a("div",{className:"card",children:[e("div",{className:"table-responsive",children:a("table",{className:"table table-sm table-striped mb-0",children:[e("thead",{children:a("tr",{children:[e("th",{children:"When"}),e("th",{children:"User"}),e("th",{children:"Action"}),e("th",{children:"Target"}),e("th",{children:"Meta"})]})}),a("tbody",{children:[f&&e("tr",{children:e("td",{colSpan:5,className:"text-center py-4 text-muted",children:"Loading..."})}),g&&e("tr",{children:e("td",{colSpan:5,className:"text-danger",children:((k=(N=g==null?void 0:g.response)==null?void 0:N.data)==null?void 0:k.error)||"Failed to load audit logs"})}),!f&&!g&&b.length===0&&e("tr",{children:e("td",{colSpan:5,className:"text-center py-4 text-muted",children:"No audit logs found."})}),!f&&!g&&b.map(_=>a("tr",{children:[a("td",{children:[e("div",{children:new Date(_.created_at).toLocaleDateString()}),e("div",{className:"text-muted small",children:new Date(_.created_at).toLocaleTimeString()})]}),a("td",{children:[e("div",{className:"fw-semibold",children:_.username||"User #"+_.user_id}),e("div",{className:"text-muted small",children:_.email||""})]}),e("td",{children:e("span",{className:"badge bg-secondary text-uppercase",children:String(_.action)})}),a("td",{children:[e("div",{className:"small text-muted",children:_.target_type}),e("div",{className:"fw-semibold",children:Array.isArray(_.target_ids)?_.target_ids.join(", "):String(_.target_ids)})]}),e("td",{className:"small",children:e("code",{children:_.meta?JSON.stringify(_.meta):"{}"})})]},_.id))]})]})}),v.pages>1&&a("div",{className:"card-footer d-flex align-items-center justify-content-between",children:[a("div",{className:"text-muted small",children:["Page ",v.page," of ",v.pages,"  ",v.total," total"]}),a("div",{className:"d-flex align-items-center gap-2",children:[e("button",{className:"btn btn-sm btn-outline-secondary",disabled:v.page<=1,onClick:()=>r(_=>Math.max(1,_-1)),children:"Prev"}),e("button",{className:"btn btn-sm btn-outline-secondary",disabled:v.page>=v.pages,onClick:()=>r(_=>Math.min(v.pages,_+1)),children:"Next"}),a("select",{className:"form-select form-select-sm ms-2",style:{width:120},value:s,onChange:_=>{i(parseInt(_.target.value)),r(1)},children:[e("option",{value:10,children:"10 per page"}),e("option",{value:25,children:"25 per page"}),e("option",{value:50,children:"50 per page"})]})]})]})]})]})}$e.register(gt,vt,bt,yt,wr,_r,Nt,Bt);function Ss(){var g,S;const[t,r]=te.useState(30),{data:s,isLoading:i,error:n,refetch:c}=be(["dashboard-analytics",t],()=>M.dashboard.getAnalytics(t),{onError:b=>{var v,y;F.error(((y=(v=b==null?void 0:b.response)==null?void 0:v.data)==null?void 0:y.error)||"Failed to load analytics")}}),l=(b,v)=>{try{return(getComputedStyle(document.documentElement).getPropertyValue(b)||"").trim()||v}catch{return v}},o=l("--brand","rgba(13,110,253,1)"),d=o.startsWith("#")?`${o}33`:"rgba(13,110,253,0.2)",u=l("--text","#111827"),h=l("--muted","#6b7280"),C=b=>{r(b)},w=async()=>{var b,v;try{const{data:y}=await M.export.analyticsExcel({days:t,responseType:"blob"});Ee(y,`analytics_${t}d.xlsx`)}catch(y){F.error(((v=(b=y==null?void 0:y.response)==null?void 0:b.data)==null?void 0:v.error)||"Failed to export analytics")}},f=async()=>{var b,v;try{const y={startDate:new Date(Date.now()-t*24*60*60*1e3).toISOString().split("T")[0]},{data:N}=await M.export.reportsPdf(y);Ee(N,`reports_${t}d.pdf`)}catch(y){F.error(((v=(b=y==null?void 0:y.response)==null?void 0:b.data)==null?void 0:v.error)||"Failed to export reports PDF")}};return i?e(xt,{}):a("div",{className:"container py-4",children:[e("h1",{className:"mb-4",children:"Analytics"}),a("div",{className:"d-flex flex-wrap justify-content-between align-items-center mb-3",children:[e("div",{className:"btn-group",role:"group","aria-label":"Time range",children:[7,30,90].map(b=>a("button",{className:`btn btn-sm ${t===b?"btn-primary":"btn-outline-primary"}`,onClick:()=>C(b),children:["Last ",b," days"]},b))}),a("div",{className:"d-flex gap-2 mt-2 mt-sm-0",children:[a("button",{className:"btn btn-outline-success btn-sm",onClick:w,children:[e("i",{className:"bi bi-file-earmark-excel me-1"})," Export Analytics (Excel)"]}),a("button",{className:"btn btn-outline-danger btn-sm",onClick:f,children:[e("i",{className:"bi bi-filetype-pdf me-1"})," Export Reports (PDF)"]})]})]}),n&&e(Z,{variant:"danger",children:((S=(g=n==null?void 0:n.response)==null?void 0:g.data)==null?void 0:S.error)||"Failed to load analytics"}),a(z,{className:"g-3",children:[e(P,{lg:6,children:a(x,{className:"h-100",children:[e(x.Header,{children:a("h6",{className:"m-0",children:[e("i",{className:"bi bi-graph-up me-2"}),"Report Trends (30 days)"]})}),e(x.Body,{children:Array.isArray(s==null?void 0:s.reportTrends)&&s.reportTrends.length>0?a(de,{children:[e(At,{data:{labels:s.reportTrends.map(b=>new Date(b.report_date).toLocaleDateString()),datasets:[{label:"Reports",data:s.reportTrends.map(b=>b.report_count),borderColor:o,backgroundColor:d,tension:.3},{label:"Approved",data:s.reportTrends.map(b=>b.approved_count),borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.2)",tension:.3}]},options:{responsive:!0,plugins:{legend:{position:"top",labels:{color:u}}},scales:{x:{ticks:{color:h},grid:{display:!1}},y:{beginAtZero:!0,ticks:{color:h},grid:{color:"rgba(100,116,139,0.2)"}}}}}),a("div",{className:"text-muted small mt-2",children:["Legend: ",e("span",{className:"text-primary",children:"Reports"})," vs ",e("span",{className:"text-success",children:"Approved"})," across selected time range."]})]}):e("div",{className:"text-muted",children:"No trend data"})})]})}),e(P,{lg:6,children:a(x,{className:"h-100",children:[e(x.Header,{children:a("h6",{className:"m-0",children:[e("i",{className:"bi bi-star-half me-2"}),"Rating Distribution"]})}),e(x.Body,{children:Array.isArray(s==null?void 0:s.ratingDistribution)&&s.ratingDistribution.length>0?a(de,{children:[e(ot,{data:{labels:s.ratingDistribution.map(b=>`Rating ${b.rating}`),datasets:[{label:"Count",data:s.ratingDistribution.map(b=>b.count),backgroundColor:"rgba(255, 206, 86, 0.6)",borderColor:"rgba(255, 206, 86, 1)",borderWidth:1}]},options:{responsive:!0,plugins:{legend:{labels:{color:u}}},scales:{x:{ticks:{color:h},grid:{display:!1}},y:{beginAtZero:!0,ticks:{color:h},grid:{color:"rgba(100,116,139,0.2)"}}}}}),e("div",{className:"text-muted small mt-2",children:"Legend: Bars show how many reports received each rating."})]}):e("div",{className:"text-muted",children:"No rating data"})})]})})]}),a(z,{className:"g-3 mt-1",children:[e(P,{lg:6,children:a(x,{className:"h-100",children:[e(x.Header,{children:a("h6",{className:"m-0",children:[e("i",{className:"bi bi-diagram-3 me-2"}),"Stream Performance"]})}),e(x.Body,{children:Array.isArray(s==null?void 0:s.streamPerformance)&&s.streamPerformance.length>0?a(de,{children:[e(ot,{data:{labels:s.streamPerformance.map(b=>b.stream_name),datasets:[{label:"Total Reports",data:s.streamPerformance.map(b=>b.total_reports),backgroundColor:d,borderColor:o,borderWidth:1},{label:"Approved Reports",data:s.streamPerformance.map(b=>b.approved_reports),backgroundColor:"rgba(75, 192, 192, 0.6)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]},options:{responsive:!0,plugins:{legend:{labels:{color:u}}},scales:{x:{ticks:{color:h},grid:{display:!1}},y:{beginAtZero:!0,ticks:{color:h},grid:{color:"rgba(100,116,139,0.2)"}}}}}),e("div",{className:"text-muted small mt-2",children:"Legend: Blue = Total Reports, Teal = Approved Reports per stream."})]}):e("div",{className:"text-muted",children:"No stream performance data"})})]})}),e(P,{lg:6,children:a(x,{className:"h-100",children:[e(x.Header,{children:a("h6",{className:"m-0",children:[e("i",{className:"bi bi-book me-2"}),"Course Popularity"]})}),e(x.Body,{children:Array.isArray(s==null?void 0:s.coursePopularity)&&s.coursePopularity.length>0?a(de,{children:[e(ot,{data:{labels:s.coursePopularity.map(b=>b.course_name),datasets:[{label:"Enrolled Students",data:s.coursePopularity.map(b=>b.enrolled_students),backgroundColor:"rgba(153, 102, 255, 0.6)",borderColor:"rgba(153, 102, 255, 1)",borderWidth:1},{label:"Avg Rating",data:s.coursePopularity.map(b=>Number(b.avg_rating||0)),backgroundColor:"rgba(255, 159, 64, 0.6)",borderColor:"rgba(255, 159, 64, 1)",borderWidth:1}]},options:{responsive:!0,plugins:{legend:{labels:{color:u}}},scales:{x:{ticks:{color:h},grid:{display:!1}},y:{beginAtZero:!0,ticks:{color:h},grid:{color:"rgba(100,116,139,0.2)"}}}}}),e("div",{className:"text-muted small mt-2",children:"Legend: Purple = Enrolled Students, Orange = Average Rating per course."})]}):e("div",{className:"text-muted",children:"No course data"})})]})})]})]})}function ws(){return e("div",{className:"container d-flex align-items-center justify-content-center",style:{minHeight:"70vh"},children:e("div",{className:"text-center",style:{maxWidth:560},children:a("div",{className:"card-modern p-4 mb-3",children:[e("div",{className:"display-3 fw-bold",style:{background:"linear-gradient(135deg, var(--brand), #6f42c1)",WebkitBackgroundClip:"text",backgroundClip:"text",WebkitTextFillColor:"transparent"},children:"404"}),e("h3",{className:"fw-semibold",children:"Page not found"}),e("p",{className:"text-muted mb-4",children:"The page you are looking for doesn't exist or has been moved."}),a("div",{className:"d-flex gap-2 justify-content-center",children:[a($,{to:"/",className:"btn btn-primary",children:[e("i",{className:"bi bi-house-door me-2"}),"Go Home"]}),a($,{to:"/reports",className:"btn btn-outline-secondary",children:[e("i",{className:"bi bi-file-text me-2"}),"View Reports"]})]})]})})})}function _s(){const{isAuthenticated:t,user:r}=ye();return t&&(r==null?void 0:r.role)==="admin"?e(pr,{}):e(ds,{})}function xs(){const[t,r]=p.useState(null),[s,i]=p.useState(!0),[n,c]=p.useState("");if(p.useEffect(()=>{(async()=>{var u,h;try{i(!0);const{data:C}=await M.dashboard.getPersonal();r(C)}catch(C){const w=((h=(u=C==null?void 0:C.response)==null?void 0:u.data)==null?void 0:h.error)||"Failed to load progress";c(w),F.error(w)}finally{i(!1)}})()},[]),s)return e("div",{className:"container py-4",children:e(se,{})});if(n)return e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:n})});const l=(t==null?void 0:t.courses)||[],o=(t==null?void 0:t.personalStats)||{};return a("div",{className:"container py-4",children:[a("h2",{className:"mb-3",children:[e("i",{className:"bi bi-graph-up-arrow me-2"}),"My Progress"]}),a(z,{className:"g-3 mb-3",children:[e(P,{md:3,children:e(x,{className:"h-100",children:a(x.Body,{children:[e("div",{className:"text-muted small",children:"My Reports"}),e("div",{className:"display-6",children:o.my_reports||0})]})})}),e(P,{md:3,children:e(x,{className:"h-100",children:a(x.Body,{children:[e("div",{className:"text-muted small",children:"Pending (Submitted)"}),e("div",{className:"display-6",children:o.pending_reports||0})]})})}),e(P,{md:3,children:e(x,{className:"h-100",children:a(x.Body,{children:[e("div",{className:"text-muted small",children:"Enrolled Courses"}),e("div",{className:"display-6",children:o.enrolled_courses||l.length||0})]})})}),e(P,{md:3,children:e(x,{className:"h-100",children:a(x.Body,{children:[e("div",{className:"text-muted small",children:"Avg Class Rating"}),e("div",{className:"display-6",children:o.avg_class_rating?Number(o.avg_class_rating).toFixed(1):"N/A"})]})})})]}),a(x,{children:[e(x.Header,{children:e("strong",{children:"Course Progress"})}),e(x.Body,{children:l.length===0?e("div",{className:"text-muted",children:"No courses found"}):e(z,{className:"g-3",children:l.map(d=>e(P,{md:6,children:e(x,{className:"h-100",children:a(x.Body,{children:[a("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[a("div",{children:[a("div",{className:"fw-bold",children:[d.course_name," ",d.course_code?`(${d.course_code})`:""]}),a("div",{className:"text-muted small",children:["Stream: ",d.stream_name||"N/A"]})]}),a("div",{className:"text-muted small",children:["Sem ",d.semester||"-"]})]}),e(xr,{now:Number(d.completion_percentage||0),label:`${Number(d.completion_percentage||0)}%`})]})})},d.id))})})]})]})}function Rs(){var f,g,S;const[t,r]=te.useState(1),[s,i]=te.useState(15),{data:n,isLoading:c,error:l,refetch:o}=be(["notifications-page",t,s],async()=>{const b=await M.dashboard.getNotifications({page:t,limit:s});return(b==null?void 0:b.data)??b},{refetchInterval:3e4}),d=(n==null?void 0:n.notifications)||[],u=(n==null?void 0:n.pagination)||{page:1,pages:1,total:0,limit:s},h=d.filter(b=>!b.read).length,C=async(b,v)=>{var y,N;try{await M.dashboard.markNotificationRead(b,v),o()}catch(k){F.error(((N=(y=k==null?void 0:k.response)==null?void 0:y.data)==null?void 0:N.error)||"Failed to mark as read")}};return a("div",{className:"container py-4",children:[a("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[a("h2",{className:"mb-0",children:[e("i",{className:"bi bi-bell me-2"}),"Notifications"]}),a("div",{className:"d-flex gap-2",children:[a("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>o(),disabled:c,children:[e("i",{className:"bi bi-arrow-clockwise me-1"})," Refresh"]}),a("button",{className:"btn btn-sm btn-outline-success",onClick:async()=>{var b,v;try{await M.dashboard.markAllNotificationsRead(),o()}catch(y){F.error(((v=(b=y==null?void 0:y.response)==null?void 0:b.data)==null?void 0:v.error)||"Failed to mark all as read")}},disabled:c||h===0&&(((f=n==null?void 0:n.pagination)==null?void 0:f.total)||0)===0,children:[e("i",{className:"bi bi-check2-all me-1"})," Mark all read"]}),a($,{to:"/",className:"btn btn-sm btn-outline-primary",children:[e("i",{className:"bi bi-speedometer2 me-1"})," Dashboard"]})]})]}),a("div",{className:"card",children:[a("div",{className:"card-body",children:[c&&e("div",{className:"text-muted",children:"Loading notifications..."}),l&&e("div",{className:"alert alert-danger",children:((S=(g=l==null?void 0:l.response)==null?void 0:g.data)==null?void 0:S.error)||"Failed to load notifications"}),!c&&!l&&d.length===0&&e("div",{className:"text-muted",children:"No notifications found."}),!c&&!l&&d.length>0&&e("div",{className:"list-group list-group-flush",children:d.map(b=>a("div",{className:`list-group-item d-flex align-items-start gap-3 ${b.read?"":"bg-light"}`,children:[e("div",{className:"text-primary",children:b.type==="feedback"?e("i",{className:"bi bi-chat-left-text"}):e("i",{className:"bi bi-file-earmark-text"})}),a("div",{className:"flex-grow-1",children:[e("div",{className:"fw-semibold",children:b.title||"Notification"}),e("div",{className:"text-muted small",children:b.message})]}),e("div",{className:"text-nowrap small text-muted",children:b.created_at?new Date(b.created_at).toLocaleString():""}),!b.read&&e("div",{children:e("button",{className:"btn btn-sm btn-outline-success",onClick:()=>C(b.type,b.id),title:"Mark as read",children:e("i",{className:"bi bi-check2"})})})]},`${b.type}-${b.id}`))})]}),u.pages>1&&a("div",{className:"card-footer d-flex align-items-center justify-content-between",children:[a("div",{className:"text-muted small",children:["Page ",u.page," of ",u.pages,"  ",u.total," total"]}),a("div",{className:"d-flex align-items-center gap-2",children:[e("button",{className:"btn btn-sm btn-outline-secondary",disabled:u.page<=1,onClick:()=>r(b=>Math.max(1,b-1)),children:"Prev"}),e("button",{className:"btn btn-sm btn-outline-secondary",disabled:u.page>=u.pages,onClick:()=>r(b=>Math.min(u.pages,b+1)),children:"Next"}),a("select",{className:"form-select form-select-sm ms-2",style:{width:120},value:s,onChange:b=>{i(parseInt(b.target.value)),r(1)},children:[e("option",{value:10,children:"10 per page"}),e("option",{value:15,children:"15 per page"}),e("option",{value:25,children:"25 per page"})]})]})]})]})]})}function As(){var C,w;const[t,r]=te.useState(1),[s,i]=te.useState(10),{data:n,isLoading:c,error:l,refetch:o}=be(["pending-actions",t,s],async()=>{const f=await M.dashboard.getPending({page:t,limit:s});return(f==null?void 0:f.data)??f},{keepPreviousData:!0,refetchOnWindowFocus:!1}),d=(n==null?void 0:n.items)||[],u=(n==null?void 0:n.pagination)||{page:1,pages:1,total:0,limit:s},h=async(f,g)=>{var S,b;try{await M.reports.moderate(f,g),F.success("Updated"),o()}catch(v){F.error(((b=(S=v==null?void 0:v.response)==null?void 0:S.data)==null?void 0:b.error)||"Failed to update")}};return a("div",{className:"container py-4",children:[a("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[a("h2",{className:"mb-0",children:[e("i",{className:"bi bi-inbox me-2"}),"Pending Actions"]}),a("div",{className:"d-flex gap-2",children:[a("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>o(),disabled:c,children:[e("i",{className:"bi bi-arrow-clockwise me-1"})," Refresh"]}),a($,{to:"/reports",className:"btn btn-sm btn-outline-primary",children:[e("i",{className:"bi bi-file-text me-1"})," Reports"]})]})]}),e(x,{children:a(x.Body,{className:"p-0",children:[c&&e("div",{className:"text-center py-5 text-muted",children:"Loading..."}),l&&e("div",{className:"alert alert-danger m-3",children:((w=(C=l==null?void 0:l.response)==null?void 0:C.data)==null?void 0:w.error)||"Failed to load pending actions"}),!c&&!l&&d.length===0&&e("div",{className:"text-center py-5 text-muted",children:"No pending items."}),!c&&!l&&d.length>0&&a(de,{children:[a(le,{responsive:!0,hover:!0,className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Title"}),e("th",{children:"Reporter"}),e("th",{children:"Course"}),e("th",{children:"Type"}),e("th",{children:"Created"}),e("th",{children:"Actions"})]})}),e("tbody",{children:d.map(f=>a("tr",{children:[e("td",{children:e("div",{className:"fw-semibold",children:f.title})}),a("td",{children:[f.first_name," ",f.last_name,e("div",{className:"text-muted small",children:String(f.reporter_role).replace("_"," ")})]}),e("td",{children:f.course_name||"N/A"}),e("td",{children:String(f.report_type).replace("_"," ")}),a("td",{children:[e("div",{children:new Date(f.created_at).toLocaleDateString()}),e("small",{className:"text-muted",children:new Date(f.created_at).toLocaleTimeString()})]}),e("td",{children:a("div",{className:"d-flex gap-1",children:[e($,{to:`/reports/${f.id}`,className:"btn btn-sm btn-outline-primary",title:"View",children:e("i",{className:"bi bi-eye"})}),e("button",{className:"btn btn-sm btn-outline-success",onClick:()=>h(f.id,{status:"approved"}),title:"Approve",children:e("i",{className:"bi bi-check2-circle"})}),e("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>h(f.id,{status:"reviewed"}),title:"Mark Reviewed",children:e("i",{className:"bi bi-eye"})}),e("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>h(f.id,{status:"rejected"}),title:"Reject",children:e("i",{className:"bi bi-x-circle"})})]})})]},f.id))})]}),a("div",{className:"p-3 border-top d-flex align-items-center justify-content-between",children:[a("div",{className:"text-muted small",children:["Page ",u.page," of ",u.pages,"  ",u.total," total"]}),a("div",{className:"d-flex align-items-center gap-2",children:[e("button",{className:"btn btn-sm btn-outline-secondary",disabled:u.page<=1,onClick:()=>r(f=>Math.max(1,f-1)),children:"Prev"}),e("button",{className:"btn btn-sm btn-outline-secondary",disabled:u.page>=u.pages,onClick:()=>r(f=>Math.min(u.pages,f+1)),children:"Next"}),a("select",{className:"form-select form-select-sm ms-2",style:{width:120},value:s,onChange:f=>{i(parseInt(f.target.value)),r(1)},children:[e("option",{value:10,children:"10 per page"}),e("option",{value:20,children:"20 per page"}),e("option",{value:50,children:"50 per page"})]})]})]})]})]})})]})}function Ls(){const[t,r]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState({}),[l,o]=p.useState([]),[d,u]=p.useState([]);return p.useEffect(()=>{(async()=>{var C,w;try{r(!0);const{data:f}=await M.dashboard.getPersonal();c((f==null?void 0:f.personalStats)||{}),o((f==null?void 0:f.courses)||[]),u((f==null?void 0:f.recentReports)||[])}catch(f){i(((w=(C=f==null?void 0:f.response)==null?void 0:C.data)==null?void 0:w.error)||"Failed to load monitoring data")}finally{r(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):a("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Student Monitoring"}),a(z,{children:[e(P,{md:4,children:a(x,{className:"mb-3",children:[e(x.Header,{children:e("strong",{children:"My Stats"})}),e(x.Body,{children:a("div",{className:"d-flex flex-column gap-2",children:[a("div",{children:[e("strong",{children:"My Reports:"})," ",n.my_reports??0]}),a("div",{children:[e("strong",{children:"Pending Reports:"})," ",n.pending_reports??0]}),a("div",{children:[e("strong",{children:"Enrolled Courses:"})," ",n.enrolled_courses??0]}),a("div",{children:[e("strong",{children:"Avg Class Rating:"})," ",Number(n.avg_class_rating||0).toFixed(1)]})]})})]})}),e(P,{md:8,children:a(x,{className:"mb-3",children:[e(x.Header,{children:e("strong",{children:"My Courses"})}),e(x.Body,{children:l.length===0?e("div",{className:"text-muted",children:"No enrolled courses found"}):a(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Completion"})]})}),e("tbody",{children:l.map(h=>a("tr",{children:[e("td",{children:h.course_name}),e("td",{children:h.course_code}),e("td",{children:h.stream_name}),e("td",{children:a(ue,{bg:"info",children:[h.completion_percentage??0,"%"]})})]},h.id))})]})})]})})]}),a(x,{children:[e(x.Header,{children:e("strong",{children:"My Recent Reports"})}),e(x.Body,{children:d.length===0?e("div",{className:"text-muted",children:"No recent reports"}):a(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Title"}),e("th",{children:"Status"}),e("th",{children:"Date"})]})}),e("tbody",{children:d.map(h=>a("tr",{children:[e("td",{children:h.title}),e("td",{children:h.status}),e("td",{children:new Date(h.created_at).toLocaleString()})]},h.id))})]})})]})]})}function ks(){const[t,r]=p.useState([]),[s,i]=p.useState([]),[n,c]=p.useState(!0),[l,o]=p.useState(!1),[d,u]=p.useState(""),[h,C]=p.useState({courseId:"",lecturerId:"",rating:"5",comments:"",classDate:new Date().toISOString().split("T")[0],academicYear:String(new Date().getFullYear()),semester:"1"});p.useEffect(()=>{(async()=>{var S,b,v;try{c(!0);const{data:y}=await M.dashboard.getPersonal();let N=(y==null?void 0:y.courses)||[];if(!Array.isArray(N)||N.length===0)try{const _=await M.users.getAvailableCourses();N=Array.isArray((S=_.data)==null?void 0:S.courses)?_.data.courses:Array.isArray(_.data)?_.data:[]}catch{}const k=(N||[]).map(_=>({id:_.id??_.course_id??_.courseId,course_name:_.course_name??_.name??_.title??"Untitled",course_code:_.course_code??_.code??""})).filter(_=>_.id!=null);r(k)}catch(y){u(((v=(b=y==null?void 0:y.response)==null?void 0:b.data)==null?void 0:v.error)||"Failed to load courses")}finally{c(!1)}})()},[]),p.useEffect(()=>{(async()=>{var S;try{if(!h.courseId){i([]);return}const{data:b}=await M.users.getLecturersByCourse(h.courseId);let v=Array.isArray(b==null?void 0:b.lecturers)?b.lecturers:[];if(v.length===0)try{const N=await M.users.getAll({role:"lecturer",limit:200});v=Array.isArray((S=N.data)==null?void 0:S.users)?N.data.users:Array.isArray(N.data)?N.data:[]}catch{}const y=v.map(N=>({id:N.id,first_name:N.first_name??N.firstName??"",last_name:N.last_name??N.lastName??""})).filter(N=>N.id!=null);i(y)}catch{i([])}})()},[h.courseId]);const w=g=>{const{name:S,value:b}=g.target;C(v=>({...v,[S]:b}))},f=async g=>{var b,v;if(g.preventDefault(),!h.courseId){F.error("Please select a course");return}if(!h.lecturerId){F.error("Please select a lecturer");return}const S=t.find(y=>String(y.id)===String(h.courseId));if(S!=null&&S.my_rating){F.error("You have already rated this course.");return}try{o(!0),await M.users.rateClass({courseId:Number(h.courseId),lecturerId:Number(h.lecturerId),rating:Number(h.rating),comment:h.comments,classDate:h.classDate,academicYear:h.academicYear,semester:Number(h.semester)}),F.success("Thank you for your rating"),C(y=>({...y,comments:""}))}catch(y){F.error(((v=(b=y==null?void 0:y.response)==null?void 0:b.data)==null?void 0:v.error)||"Failed to submit rating")}finally{o(!1)}};return n?e("div",{className:"container py-4",children:e(se,{})}):d?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:d})}):a("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Rate a Class"}),e(x,{children:e(x.Body,{children:a(m,{onSubmit:f,children:[a(z,{className:"mb-3",children:[e(P,{md:6,children:a(m.Group,{children:[e(m.Label,{children:"Course"}),a(m.Select,{name:"courseId",value:h.courseId,onChange:w,children:[e("option",{value:"",children:"Select course"}),t.map(g=>a("option",{value:g.id,children:[g.course_name," (",g.course_code,")"]},g.id))]})]})}),e(P,{md:6,children:a(m.Group,{children:[e(m.Label,{children:"Lecturer"}),a(m.Select,{name:"lecturerId",value:h.lecturerId,onChange:w,disabled:!h.courseId,children:[e("option",{value:"",children:h.courseId?"Select lecturer":"Select a course first"}),s.map(g=>a("option",{value:g.id,children:[g.first_name," ",g.last_name]},g.id))]})]})})]}),a(z,{className:"mb-3",children:[e(P,{md:4,children:a(m.Group,{children:[e(m.Label,{children:"Rating"}),e(m.Select,{name:"rating",value:h.rating,onChange:w,children:[5,4,3,2,1].map(g=>e("option",{value:g,children:g},g))})]})}),e(P,{md:4,children:a(m.Group,{children:[e(m.Label,{children:"Class Date"}),e(m.Control,{type:"date",name:"classDate",value:h.classDate,onChange:w})]})}),e(P,{md:2,children:a(m.Group,{children:[e(m.Label,{children:"Year"}),e(m.Control,{name:"academicYear",value:h.academicYear,onChange:w})]})}),e(P,{md:2,children:a(m.Group,{children:[e(m.Label,{children:"Semester"}),e(m.Select,{name:"semester",value:h.semester,onChange:w,children:[1,2,3,4,5,6,7,8].map(g=>e("option",{value:g,children:g},g))})]})})]}),a(m.Group,{className:"mb-3",children:[e(m.Label,{children:"Comments (optional)"}),e(m.Control,{as:"textarea",rows:3,name:"comments",value:h.comments,onChange:w})]}),e("div",{className:"d-flex justify-content-end",children:e(K,{type:"submit",variant:"success",disabled:l,children:l?"Submitting...":"Submit Rating"})})]})})}),a(x,{className:"mt-3",children:[e(x.Header,{children:e("strong",{children:"My Ratings"})}),e(x.Body,{children:t.filter(g=>g.my_rating).length===0?e("div",{className:"text-muted",children:"You have not rated any courses yet."}):e(z,{className:"g-2",children:t.filter(g=>g.my_rating).map(g=>e(P,{md:6,children:a("div",{className:"p-3 border rounded d-flex justify-content-between align-items-center",children:[a("div",{children:[a("div",{className:"fw-semibold",children:[g.course_name," ",g.course_code?`(${g.course_code})`:""]}),e("div",{className:"text-muted small",children:"Your rating:"})]}),e("div",{title:`${Number(g.my_rating).toFixed(1)} / 5`,children:[1,2,3,4,5].map(S=>e("i",{className:`bi ${S<=Math.round(g.my_rating)?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:16,marginLeft:2}},S))})]})},g.id))})})]})]})}function Ps({show:t,onHide:r,onSubmit:s,initial:i={},lecturers:n=[]}){const[c,l]=p.useState(i.rating||0),[o,d]=p.useState(i.comment||""),[u,h]=p.useState(i.academicYear||String(new Date().getFullYear())),[C,w]=p.useState(i.semester||1),[f,g]=p.useState(i.lecturerId||""),S=v=>{l(v)},b=v=>{v.preventDefault(),c&&(n.length>0&&!f||s({rating:c,comment:o,academicYear:u,semester:C,lecturerId:f?Number(f):void 0}))};return a(Te,{show:t,onHide:r,centered:!0,scrollable:!0,children:[e(Te.Header,{closeButton:!0,children:e(Te.Title,{children:"Rate this class"})}),a(m,{onSubmit:b,children:[a(Te.Body,{children:[n.length>0&&e("div",{className:"row g-3 mb-3",children:e("div",{className:"col-12",children:a(m.Group,{children:[e(m.Label,{children:"Lecturer"}),a(m.Select,{value:f,onChange:v=>g(v.target.value),children:[e("option",{value:"",children:"Select lecturer"}),n.map(v=>a("option",{value:v.id,children:[v.first_name," ",v.last_name]},v.id))]})]})})}),e("div",{className:"d-flex align-items-center mb-3",role:"group","aria-label":"Star rating",children:[1,2,3,4,5].map(v=>e("i",{className:`bi ${v<=c?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:28,cursor:"pointer",marginRight:6},onClick:()=>S(v),"aria-label":`${v} star`},v))}),a("div",{className:"row g-3 mb-3",children:[e("div",{className:"col-md-6",children:a(m.Group,{children:[e(m.Label,{children:"Academic Year"}),e(m.Control,{value:u,onChange:v=>h(v.target.value)})]})}),e("div",{className:"col-md-6",children:a(m.Group,{children:[e(m.Label,{children:"Semester"}),e(m.Select,{value:C,onChange:v=>w(Number(v.target.value)),children:[1,2,3,4,5,6,7,8].map(v=>e("option",{value:v,children:v},v))})]})})]}),a(m.Group,{children:[e(m.Label,{children:"Comments (optional)"}),e(m.Control,{as:"textarea",rows:3,value:o,onChange:v=>d(v.target.value),placeholder:"What went well? What could improve?"})]})]}),a(Te.Footer,{children:[e(K,{variant:"secondary",onClick:r,children:"Cancel"}),e(K,{variant:"primary",type:"submit",disabled:!c,children:"Submit Rating"})]})]})]})}function Fs(){const[t,r]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]),[l,o]=p.useState(null),[d,u]=p.useState([]),h=async()=>{var w,f,g;try{r(!0),i("");const{data:S}=await M.dashboard.getPersonal();let b=(S==null?void 0:S.courses)||[];if(!Array.isArray(b)||b.length===0)try{const y=await M.users.getAvailableCourses();b=Array.isArray((w=y.data)==null?void 0:w.courses)?y.data.courses:Array.isArray(y.data)?y.data:[]}catch{}const v=(b||[]).map(y=>({id:y.id??y.course_id??y.courseId,course_name:y.course_name??y.name??y.title??"Untitled",course_code:y.course_code??y.code??"",stream_name:y.stream_name??y.stream??"",student_count:y.student_count??y.students??void 0,my_rating:y.my_rating??y.rating??void 0})).filter(y=>y.id!=null);c(v)}catch(S){i(((g=(f=S==null?void 0:S.response)==null?void 0:f.data)==null?void 0:g.error)||"Failed to load classes")}finally{r(!1)}};p.useEffect(()=>{h()},[]);const C=async({rating:w,comment:f,academicYear:g,semester:S,lecturerId:b})=>{var v,y;if(l){if(!b){F.error("Please select a lecturer");return}try{await M.users.rateClass({courseId:l.id,rating:Number(w),comments:f||void 0,academicYear:g||String(new Date().getFullYear()),semester:Number(S||1),lecturerId:Number(b),classDate:new Date().toISOString().split("T")[0]}),F.success("Thank you for your rating"),o(null),h()}catch(N){F.error(((y=(v=N==null?void 0:N.response)==null?void 0:v.data)==null?void 0:y.error)||"Failed to submit rating")}}};return p.useEffect(()=>{(async()=>{if(!(l!=null&&l.id)){u([]);return}try{const{data:f}=await M.users.getLecturersByCourse(l.id),g=Array.isArray(f==null?void 0:f.lecturers)?f.lecturers:[],S=new Set,b=g.filter(v=>{const y=v.id;return S.has(y)?!1:(S.add(y),!0)});u(b)}catch{u([])}})()},[l]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):a("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"My Classes"}),e(x,{children:e(x.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No classes to show."}):a(le,{responsive:!0,hover:!0,children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Lecturer"}),e("th",{children:"Your Rating"}),e("th",{children:"Actions"})]})}),e("tbody",{children:n.map(w=>a("tr",{children:[e("td",{children:w.course_name}),e("td",{children:w.course_code}),e("td",{children:w.lecturer_name||w.lecturer||""}),e("td",{children:w.my_rating?e("span",{title:`${Number(w.my_rating).toFixed(1)} / 5`,children:[1,2,3,4,5].map(f=>e("i",{className:`bi ${f<=Math.round(w.my_rating)?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:14,marginRight:2}},f))}):e("span",{className:"text-muted",children:"Not rated"})}),e("td",{children:e(K,{size:"sm",variant:"outline-primary",onClick:()=>o(w),disabled:!!w.my_rating,children:w.my_rating?"Rated":"Rate"})})]},w.id))})]})})}),e(Ps,{show:!!l,onHide:()=>o(null),onSubmit:C,initial:{rating:(l==null?void 0:l.my_rating)||0,comment:""},lecturers:d})]})}function Is(){const t=at(),r=p.useRef(null),[s,i]=p.useState([]),[n,c]=p.useState([]),[l,o]=p.useState([]),[d,u]=p.useState(""),[h,C]=p.useState(""),[w,f]=p.useState(""),[g,S]=p.useState(!0),[b,v]=p.useState(""),[y,N]=p.useState({lecturerId:"",courseId:"",academicYear:new Date().getFullYear().toString(),semester:1}),k=async()=>{var E,L,D,I,j;try{S(!0),v("");const[W,R,G]=await Promise.all([M.users.getAll({limit:100}),M.users.getAvailableCourses({all:!0}),M.users.getStreams()]),X=(Array.isArray(W.data)?W.data:((E=W.data)==null?void 0:E.users)||[]).filter(me=>(me.role||me.role_name)==="lecturer"||me.role==="lecturer");i(X);const ne=Array.isArray((L=R.data)==null?void 0:L.courses)?R.data.courses:Array.isArray(R.data)?R.data:[];c(ne);const ae=Array.isArray((D=G.data)==null?void 0:D.streams)?G.data.streams:Array.isArray(G.data)?G.data:[];o(ae)}catch(W){const R=((j=(I=W==null?void 0:W.response)==null?void 0:I.data)==null?void 0:j.error)||"Failed to load data";v(R),F.error(R)}finally{S(!1)}};p.useEffect(()=>{k()},[]),p.useEffect(()=>{(async()=>{var L;try{S(!0);const D=d?{stream_id:d,all:!0}:{all:!0},I=await M.users.getAvailableCourses(D),j=Array.isArray((L=I.data)==null?void 0:L.courses)?I.data.courses:Array.isArray(I.data)?I.data:[];c(j)}catch{}finally{S(!1)}})()},[d]);const _=p.useMemo(()=>{const E=h.trim().toLowerCase();return E?s.filter(L=>[L.firstName,L.first_name,L.lastName,L.last_name,L.email].filter(Boolean).some(D=>String(D).toLowerCase().includes(E))):s},[s,h]),T=p.useMemo(()=>{const E=w.trim().toLowerCase();return E?n.filter(L=>[L.course_name,L.course_code,L.name,L.title].filter(Boolean).some(D=>String(D).toLowerCase().includes(E))):n},[n,w]);p.useEffect(()=>{const E=new URLSearchParams(t.search),L=E.get("courseId");E.get("mode"),L&&(N(D=>({...D,courseId:String(L)})),setTimeout(()=>{var D;return(D=r.current)==null?void 0:D.scrollIntoView({behavior:"smooth",block:"start"})},0))},[t.search]);const B=async E=>{var L,D;if(E.preventDefault(),!y.lecturerId||!y.courseId){F.error("Please select a lecturer and a course");return}try{await M.users.assignCourse(y.lecturerId,{courseId:Number(y.courseId),academicYear:y.academicYear,semester:Number(y.semester)}),F.success("Course assigned to lecturer"),N({...y,courseId:""})}catch(I){const j=((D=(L=I==null?void 0:I.response)==null?void 0:L.data)==null?void 0:D.error)||"Failed to assign course";F.error(j)}};return g?e("div",{className:"container py-4",children:e(se,{})}):b?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:b})}):a("div",{className:"container py-4",children:[a("h2",{className:"mb-3",children:[e("i",{className:"bi bi-person-workspace me-2"}),"Assign Modules"]}),new URLSearchParams(t.search).get("mode")==="add"&&a(x,{className:"mb-3",children:[e(x.Header,{children:e("strong",{children:"Add Module (Course)"})}),e(x.Body,{children:e(AddCourseForm,{streams:l,onCreated:E=>{c(L=>[E,...L]),N(L=>({...L,courseId:String(E.id)})),F.success("Module created and selected"),setTimeout(()=>{var L;return(L=r.current)==null?void 0:L.scrollIntoView({behavior:"smooth",block:"start"})},0)}})})]}),a(x,{children:[e(x.Header,{children:e("strong",{children:"Assign Course to Lecturer"})}),e(x.Body,{ref:r,children:a(m,{onSubmit:B,children:[a(z,{className:"g-3",children:[e(P,{md:6,children:a(m.Group,{children:[e(m.Label,{children:"Stream (optional)"}),a(m.Select,{value:d,onChange:E=>u(E.target.value),children:[e("option",{value:"",children:"All streams"}),l.map(E=>a("option",{value:E.id,children:[E.stream_name," ",E.stream_code?`(${E.stream_code})`:""]},E.id))]})]})}),e(P,{md:6,children:a(m.Group,{children:[e(m.Label,{children:"Lecturer"}),e(m.Control,{placeholder:"Search lecturer...",className:"mb-2",value:h,onChange:E=>C(E.target.value)}),a(m.Select,{value:y.lecturerId,onChange:E=>N({...y,lecturerId:E.target.value}),children:[e("option",{value:"",children:"Select lecturer"}),_.map(E=>a("option",{value:E.id,children:[E.firstName||E.first_name||""," ",E.lastName||E.last_name||"","  ",E.email]},E.id))]})]})}),e(P,{md:6,children:a(m.Group,{children:[e(m.Label,{children:"Course"}),e(m.Control,{placeholder:"Search course...",className:"mb-2",value:w,onChange:E=>f(E.target.value)}),a(m.Select,{value:y.courseId,onChange:E=>N({...y,courseId:E.target.value}),children:[e("option",{value:"",children:"Select course"}),T.map(E=>a("option",{value:E.id,children:[E.course_name," ",E.course_code?`(${E.course_code})`:""]},E.id))]})]})})]}),a(z,{className:"g-3 mt-1",children:[e(P,{md:6,children:a(m.Group,{children:[e(m.Label,{children:"Academic Year"}),e(m.Control,{value:y.academicYear,onChange:E=>N({...y,academicYear:E.target.value})})]})}),e(P,{md:6,children:a(m.Group,{children:[e(m.Label,{children:"Semester"}),e(m.Select,{value:y.semester,onChange:E=>N({...y,semester:E.target.value}),children:[1,2,3,4,5,6,7,8].map(E=>e("option",{value:E,children:E},E))})]})})]}),e("div",{className:"mt-3 d-flex justify-content-end",children:e(K,{type:"submit",variant:"primary",children:"Assign"})})]})})]})]})}function Es(){const[t,r]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]);return p.useEffect(()=>{(async()=>{var o,d;try{r(!0);const{data:u}=await M.dashboard.getPersonal();c((u==null?void 0:u.courses)||[])}catch(u){i(((d=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:d.error)||"Failed to load classes")}finally{r(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):a("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"My Classes"}),e(x,{children:e(x.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No assigned courses."}):a(le,{responsive:!0,hover:!0,className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"}),e("th",{children:"Avg Rating"}),e("th",{children:"Actions"})]})}),e("tbody",{children:n.map(l=>a("tr",{children:[e("td",{children:l.course_name}),e("td",{children:l.course_code}),e("td",{children:l.stream_name}),e("td",{children:e(ue,{bg:"secondary",children:l.student_count??0})}),e("td",{children:l.avg_rating?e("span",{title:`${Number(l.avg_rating).toFixed(1)} / 5`,children:[1,2,3,4,5].map(o=>e("i",{className:`bi ${o<=Math.round(l.avg_rating)?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:14,marginRight:2}},o))}):e("span",{className:"text-muted",children:"N/A"})}),e("td",{children:a($,{to:"/reports/lecturer/new",className:"btn btn-sm btn-outline-primary",children:[e("i",{className:"bi bi-journal-plus me-1"}),"New Report"]})})]},l.id))})]})})})]})}function Os(){const[t,r]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState({}),[l,o]=p.useState([]),[d,u]=p.useState([]);return p.useEffect(()=>{(async()=>{var C,w;try{r(!0);const{data:f}=await M.dashboard.getPersonal();c((f==null?void 0:f.personalStats)||{}),o((f==null?void 0:f.courses)||[]),u((f==null?void 0:f.pendingActions)||[])}catch(f){i(((w=(C=f==null?void 0:f.response)==null?void 0:C.data)==null?void 0:w.error)||"Failed to load monitoring data")}finally{r(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):a("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Lecturer Monitoring"}),a(z,{children:[e(P,{md:4,children:a(x,{className:"mb-3",children:[e(x.Header,{children:e("strong",{children:"My Stats"})}),e(x.Body,{children:a("div",{className:"d-flex flex-column gap-2",children:[a("div",{children:[e("strong",{children:"My Courses:"})," ",n.my_courses??0]}),a("div",{children:[e("strong",{children:"My Reports:"})," ",n.my_reports??0]}),a("div",{children:[e("strong",{children:"Total Students:"})," ",n.total_students??0]}),a("div",{children:[e("strong",{children:"Avg Received Rating:"})," ",Number(n.avg_received_rating||0).toFixed(1)]})]})})]})}),e(P,{md:8,children:a(x,{className:"mb-3",children:[e(x.Header,{children:e("strong",{children:"Pending Student Reports"})}),e(x.Body,{children:d.length===0?e("div",{className:"text-muted",children:"No pending student reports"}):a(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Title"}),e("th",{children:"Student"}),e("th",{children:"Course"}),e("th",{children:"Date"})]})}),e("tbody",{children:d.map(h=>a("tr",{children:[e("td",{children:h.title}),a("td",{children:[h.first_name," ",h.last_name]}),e("td",{children:h.course_name}),e("td",{children:new Date(h.created_at).toLocaleDateString()})]},h.id))})]})})]})})]}),a(x,{children:[e(x.Header,{children:e("strong",{children:"My Courses"})}),e(x.Body,{children:l.length===0?e("div",{className:"text-muted",children:"No courses assigned"}):a(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"}),e("th",{children:"Avg Rating"})]})}),e("tbody",{children:l.map(h=>a("tr",{children:[e("td",{children:h.course_name}),e("td",{children:h.course_code}),e("td",{children:h.stream_name}),e("td",{children:e(ue,{bg:"secondary",children:h.student_count??0})}),e("td",{children:h.avg_rating?Number(h.avg_rating).toFixed(1):"N/A"})]},h.id))})]})})]})]})}function Ts(){const[t,r]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState({}),[l,o]=p.useState([]);return p.useEffect(()=>{(async()=>{var u,h;try{r(!0);const{data:C}=await M.dashboard.getPersonal();c((C==null?void 0:C.personalStats)||{}),o((C==null?void 0:C.courses)||[])}catch(C){i(((h=(u=C==null?void 0:C.response)==null?void 0:u.data)==null?void 0:h.error)||"Failed to load rating data")}finally{r(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):a("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"My Ratings"}),a(z,{className:"mb-3",children:[e(P,{md:4,children:a(x,{children:[e(x.Header,{children:e("strong",{children:"Overview"})}),a(x.Body,{children:[a("div",{children:[e("strong",{children:"Avg Received Rating:"})," ",Number(n.avg_received_rating||0).toFixed(1)," / 5"]}),a("div",{children:[e("strong",{children:"Courses:"})," ",l.length]})]})]})}),e(P,{md:8,children:a(x,{children:[e(x.Header,{children:e("strong",{children:"By Course"})}),e(x.Body,{children:l.length===0?e("div",{className:"text-muted",children:"No courses assigned"}):a(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Avg Rating"})]})}),e("tbody",{children:l.map(d=>a("tr",{children:[e("td",{children:d.course_name}),e("td",{children:d.course_code}),e("td",{children:d.avg_rating?e("span",{title:`${Number(d.avg_rating).toFixed(1)} / 5`,children:[1,2,3,4,5].map(u=>e("i",{className:`bi ${u<=Math.round(d.avg_rating)?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:14,marginRight:2}},u))}):e("span",{className:"text-muted",children:"N/A"})})]},d.id))})]})})]})})]})]})}function Ds(){const[t,r]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]);return p.useEffect(()=>{(async()=>{var o,d;try{r(!0);const{data:u}=await M.dashboard.getPersonal();c((u==null?void 0:u.courses)||[])}catch(u){i(((d=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:d.error)||"Failed to load courses")}finally{r(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):a("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Stream Courses & Lectures"}),e(x,{children:e(x.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No courses found under your streams"}):a(le,{responsive:!0,hover:!0,className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"}),e("th",{children:"Avg Rating"})]})}),e("tbody",{children:n.map(l=>a("tr",{children:[e("td",{children:l.course_name}),e("td",{children:l.course_code}),e("td",{children:l.stream_name}),e("td",{children:l.student_count??0}),e("td",{children:l.avg_rating?Number(l.avg_rating).toFixed(1):"N/A"})]},l.id))})]})})})]})}function Ms(){const[t,r]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState({}),[l,o]=p.useState([]),[d,u]=p.useState([]);return p.useEffect(()=>{(async()=>{var C,w;try{r(!0);const{data:f}=await M.dashboard.getPersonal();c((f==null?void 0:f.personalStats)||{}),o((f==null?void 0:f.courses)||[]),u((f==null?void 0:f.pendingActions)||[])}catch(f){i(((w=(C=f==null?void 0:f.response)==null?void 0:C.data)==null?void 0:w.error)||"Failed to load monitoring")}finally{r(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):a("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"PRL Monitoring"}),a(z,{children:[e(P,{md:4,children:a(x,{className:"mb-3",children:[e(x.Header,{children:e("strong",{children:"Overview"})}),e(x.Body,{children:a("div",{className:"d-flex flex-column gap-2",children:[a("div",{children:[e("strong",{children:"Streams:"})," ",n.supervised_streams??n.managed_streams??0]}),a("div",{children:[e("strong",{children:"Reports to Review:"})," ",n.reports_to_review??0]}),a("div",{children:[e("strong",{children:"Staff:"})," ",n.supervised_staff??0]})]})})]})}),e(P,{md:8,children:a(x,{className:"mb-3",children:[e(x.Header,{children:e("strong",{children:"Pending Actions"})}),e(x.Body,{children:d.length===0?e("div",{className:"text-muted",children:"No pending actions"}):a(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Title"}),e("th",{children:"From"}),e("th",{children:"Course"}),e("th",{children:"Date"})]})}),e("tbody",{children:d.map(h=>a("tr",{children:[e("td",{children:h.title}),a("td",{children:[h.first_name," ",h.last_name]}),e("td",{children:h.course_name}),e("td",{children:new Date(h.created_at).toLocaleDateString()})]},h.id))})]})})]})})]}),a(x,{children:[e(x.Header,{children:e("strong",{children:"Courses Under Your Streams"})}),e(x.Body,{children:l.length===0?e("div",{className:"text-muted",children:"No courses"}):a(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"})]})}),e("tbody",{children:l.map(h=>a("tr",{children:[e("td",{children:h.course_name}),e("td",{children:h.course_code}),e("td",{children:h.stream_name}),e("td",{children:e(ue,{bg:"secondary",children:h.student_count??0})})]},h.id))})]})})]})]})}function $s(){const[t,r]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]);return p.useEffect(()=>{(async()=>{var o,d;try{r(!0);const{data:u}=await M.dashboard.getPersonal();c((u==null?void 0:u.courses)||[])}catch(u){i(((d=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:d.error)||"Failed to load rating")}finally{r(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):a("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"PRL Rating Overview"}),e(x,{children:e(x.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No courses assigned under your streams"}):a(le,{responsive:!0,hover:!0,className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Avg Rating"})]})}),e("tbody",{children:n.map(l=>a("tr",{children:[e("td",{children:l.course_name}),e("td",{children:l.course_code}),e("td",{children:l.avg_rating?e("span",{title:`${Number(l.avg_rating).toFixed(1)} / 5`,children:[1,2,3,4,5].map(o=>e("i",{className:`bi ${o<=Math.round(l.avg_rating)?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:14,marginRight:2}},o))}):e("span",{className:"text-muted",children:"N/A"})})]},l.id))})]})})})]})}function Us(){const[t,r]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]);return p.useEffect(()=>{(async()=>{var o,d;try{r(!0);const{data:u}=await M.dashboard.getPersonal();c((u==null?void 0:u.courses)||[])}catch(u){i(((d=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:d.error)||"Failed to load classes")}finally{r(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):a("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"PRL Classes"}),e(x,{children:e(x.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No classes (courses) under your streams."}):a(le,{responsive:!0,hover:!0,className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"}),e("th",{children:"Avg Rating"}),e("th",{children:"Actions"})]})}),e("tbody",{children:n.map(l=>a("tr",{children:[e("td",{children:l.course_name}),e("td",{children:l.course_code}),e("td",{children:l.stream_name}),e("td",{children:l.student_count??0}),e("td",{children:l.avg_rating?Number(l.avg_rating).toFixed(1):"N/A"}),e("td",{className:"d-flex gap-2",children:e(K,{as:$,size:"sm",variant:"outline-primary",to:`/reports?courseId=${l.id}`,children:"View Reports"})})]},l.id))})]})})})]})}function qs(){const[t,r]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]);return p.useEffect(()=>{(async()=>{var o,d;try{r(!0);const{data:u}=await M.dashboard.getPersonal();c((u==null?void 0:u.courses)||[])}catch(u){i(((d=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:d.error)||"Failed to load courses")}finally{r(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):a("div",{className:"container py-4",children:[a("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e("h2",{className:"mb-0",children:"PL Courses"}),e("div",{className:"d-flex gap-2",children:e(K,{as:$,to:"/admin/assign-modules",variant:"outline-primary",size:"sm",children:"Assign Lecturer Modules"})})]}),e(x,{children:e(x.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No courses available."}):a(le,{responsive:!0,hover:!0,children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"}),e("th",{children:"Avg Rating"}),e("th",{children:"Actions"})]})}),e("tbody",{children:n.map(l=>a("tr",{children:[e("td",{children:l.course_name}),e("td",{children:l.course_code}),e("td",{children:l.stream_name}),e("td",{children:l.student_count??0}),e("td",{children:l.avg_rating?Number(l.avg_rating).toFixed(1):"N/A"}),a("td",{className:"d-flex gap-2",children:[e(K,{as:$,to:`/admin/assign-modules?courseId=${l.id}`,size:"sm",variant:"outline-primary",children:"Assign"}),e(K,{as:$,to:`/admin/assign-modules?mode=add&courseId=${l.id}`,size:"sm",variant:"outline-success",children:"Add Module"})]})]},l.id))})]})})})]})}function js(){const[t,r]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState({}),[l,o]=p.useState([]),[d,u]=p.useState([]);return p.useEffect(()=>{(async()=>{var C,w;try{r(!0);const{data:f}=await M.dashboard.getPersonal();c((f==null?void 0:f.personalStats)||{}),o((f==null?void 0:f.courses)||[]),u((f==null?void 0:f.pendingActions)||[])}catch(f){i(((w=(C=f==null?void 0:f.response)==null?void 0:C.data)==null?void 0:w.error)||"Failed to load monitoring")}finally{r(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):a("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Program Leader Monitoring"}),a(z,{className:"mb-3",children:[e(P,{md:4,children:a(x,{children:[e(x.Header,{children:e("strong",{children:"Overview"})}),e(x.Body,{children:a("div",{className:"d-flex flex-column gap-2",children:[a("div",{children:[e("strong",{children:"Managed Streams:"})," ",n.managed_streams??n.supervised_streams??0]}),a("div",{children:[e("strong",{children:"Reports to Review:"})," ",n.reports_to_review??n.pending_reports??0]}),a("div",{children:[e("strong",{children:"Lecturers:"})," ",n.managed_lecturers??n.supervised_staff??0]})]})})]})}),e(P,{md:8,children:a(x,{children:[e(x.Header,{children:e("strong",{children:"Pending Actions"})}),e(x.Body,{children:d.length===0?e("div",{className:"text-muted",children:"No pending actions"}):a(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Title"}),e("th",{children:"From"}),e("th",{children:"Course"}),e("th",{children:"Date"})]})}),e("tbody",{children:d.map(h=>a("tr",{children:[e("td",{children:h.title}),a("td",{children:[h.first_name," ",h.last_name]}),e("td",{children:h.course_name}),e("td",{children:new Date(h.created_at).toLocaleDateString()})]},h.id))})]})})]})})]}),a(x,{children:[e(x.Header,{children:e("strong",{children:"Courses"})}),e(x.Body,{children:l.length===0?e("div",{className:"text-muted",children:"No courses"}):a(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"})]})}),e("tbody",{children:l.map(h=>a("tr",{children:[e("td",{children:h.course_name}),e("td",{children:h.course_code}),e("td",{children:h.stream_name}),e("td",{children:e(ue,{bg:"secondary",children:h.student_count??0})})]},h.id))})]})})]})]})}function Qs(){const[t,r]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]);return p.useEffect(()=>{(async()=>{var o,d;try{r(!0);const{data:u}=await M.dashboard.getPersonal();c((u==null?void 0:u.courses)||[])}catch(u){i(((d=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:d.error)||"Failed to load classes")}finally{r(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):a("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"PL Classes"}),e(x,{children:e(x.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No classes available"}):a(le,{responsive:!0,hover:!0,children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"}),e("th",{children:"Actions"})]})}),e("tbody",{children:n.map(l=>a("tr",{children:[e("td",{children:l.course_name}),e("td",{children:l.course_code}),e("td",{children:l.stream_name}),e("td",{children:l.student_count??0}),a("td",{className:"d-flex gap-2",children:[e(K,{as:$,to:`/admin/assign-modules?courseId=${l.id}`,size:"sm",variant:"outline-primary",children:"Assign Class"}),e(K,{as:$,to:`/reports?courseId=${l.id}`,size:"sm",variant:"outline-secondary",children:"View Reports"})]})]},l.id))})]})})})]})}function Bs(){const[t,r]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]),[l,o]=p.useState([]),[d,u]=p.useState({}),[h,C]=p.useState([]),[w,f]=p.useState(""),[g,S]=p.useState("");return p.useEffect(()=>{(async()=>{var v,y,N;try{r(!0);const[{data:k},{data:_}]=await Promise.all([M.users.getAll({role:"lecturer",limit:200}),M.users.getAvailableCourses()]),T=Array.isArray(k==null?void 0:k.users)?k.users:Array.isArray(k)?k:[],B=Array.isArray(_==null?void 0:_.courses)?_.courses:Array.isArray(_)?_:[];c(T),o(B);const E=Array.from(new Map(B.map(I=>[String(I.stream_id||I.streamId||I.stream_name||""),{id:I.stream_id||I.streamId||String(I.stream_name||""),name:I.stream_name||String(I.stream_id||I.streamId||"Unknown")}])).values());C(E);const L={};for(const I of T)L[I.id]=[];let D=!1;for(const I of B){const j=I.lecturer_ids||I.assigned_lecturer_ids||((v=I.lecturers)==null?void 0:v.map(W=>W.id))||[];if(j&&j.length){D=!0;for(const W of j)L[W]&&L[W].push(I)}}if(!D)for(const I of B)try{const{data:j}=await M.users.getLecturersByCourse(I.id),W=(j==null?void 0:j.lecturers)||[];for(const R of W)L[R.id]&&L[R.id].push(I)}catch{}u(L)}catch(k){i(((N=(y=k==null?void 0:k.response)==null?void 0:y.data)==null?void 0:N.error)||"Failed to load lecturers")}finally{r(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):a("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Lecturers & Assigned Classes"}),e(x,{className:"mb-3",children:e(x.Body,{children:a("div",{className:"row g-3 align-items-end",children:[e("div",{className:"col-md-4",children:a(m.Group,{children:[e(m.Label,{children:"Filter by Stream"}),a(m.Select,{value:w,onChange:b=>f(b.target.value),children:[e("option",{value:"",children:"All Streams"}),h.map(b=>e("option",{value:b.name,children:b.name},b.id))]})]})}),e("div",{className:"col-md-4",children:a(m.Group,{children:[e(m.Label,{children:"Search Course"}),e(m.Control,{placeholder:"Course name or code",value:g,onChange:b=>S(b.target.value)})]})})]})})}),n.length===0?e(x,{children:e(x.Body,{children:e("div",{className:"text-muted",children:"No lecturers available"})})}):n.map(b=>a(x,{className:"mb-3",children:[a(x.Header,{className:"d-flex justify-content-between align-items-center",children:[a("div",{children:[a("strong",{children:[b.first_name," ",b.last_name]}),e("div",{className:"text-muted small",children:b.email})]}),a(ue,{bg:"secondary",children:[(d[b.id]||[]).length," classes"]})]}),e(x.Body,{children:(d[b.id]||[]).length===0?e("div",{className:"text-muted",children:"No classes assigned"}):(()=>{const v=(d[b.id]||[]).filter(y=>{const N=!w||(y.stream_name||"").toLowerCase()===w.toLowerCase(),k=g.trim().toLowerCase(),_=!k||(y.course_name||"").toLowerCase().includes(k)||(y.course_code||"").toLowerCase().includes(k);return N&&_});return v.length===0?e("div",{className:"text-muted",children:"No classes match current filters"}):a(le,{responsive:!0,hover:!0,size:"sm",className:"mb-0",children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Stream"}),e("th",{children:"Students"}),e("th",{children:"Year"}),e("th",{children:"Semester"}),e("th",{children:"Actions"})]})}),e("tbody",{children:v.map(y=>a("tr",{children:[e("td",{children:y.course_name}),e("td",{children:y.course_code}),e("td",{children:y.stream_name}),e("td",{children:y.student_count??0}),e("td",{children:y.academic_year||y.year||"-"}),e("td",{children:y.semester||"-"}),a("td",{children:[e(K,{as:$,to:`/admin/assign-modules?courseId=${y.id}`,size:"sm",variant:"outline-primary",children:"Reassign"}),e(K,{as:$,to:`/reports?courseId=${y.id}`,size:"sm",variant:"outline-secondary",className:"ms-2",children:"View Reports"})]})]},y.id))})]})})()})]},b.id))]})}function Gs(){const[t,r]=p.useState(!0),[s,i]=p.useState(""),[n,c]=p.useState([]);return p.useEffect(()=>{(async()=>{var o,d;try{r(!0);const{data:u}=await M.dashboard.getPersonal();c((u==null?void 0:u.courses)||[])}catch(u){i(((d=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:d.error)||"Failed to load rating overview")}finally{r(!1)}})()},[]),t?e("div",{className:"container py-4",children:e(se,{})}):s?e("div",{className:"container py-4",children:e(Z,{variant:"danger",children:s})}):a("div",{className:"container py-4",children:[e("h2",{className:"mb-3",children:"Program Leader Rating"}),e(x,{children:e(x.Body,{children:n.length===0?e("div",{className:"text-muted",children:"No courses to display"}):a(le,{responsive:!0,hover:!0,children:[e("thead",{className:"table-light",children:a("tr",{children:[e("th",{children:"Course"}),e("th",{children:"Code"}),e("th",{children:"Avg Rating"})]})}),e("tbody",{children:n.map(l=>a("tr",{children:[e("td",{children:l.course_name}),e("td",{children:l.course_code}),e("td",{children:l.avg_rating?e("span",{title:`${Number(l.avg_rating).toFixed(1)} / 5`,children:[1,2,3,4,5].map(o=>e("i",{className:`bi ${o<=Math.round(l.avg_rating)?"bi-star-fill text-warning":"bi-star text-warning"}`,style:{fontSize:14,marginRight:2}},o))}):e("span",{className:"text-muted",children:"N/A"})})]},l.id))})]})})})]})}const Hs=new Wr({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1,staleTime:5*60*1e3}}});function zs(){return a(Xr,{client:Hs,children:[e(Rr,{children:a("div",{className:"App",children:[e(Ka,{}),e(Xa,{}),e("main",{className:"main-content",children:a(Ar,{children:[e(Y,{path:"/",element:e(_s,{})}),e(Y,{path:"/login",element:e(us,{})}),e(Y,{path:"/register",element:e(hs,{})}),e(Y,{path:"/reports",element:e(ee,{children:e(ms,{})})}),e(Y,{path:"/reports/create",element:e(ee,{roles:["student","admin","program_leader","principal_lecturer","faculty_manager"],children:e(ps,{})})}),e(Y,{path:"/reports/lecturer/new",element:e(ee,{roles:["lecturer","admin","program_leader","principal_lecturer","faculty_manager"],children:e(bs,{})})}),e(Y,{path:"/reports/:id",element:e(ee,{children:e(fs,{})})}),e(Y,{path:"/profile",element:e(ee,{children:e(ys,{})})}),e(Y,{path:"/analytics",element:e(ee,{roles:["admin","program_leader","principal_lecturer","faculty_manager"],children:e(Ss,{})})}),e(Y,{path:"/admin",element:e(ee,{roles:["admin"],children:e(pr,{})})}),e(Y,{path:"/admin/audit",element:e(ee,{roles:["admin"],children:e(Cs,{})})}),e(Y,{path:"/users",element:e(ee,{roles:["admin","program_leader","principal_lecturer","faculty_manager"],children:e(Ns,{})})}),e(Y,{path:"/admin/assign-modules",element:e(ee,{roles:["admin","program_leader","principal_lecturer","faculty_manager"],children:e(Is,{})})}),e(Y,{path:"/my-progress",element:e(ee,{roles:["student"],children:e(xs,{})})}),e(Y,{path:"/my-classes",element:e(ee,{roles:["student"],children:e(Fs,{})})}),e(Y,{path:"/monitoring",element:e(ee,{roles:["student"],children:e(Ls,{})})}),e(Y,{path:"/rating",element:e(ee,{roles:["student"],children:e(ks,{})})}),e(Y,{path:"/notifications",element:e(ee,{children:e(Rs,{})})}),e(Y,{path:"/pending",element:e(ee,{children:e(As,{})})}),e(Y,{path:"/lecturer/classes",element:e(ee,{roles:["lecturer","admin","program_leader","principal_lecturer","faculty_manager"],children:e(Es,{})})}),e(Y,{path:"/lecturer/monitoring",element:e(ee,{roles:["lecturer","admin","program_leader","principal_lecturer","faculty_manager"],children:e(Os,{})})}),e(Y,{path:"/lecturer/rating",element:e(ee,{roles:["lecturer","admin","program_leader","principal_lecturer","faculty_manager"],children:e(Ts,{})})}),e(Y,{path:"/prl/courses",element:e(ee,{roles:["principal_lecturer"],children:e(Ds,{})})}),e(Y,{path:"/prl/monitoring",element:e(ee,{roles:["principal_lecturer"],children:e(Ms,{})})}),e(Y,{path:"/prl/rating",element:e(ee,{roles:["principal_lecturer"],children:e($s,{})})}),e(Y,{path:"/prl/classes",element:e(ee,{roles:["principal_lecturer"],children:e(Us,{})})}),e(Y,{path:"/pl/courses",element:e(ee,{roles:["program_leader"],children:e(qs,{})})}),e(Y,{path:"/pl/monitoring",element:e(ee,{roles:["program_leader"],children:e(js,{})})}),e(Y,{path:"/pl/classes",element:e(ee,{roles:["program_leader"],children:e(Qs,{})})}),e(Y,{path:"/pl/lectures",element:e(ee,{roles:["program_leader"],children:e(Bs,{})})}),e(Y,{path:"/pl/rating",element:e(ee,{roles:["program_leader"],children:e(Gs,{})})}),e(Y,{path:"*",element:e(ws,{})})]})}),e(Wa,{}),e(za,{position:"top-right",reverseOrder:!1,gutter:8,containerClassName:"",containerStyle:{},toastOptions:{className:"",duration:4e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,theme:{primary:"green",secondary:"black"}}}})]})}),!1]})}class Ks extends te.Component{constructor(r){super(r),this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,s){console.error("App render error:",r,s)}render(){return this.state.hasError?e("div",{className:"container py-5",children:a("div",{className:"alert alert-danger",role:"alert",children:[e("h4",{className:"alert-heading",children:"Something went wrong."}),e("p",{children:"We encountered an error while rendering the page."}),e("hr",{}),e("pre",{style:{whiteSpace:"pre-wrap"},children:String(this.state.error)})]})}):this.props.children}}dt.createRoot(document.getElementById("root")).render(e(Za,{children:e(Ks,{children:e(zs,{})})}));
